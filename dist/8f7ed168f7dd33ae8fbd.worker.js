!function(t){function i(s){if(e[s])return e[s].exports;var n=e[s]={exports:{},id:s,loaded:!1};return t[s].call(n.exports,n,n.exports,i),n.loaded=!0,n.exports}var e={};return i.m=t,i.c=e,i.p="/",i(0)}([function(t,i,e){"use strict";function s(t){if(t&&t.__esModule)return t;var i={};if(null!=t)for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(i[e]=t[e]);return i["default"]=t,i}function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,i,e){return i in t?Object.defineProperty(t,i,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[i]=e,t}function r(t){var i=t.type,e=t.meta,s=t.payload;switch(i){case f.SETUP:return a(s,e);case f.LOOP:return g(s,e)}}function a(t,i){var e=[],s=[],n={};for(var o in t){var r=l({},t[o],{name:o});o===i?h(r)&&(n[o]=l({},t[o],{visible:!0})):-1!==f.BODIES.indexOf(r.type)?s.push(r):-1!==f.JOINTS.indexOf(r.type)&&e.push(r)}var a=!0,u=!1,c=void 0;try{for(var p,d=s[Symbol.iterator]();!(a=(p=d.next()).done);a=!0){var m=p.value;b(m)&&(n[m.name]=l({},t[m.name],{visible:!0}))}}catch(y){u=!0,c=y}finally{try{!a&&d["return"]&&d["return"]()}finally{if(u)throw c}}var x=!0,v=!1,g=void 0;try{for(var C,P=e[Symbol.iterator]();!(x=(C=P.next()).done);x=!0){var A=C.value;N(A)&&(n[A.name]=l({},t[A.name],{visible:!0}))}}catch(y){v=!0,g=y}finally{try{!x&&P["return"]&&P["return"]()}finally{if(v)throw g}}return n}function h(t){var i=t.G,e=t.iterations,s=t.timestep,n=t.broadphase;switch(y.gravity=new c["default"].Vec3(0,i,0),y.numIterations=e,y.timeStep=s/2,n){case f.BRUTE:y.broadPhase=new c["default"].BruteForceBroadPhase;break;case f.SWEEP:default:y.broadPhase=new c["default"].SAPBroadPhase;break;case f.TREE:y.broadPhase=new c["default"].DBVTBroadPhase}return!0}var l=Object.assign||function(t){for(var i=1;i<arguments.length;i++){var e=arguments[i];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t},u=e(86),c=n(u),p=e(87),d=e(85),m=e(84),f=s(m),y=new c["default"].World,x=[],v=[];self.onmessage=function(t){var i=t.data;return self.postMessage({type:i.type,meta:i.meta,payload:r(i)})};var g=function(t,i){y.step(),y.step();var e={},s=!0,n=!1,r=void 0;try{for(var a,h=x[Symbol.iterator]();!(s=(a=h.next()).done);s=!0){var u=a.value;if(!u.sleeping){var d=p.Vec3.scale(u.position,c["default"].WORLD_SCALE),m=p.Quat.scale(u.getQuaternion(),1);e=l({},e,o({},u.name,{pos:d,qua:m}))}}}catch(f){n=!0,r=f}finally{try{!s&&h["return"]&&h["return"]()}finally{if(n)throw r}}var g=!0,b=!1,N=void 0;try{for(var C,P=v[Symbol.iterator]();!(g=(C=P.next()).done);g=!0){var A=C.value,S=p.Vec3.scale(A.anchorPoint1,c["default"].WORLD_SCALE),k=p.Vec3.scale(A.anchorPoint2,c["default"].WORLD_SCALE);e=l({},e,o({},A.name,{anchors:[S,k]}))}}catch(f){b=!0,N=f}finally{try{!g&&P["return"]&&P["return"]()}finally{if(b)throw N}}return e},b=function(t){var i=t.name,e=t.type,s=t.pos,n=t.qua,o=t.dim,r=t.density,a=t.friction,h=t.restitution,l=t.dynamic,u=[s.x,s.y,s.z],d=p.Vec3.scale(p.Quat.toEuler(n),1),m=[d.x,d.y,d.z],v=o.width,g=o.height,b=o.depth,N=o.radius,C=[];switch(e){case f.BOX:C=[v,g,b];break;case f.SPHERE:C=[N];break;case f.CYLINDER:C=[g,N]}var P=y.add({name:i,type:e,pos:u,rot:m,size:C,density:r,friction:a,restitution:h,move:l});return x.push(P),P.type!==c["default"].BODY_NULL},N=function(t){var i=t.name,e=t.type,s=t.bodies,n=t.anchors,o=t.limits,r=t.axis,a=t.damping,h=t.stiffness,l=(t.maxForce,t.maxTorque,(0,d.uniqueUnion)(s[0],(0,d.getParent)(i))),u=(0,d.uniqueUnion)(s[1],(0,d.getParent)(i)),p=[r[0].x,r[0].y,r[0].z],m=[r[1].x,r[1].y,r[1].z],x=[n[0].x,n[0].y,n[0].z],g=[n[1].x,n[1].y,n[1].z],b=o[0],N=o[1],C=[1/h,a],P=y.add({name:i,type:e,body1:l,body2:u,axe1:p,axe2:m,pos1:x,pos2:g,spring:C,min:b,max:N,allowCollision:!0});return e===f.JOINT_DISTANCE&&v.push(P),P.type!==c["default"].JOINT_NULL}},function(t,i,e){"use strict";var s=function(t,i,e,s,n,o,r,a){if(!t){var h;if(void 0===i)h=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var l=[e,s,n,o,r,a],u=0;h=new Error("Invariant Violation: "+i.replace(/%s/g,function(){return l[u++]}))}throw h.framesToPop=1,h}};t.exports=s},function(t,i){"use strict";function e(t,i){if(null==t)throw new TypeError("Object.assign target cannot be null or undefined");for(var e=Object(t),s=Object.prototype.hasOwnProperty,n=1;n<arguments.length;n++){var o=arguments[n];if(null!=o){var r=Object(o);for(var a in r)s.call(r,a)&&(e[a]=r[a])}}return e}t.exports=e},function(t,i,e){"use strict";var s=e(9),n=s;t.exports=n},function(t,i){"use strict";var e=!("undefined"==typeof window||!window.document||!window.document.createElement),s={canUseDOM:e,canUseWorkers:"undefined"!=typeof Worker,canUseEventListeners:e&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:e&&!!window.screen,isInWorker:!e};t.exports=s},function(t,i,e){"use strict";function s(t,i){for(var e=Math.min(t.length,i.length),s=0;e>s;s++)if(t.charAt(s)!==i.charAt(s))return s;return t.length===i.length?-1:e}function n(t){return t?t.nodeType===j?t.documentElement:t.firstChild:null}function o(t){var i=n(t);return i&&K.getID(i)}function r(t){var i=a(t);if(i)if(U.hasOwnProperty(i)){var e=U[i];e!==t&&(c(e,i)?R(!1):void 0,U[i]=t)}else U[i]=t;return i}function a(t){return t&&t.getAttribute&&t.getAttribute(B)||""}function h(t,i){var e=a(t);e!==i&&delete U[e],t.setAttribute(B,i),U[i]=t}function l(t){return U.hasOwnProperty(t)&&c(U[t],t)||(U[t]=K.findReactNodeByID(t)),U[t]}function u(t){var i=k.get(t)._rootNodeID;return A.isNullComponentID(i)?null:(U.hasOwnProperty(i)&&c(U[i],i)||(U[i]=K.findReactNodeByID(i)),U[i])}function c(t,i){if(t){a(t)!==i?R(!1):void 0;var e=K.findReactContainerForID(i);if(e&&T(e,t))return!0}return!1}function p(t){delete U[t]}function d(t){var i=U[t];return i&&c(i,t)?void(H=i):!1}function m(t){H=null,S.traverseAncestors(t,d);var i=H;return H=null,i}function f(t,i,e,s,n,o){C.useCreateElement&&(o=w({},o),e.nodeType===j?o[X]=e:o[X]=e.ownerDocument);var r=_.mountComponent(t,i,s,o);t._renderedComponent._topLevelWrapper=t,K._mountImageIntoNode(r,e,n,s)}function y(t,i,e,s,n){var o=E.ReactReconcileTransaction.getPooled(s);o.perform(f,null,t,i,e,o,s,n),E.ReactReconcileTransaction.release(o)}function x(t,i){for(_.unmountComponent(t),i.nodeType===j&&(i=i.documentElement);i.lastChild;)i.removeChild(i.lastChild)}function v(t){var i=o(t);return i?i!==S.getReactRootIDFromNodeID(i):!1}function g(t){for(;t&&t.parentNode!==t;t=t.parentNode)if(1===t.nodeType){var i=a(t);if(i){var e,s=S.getReactRootIDFromNodeID(i),n=t;do if(e=a(n),n=n.parentNode,null==n)return null;while(e!==s);if(n===Z[s])return t}}return null}var b=e(16),N=e(23),C=(e(11),e(57)),P=e(6),A=e(64),S=e(17),k=e(20),I=e(67),z=e(7),_=e(14),M=e(38),E=e(8),w=e(2),D=e(22),T=e(79),L=e(45),R=e(1),O=e(30),V=e(48),B=(e(50),e(3),b.ID_ATTRIBUTE_NAME),U={},F=1,j=9,Y=11,X="__ReactMount_ownerDocument$"+Math.random().toString(36).slice(2),W={},Z={},q=[],H=null,J=function(){};J.prototype.isReactComponent={},J.prototype.render=function(){return this.props};var K={TopLevelWrapper:J,_instancesByReactRootID:W,scrollMonitor:function(t,i){i()},_updateRootComponent:function(t,i,e,s){return K.scrollMonitor(e,function(){M.enqueueElementInternal(t,i),s&&M.enqueueCallbackInternal(t,s)}),t},_registerComponent:function(t,i){!i||i.nodeType!==F&&i.nodeType!==j&&i.nodeType!==Y?R(!1):void 0,N.ensureScrollValueMonitoring();var e=K.registerContainer(i);return W[e]=t,e},_renderNewRootComponent:function(t,i,e,s){var n=L(t,null),o=K._registerComponent(n,i);return E.batchedUpdates(y,n,o,i,e,s),n},renderSubtreeIntoContainer:function(t,i,e,s){return null==t||null==t._reactInternalInstance?R(!1):void 0,K._renderSubtreeIntoContainer(t,i,e,s)},_renderSubtreeIntoContainer:function(t,i,e,s){P.isValidElement(i)?void 0:R(!1);var r=new P(J,null,null,null,null,null,i),h=W[o(e)];if(h){var l=h._currentElement,u=l.props;if(V(u,i)){var c=h._renderedComponent.getPublicInstance(),p=s&&function(){s.call(c)};return K._updateRootComponent(h,r,e,p),c}K.unmountComponentAtNode(e)}var d=n(e),m=d&&!!a(d),f=v(e),y=m&&!h&&!f,x=K._renderNewRootComponent(r,e,y,null!=t?t._reactInternalInstance._processChildContext(t._reactInternalInstance._context):D)._renderedComponent.getPublicInstance();return s&&s.call(x),x},render:function(t,i,e){return K._renderSubtreeIntoContainer(null,t,i,e)},registerContainer:function(t){var i=o(t);return i&&(i=S.getReactRootIDFromNodeID(i)),i||(i=S.createReactRootID()),Z[i]=t,i},unmountComponentAtNode:function(t){!t||t.nodeType!==F&&t.nodeType!==j&&t.nodeType!==Y?R(!1):void 0;var i=o(t),e=W[i];if(!e){var s=(v(t),a(t));s&&s===S.getReactRootIDFromNodeID(s);return!1}return E.batchedUpdates(x,e,t),delete W[i],delete Z[i],!0},findReactContainerForID:function(t){var i=S.getReactRootIDFromNodeID(t),e=Z[i];return e},findReactNodeByID:function(t){var i=K.findReactContainerForID(t);return K.findComponentRoot(i,t)},getFirstReactDOM:function(t){return g(t)},findComponentRoot:function(t,i){var e=q,s=0,n=m(i)||t;for(e[0]=n.firstChild,e.length=1;s<e.length;){for(var o,r=e[s++];r;){var a=K.getID(r);a?i===a?o=r:S.isAncestorIDOf(a,i)&&(e.length=s=0,e.push(r.firstChild)):e.push(r.firstChild),r=r.nextSibling}if(o)return e.length=0,o}e.length=0,R(!1)},_mountImageIntoNode:function(t,i,e,o){if(!i||i.nodeType!==F&&i.nodeType!==j&&i.nodeType!==Y?R(!1):void 0,e){var r=n(i);if(I.canReuseMarkup(t,r))return;var a=r.getAttribute(I.CHECKSUM_ATTR_NAME);r.removeAttribute(I.CHECKSUM_ATTR_NAME);var h=r.outerHTML;r.setAttribute(I.CHECKSUM_ATTR_NAME,a);var l=t,u=s(l,h);" (client) "+l.substring(u-20,u+20)+"\n (server) "+h.substring(u-20,u+20);i.nodeType===j?R(!1):void 0}if(i.nodeType===j?R(!1):void 0,o.useCreateElement){for(;i.lastChild;)i.removeChild(i.lastChild);i.appendChild(t)}else O(i,t)},ownerDocumentContextKey:X,getReactRootID:o,getID:r,setID:h,getNode:l,getNodeFromInstance:u,isValid:c,purgeID:p};z.measureMethods(K,"ReactMount",{_renderNewRootComponent:"_renderNewRootComponent",_mountImageIntoNode:"_mountImageIntoNode"}),t.exports=K},function(t,i,e){"use strict";var s=e(11),n=e(2),o=(e(28),"function"==typeof Symbol&&Symbol["for"]&&Symbol["for"]("react.element")||60103),r={key:!0,ref:!0,__self:!0,__source:!0},a=function(t,i,e,s,n,r,a){var h={$$typeof:o,type:t,key:i,ref:e,props:a,_owner:r};return h};a.createElement=function(t,i,e){var n,o={},h=null,l=null,u=null,c=null;if(null!=i){l=void 0===i.ref?null:i.ref,h=void 0===i.key?null:""+i.key,u=void 0===i.__self?null:i.__self,c=void 0===i.__source?null:i.__source;for(n in i)i.hasOwnProperty(n)&&!r.hasOwnProperty(n)&&(o[n]=i[n])}var p=arguments.length-2;if(1===p)o.children=e;else if(p>1){for(var d=Array(p),m=0;p>m;m++)d[m]=arguments[m+2];o.children=d}if(t&&t.defaultProps){var f=t.defaultProps;for(n in f)"undefined"==typeof o[n]&&(o[n]=f[n])}return a(t,h,l,u,c,s.current,o)},a.createFactory=function(t){var i=a.createElement.bind(null,t);return i.type=t,i},a.cloneAndReplaceKey=function(t,i){var e=a(t.type,i,t.ref,t._self,t._source,t._owner,t.props);return e},a.cloneAndReplaceProps=function(t,i){var e=a(t.type,t.key,t.ref,t._self,t._source,t._owner,i);return e},a.cloneElement=function(t,i,e){var o,h=n({},t.props),l=t.key,u=t.ref,c=t._self,p=t._source,d=t._owner;if(null!=i){void 0!==i.ref&&(u=i.ref,d=s.current),void 0!==i.key&&(l=""+i.key);for(o in i)i.hasOwnProperty(o)&&!r.hasOwnProperty(o)&&(h[o]=i[o])}var m=arguments.length-2;if(1===m)h.children=e;else if(m>1){for(var f=Array(m),y=0;m>y;y++)f[y]=arguments[y+2];h.children=f}return a(t.type,l,u,c,p,d,h)},a.isValidElement=function(t){return"object"==typeof t&&null!==t&&t.$$typeof===o},t.exports=a},function(t,i,e){"use strict";function s(t,i,e){return e}var n={enableMeasure:!1,storedMeasure:s,measureMethods:function(t,i,e){},measure:function(t,i,e){return e},injection:{injectMeasure:function(t){n.storedMeasure=t}}};t.exports=n},function(t,i,e){"use strict";function s(){k.ReactReconcileTransaction&&b?void 0:y(!1)}function n(){this.reinitializeTransaction(),this.dirtyComponentsLength=null,this.callbackQueue=u.getPooled(),this.reconcileTransaction=k.ReactReconcileTransaction.getPooled(!1)}function o(t,i,e,n,o,r){s(),b.batchedUpdates(t,i,e,n,o,r)}function r(t,i){return t._mountOrder-i._mountOrder}function a(t){var i=t.dirtyComponentsLength;i!==x.length?y(!1):void 0,x.sort(r);for(var e=0;i>e;e++){var s=x[e],n=s._pendingCallbacks;if(s._pendingCallbacks=null,d.performUpdateIfNecessary(s,t.reconcileTransaction),n)for(var o=0;o<n.length;o++)t.callbackQueue.enqueue(n[o],s.getPublicInstance())}}function h(t){return s(),b.isBatchingUpdates?void x.push(t):void b.batchedUpdates(h,t)}function l(t,i){b.isBatchingUpdates?void 0:y(!1),v.enqueue(t,i),g=!0}var u=e(32),c=e(12),p=e(7),d=e(14),m=e(27),f=e(2),y=e(1),x=[],v=u.getPooled(),g=!1,b=null,N={initialize:function(){this.dirtyComponentsLength=x.length},close:function(){this.dirtyComponentsLength!==x.length?(x.splice(0,this.dirtyComponentsLength),A()):x.length=0}},C={initialize:function(){this.callbackQueue.reset()},close:function(){this.callbackQueue.notifyAll()}},P=[N,C];f(n.prototype,m.Mixin,{getTransactionWrappers:function(){return P},destructor:function(){this.dirtyComponentsLength=null,u.release(this.callbackQueue),this.callbackQueue=null,k.ReactReconcileTransaction.release(this.reconcileTransaction),this.reconcileTransaction=null},perform:function(t,i,e){return m.Mixin.perform.call(this,this.reconcileTransaction.perform,this.reconcileTransaction,t,i,e)}}),c.addPoolingTo(n);var A=function(){for(;x.length||g;){if(x.length){var t=n.getPooled();t.perform(a,null,t),n.release(t)}if(g){g=!1;var i=v;v=u.getPooled(),i.notifyAll(),u.release(i)}}};A=p.measure("ReactUpdates","flushBatchedUpdates",A);var S={injectReconcileTransaction:function(t){t?void 0:y(!1),k.ReactReconcileTransaction=t},injectBatchingStrategy:function(t){t?void 0:y(!1),"function"!=typeof t.batchedUpdates?y(!1):void 0,"boolean"!=typeof t.isBatchingUpdates?y(!1):void 0,b=t}},k={ReactReconcileTransaction:null,batchedUpdates:o,enqueueUpdate:h,flushBatchedUpdates:A,injection:S,asap:l};t.exports=k},function(t,i){"use strict";function e(t){return function(){return t}}function s(){}s.thatReturns=e,s.thatReturnsFalse=e(!1),s.thatReturnsTrue=e(!0),s.thatReturnsNull=e(null),s.thatReturnsThis=function(){return this},s.thatReturnsArgument=function(t){return t},t.exports=s},function(t,i,e){"use strict";var s=e(31),n=s({bubbled:null,captured:null}),o=s({topAbort:null,topBlur:null,topCanPlay:null,topCanPlayThrough:null,topChange:null,topClick:null,topCompositionEnd:null,topCompositionStart:null,topCompositionUpdate:null,topContextMenu:null,topCopy:null,topCut:null,topDoubleClick:null,topDrag:null,topDragEnd:null,topDragEnter:null,topDragExit:null,topDragLeave:null,topDragOver:null,topDragStart:null,topDrop:null,topDurationChange:null,topEmptied:null,topEncrypted:null,topEnded:null,topError:null,topFocus:null,topInput:null,topKeyDown:null,topKeyPress:null,topKeyUp:null,topLoad:null,topLoadedData:null,topLoadedMetadata:null,topLoadStart:null,topMouseDown:null,topMouseMove:null,topMouseOut:null,topMouseOver:null,topMouseUp:null,topPaste:null,topPause:null,topPlay:null,topPlaying:null,topProgress:null,topRateChange:null,topReset:null,topScroll:null,topSeeked:null,topSeeking:null,topSelectionChange:null,topStalled:null,topSubmit:null,topSuspend:null,topTextInput:null,topTimeUpdate:null,topTouchCancel:null,topTouchEnd:null,topTouchMove:null,topTouchStart:null,topVolumeChange:null,topWaiting:null,topWheel:null}),r={topLevelTypes:o,PropagationPhases:n};t.exports=r},function(t,i){"use strict";var e={current:null};t.exports=e},function(t,i,e){"use strict";var s=e(1),n=function(t){var i=this;if(i.instancePool.length){var e=i.instancePool.pop();return i.call(e,t),e}return new i(t)},o=function(t,i){var e=this;if(e.instancePool.length){var s=e.instancePool.pop();return e.call(s,t,i),s}return new e(t,i)},r=function(t,i,e){var s=this;if(s.instancePool.length){var n=s.instancePool.pop();return s.call(n,t,i,e),n}return new s(t,i,e)},a=function(t,i,e,s){var n=this;if(n.instancePool.length){var o=n.instancePool.pop();return n.call(o,t,i,e,s),o}return new n(t,i,e,s)},h=function(t,i,e,s,n){var o=this;if(o.instancePool.length){var r=o.instancePool.pop();return o.call(r,t,i,e,s,n),r}return new o(t,i,e,s,n)},l=function(t){var i=this;t instanceof i?void 0:s(!1),t.destructor(),i.instancePool.length<i.poolSize&&i.instancePool.push(t)},u=10,c=n,p=function(t,i){var e=t;return e.instancePool=[],e.getPooled=i||c,e.poolSize||(e.poolSize=u),e.release=l,e},d={addPoolingTo:p,oneArgumentPooler:n,twoArgumentPooler:o,threeArgumentPooler:r,fourArgumentPooler:a,fiveArgumentPooler:h};t.exports=d},function(t,i){"use strict";var e=function(t){var i;for(i in t)if(t.hasOwnProperty(i))return i;return null};t.exports=e},function(t,i,e){"use strict";function s(){n.attachRefs(this,this._currentElement)}var n=e(119),o={mountComponent:function(t,i,e,n){var o=t.mountComponent(i,e,n);return t._currentElement&&null!=t._currentElement.ref&&e.getReactMountReady().enqueue(s,t),o},unmountComponent:function(t){n.detachRefs(t,t._currentElement),t.unmountComponent()},receiveComponent:function(t,i,e,o){var r=t._currentElement;if(i!==r||o!==t._context){var a=n.shouldUpdateRefs(r,i);a&&n.detachRefs(t,r),t.receiveComponent(i,e,o),a&&t._currentElement&&null!=t._currentElement.ref&&e.getReactMountReady().enqueue(s,t)}},performUpdateIfNecessary:function(t,i){t.performUpdateIfNecessary(i)}};t.exports=o},function(t,i,e){"use strict";function s(t,i,e,s){this.dispatchConfig=t,this.dispatchMarker=i,this.nativeEvent=e,this.target=s,this.currentTarget=s;var n=this.constructor.Interface;for(var o in n)if(n.hasOwnProperty(o)){var a=n[o];a?this[o]=a(e):this[o]=e[o]}var h=null!=e.defaultPrevented?e.defaultPrevented:e.returnValue===!1;h?this.isDefaultPrevented=r.thatReturnsTrue:this.isDefaultPrevented=r.thatReturnsFalse,this.isPropagationStopped=r.thatReturnsFalse}var n=e(12),o=e(2),r=e(9),a=(e(3),{type:null,currentTarget:r.thatReturnsNull,eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null});o(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():t.returnValue=!1,this.isDefaultPrevented=r.thatReturnsTrue)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():t.cancelBubble=!0,this.isPropagationStopped=r.thatReturnsTrue)},persist:function(){this.isPersistent=r.thatReturnsTrue},isPersistent:r.thatReturnsFalse,destructor:function(){var t=this.constructor.Interface;for(var i in t)this[i]=null;this.dispatchConfig=null,this.dispatchMarker=null,this.nativeEvent=null}}),s.Interface=a,s.augmentClass=function(t,i){var e=this,s=Object.create(e.prototype);o(s,t.prototype),t.prototype=s,t.prototype.constructor=t,t.Interface=o({},e.Interface,i),t.augmentClass=e.augmentClass,n.addPoolingTo(t,n.fourArgumentPooler)},n.addPoolingTo(s,n.fourArgumentPooler),t.exports=s},function(t,i,e){"use strict";function s(t,i){return(t&i)===i}var n=e(1),o={MUST_USE_ATTRIBUTE:1,MUST_USE_PROPERTY:2,HAS_SIDE_EFFECTS:4,HAS_BOOLEAN_VALUE:8,HAS_NUMERIC_VALUE:16,HAS_POSITIVE_NUMERIC_VALUE:48,HAS_OVERLOADED_BOOLEAN_VALUE:64,injectDOMPropertyConfig:function(t){var i=o,e=t.Properties||{},r=t.DOMAttributeNamespaces||{},h=t.DOMAttributeNames||{},l=t.DOMPropertyNames||{},u=t.DOMMutationMethods||{};t.isCustomAttribute&&a._isCustomAttributeFunctions.push(t.isCustomAttribute);for(var c in e){a.properties.hasOwnProperty(c)?n(!1):void 0;var p=c.toLowerCase(),d=e[c],m={attributeName:p,attributeNamespace:null,propertyName:c,mutationMethod:null,mustUseAttribute:s(d,i.MUST_USE_ATTRIBUTE),mustUseProperty:s(d,i.MUST_USE_PROPERTY),hasSideEffects:s(d,i.HAS_SIDE_EFFECTS),hasBooleanValue:s(d,i.HAS_BOOLEAN_VALUE),hasNumericValue:s(d,i.HAS_NUMERIC_VALUE),hasPositiveNumericValue:s(d,i.HAS_POSITIVE_NUMERIC_VALUE),hasOverloadedBooleanValue:s(d,i.HAS_OVERLOADED_BOOLEAN_VALUE)};if(m.mustUseAttribute&&m.mustUseProperty?n(!1):void 0,!m.mustUseProperty&&m.hasSideEffects?n(!1):void 0,m.hasBooleanValue+m.hasNumericValue+m.hasOverloadedBooleanValue<=1?void 0:n(!1),h.hasOwnProperty(c)){var f=h[c];m.attributeName=f}r.hasOwnProperty(c)&&(m.attributeNamespace=r[c]),l.hasOwnProperty(c)&&(m.propertyName=l[c]),u.hasOwnProperty(c)&&(m.mutationMethod=u[c]),a.properties[c]=m}}},r={},a={ID_ATTRIBUTE_NAME:"data-reactid",properties:{},getPossibleStandardName:null,_isCustomAttributeFunctions:[],isCustomAttribute:function(t){for(var i=0;i<a._isCustomAttributeFunctions.length;i++){var e=a._isCustomAttributeFunctions[i];if(e(t))return!0}return!1},getDefaultValueForProperty:function(t,i){var e,s=r[t];return s||(r[t]=s={}),i in s||(e=document.createElement(t),s[i]=e[i]),s[i]},injection:o};t.exports=a},function(t,i,e){"use strict";function s(t){return d+t.toString(36)}function n(t,i){return t.charAt(i)===d||i===t.length}function o(t){return""===t||t.charAt(0)===d&&t.charAt(t.length-1)!==d}function r(t,i){return 0===i.indexOf(t)&&n(i,t.length)}function a(t){return t?t.substr(0,t.lastIndexOf(d)):""}function h(t,i){if(o(t)&&o(i)?void 0:p(!1),r(t,i)?void 0:p(!1),t===i)return t;var e,s=t.length+m;for(e=s;e<i.length&&!n(i,e);e++);return i.substr(0,e)}function l(t,i){var e=Math.min(t.length,i.length);if(0===e)return"";for(var s=0,r=0;e>=r;r++)if(n(t,r)&&n(i,r))s=r;else if(t.charAt(r)!==i.charAt(r))break;var a=t.substr(0,s);return o(a)?void 0:p(!1),a}function u(t,i,e,s,n,o){t=t||"",i=i||"",t===i?p(!1):void 0;var l=r(i,t);l||r(t,i)?void 0:p(!1);for(var u=0,c=l?a:h,d=t;;d=c(d,i)){var m;if(n&&d===t||o&&d===i||(m=e(d,l,s)),m===!1||d===i)break;u++<f?void 0:p(!1)}}var c=e(72),p=e(1),d=".",m=d.length,f=1e4,y={createReactRootID:function(){return s(c.createReactRootIndex())},createReactID:function(t,i){return t+i},getReactRootIDFromNodeID:function(t){if(t&&t.charAt(0)===d&&t.length>1){var i=t.indexOf(d,1);return i>-1?t.substr(0,i):t}return null},traverseEnterLeave:function(t,i,e,s,n){var o=l(t,i);o!==t&&u(t,o,e,s,!1,!0),o!==i&&u(o,i,e,n,!0,!1)},traverseTwoPhase:function(t,i,e){t&&(u("",t,i,e,!0,!1),u(t,"",i,e,!1,!0))},traverseTwoPhaseSkipTarget:function(t,i,e){t&&(u("",t,i,e,!0,!0),u(t,"",i,e,!0,!0))},traverseAncestors:function(t,i,e){u("",t,i,e,!0,!1)},getFirstCommonAncestorID:l,_getNextDescendantID:h,isAncestorIDOf:r,SEPARATOR:d};t.exports=y},function(t,i,e){"use strict";var s=e(53),n=e(96),o=e(65),r=e(74),a=e(75),h=e(1),l=(e(3),{}),u=null,c=function(t,i){t&&(n.executeDispatchesInOrder(t,i),t.isPersistent()||t.constructor.release(t))},p=function(t){return c(t,!0)},d=function(t){return c(t,!1)},m=null,f={injection:{injectMount:n.injection.injectMount,injectInstanceHandle:function(t){m=t},getInstanceHandle:function(){return m},injectEventPluginOrder:s.injectEventPluginOrder,injectEventPluginsByName:s.injectEventPluginsByName},eventNameDispatchConfigs:s.eventNameDispatchConfigs,registrationNameModules:s.registrationNameModules,putListener:function(t,i,e){"function"!=typeof e?h(!1):void 0;var n=l[i]||(l[i]={});n[t]=e;var o=s.registrationNameModules[i];o&&o.didPutListener&&o.didPutListener(t,i,e)},getListener:function(t,i){var e=l[i];return e&&e[t]},deleteListener:function(t,i){var e=s.registrationNameModules[i];e&&e.willDeleteListener&&e.willDeleteListener(t,i);var n=l[i];n&&delete n[t]},deleteAllListeners:function(t){for(var i in l)if(l[i][t]){var e=s.registrationNameModules[i];e&&e.willDeleteListener&&e.willDeleteListener(t,i),delete l[i][t]}},extractEvents:function(t,i,e,n,o){for(var a,h=s.plugins,l=0;l<h.length;l++){var u=h[l];if(u){var c=u.extractEvents(t,i,e,n,o);c&&(a=r(a,c))}}return a},enqueueEvents:function(t){t&&(u=r(u,t))},processEventQueue:function(t){var i=u;u=null,t?a(i,p):a(i,d),u?h(!1):void 0,o.rethrowCaughtError()},__purge:function(){l={}},__getListenerBank:function(){return l}};t.exports=f},function(t,i,e){"use strict";function s(t,i,e){var s=i.dispatchConfig.phasedRegistrationNames[e];return v(t,s)}function n(t,i,e){var n=i?x.bubbled:x.captured,o=s(t,e,n);o&&(e._dispatchListeners=f(e._dispatchListeners,o),e._dispatchIDs=f(e._dispatchIDs,t))}function o(t){t&&t.dispatchConfig.phasedRegistrationNames&&m.injection.getInstanceHandle().traverseTwoPhase(t.dispatchMarker,n,t)}function r(t){t&&t.dispatchConfig.phasedRegistrationNames&&m.injection.getInstanceHandle().traverseTwoPhaseSkipTarget(t.dispatchMarker,n,t)}function a(t,i,e){if(e&&e.dispatchConfig.registrationName){var s=e.dispatchConfig.registrationName,n=v(t,s);n&&(e._dispatchListeners=f(e._dispatchListeners,n),e._dispatchIDs=f(e._dispatchIDs,t))}}function h(t){t&&t.dispatchConfig.registrationName&&a(t.dispatchMarker,null,t)}function l(t){y(t,o)}function u(t){y(t,r)}function c(t,i,e,s){m.injection.getInstanceHandle().traverseEnterLeave(e,s,a,t,i)}function p(t){y(t,h)}var d=e(10),m=e(18),f=(e(3),e(74)),y=e(75),x=d.PropagationPhases,v=m.getListener,g={accumulateTwoPhaseDispatches:l,accumulateTwoPhaseDispatchesSkipTarget:u,accumulateDirectDispatches:p,accumulateEnterLeaveDispatches:c};t.exports=g},function(t,i){"use strict";var e={remove:function(t){t._reactInternalInstance=void 0},get:function(t){return t._reactInternalInstance},has:function(t){return void 0!==t._reactInternalInstance},set:function(t,i){t._reactInternalInstance=i}};t.exports=e},function(t,i,e){"use strict";function s(t,i,e,s){n.call(this,t,i,e,s)}var n=e(15),o=e(43),r={view:function(t){if(t.view)return t.view;var i=o(t);if(null!=i&&i.window===i)return i;var e=i.ownerDocument;return e?e.defaultView||e.parentWindow:window},detail:function(t){return t.detail||0}};n.augmentClass(s,r),t.exports=s},function(t,i,e){"use strict";var s={};t.exports=s},function(t,i,e){"use strict";function s(t){return Object.prototype.hasOwnProperty.call(t,y)||(t[y]=m++,p[t[y]]={}),p[t[y]]}var n=e(10),o=e(18),r=e(53),a=e(112),h=e(7),l=e(73),u=e(2),c=e(46),p={},d=!1,m=0,f={topAbort:"abort",topBlur:"blur",topCanPlay:"canplay",topCanPlayThrough:"canplaythrough",topChange:"change",topClick:"click",topCompositionEnd:"compositionend",topCompositionStart:"compositionstart",topCompositionUpdate:"compositionupdate",topContextMenu:"contextmenu",topCopy:"copy",topCut:"cut",topDoubleClick:"dblclick",topDrag:"drag",topDragEnd:"dragend",topDragEnter:"dragenter",topDragExit:"dragexit",topDragLeave:"dragleave",topDragOver:"dragover",topDragStart:"dragstart",topDrop:"drop",topDurationChange:"durationchange",topEmptied:"emptied",topEncrypted:"encrypted",topEnded:"ended",topError:"error",topFocus:"focus",topInput:"input",topKeyDown:"keydown",topKeyPress:"keypress",topKeyUp:"keyup",topLoadedData:"loadeddata",topLoadedMetadata:"loadedmetadata",topLoadStart:"loadstart",topMouseDown:"mousedown",topMouseMove:"mousemove",topMouseOut:"mouseout",topMouseOver:"mouseover",topMouseUp:"mouseup",topPaste:"paste",topPause:"pause",topPlay:"play",topPlaying:"playing",topProgress:"progress",topRateChange:"ratechange",topScroll:"scroll",topSeeked:"seeked",topSeeking:"seeking",topSelectionChange:"selectionchange",topStalled:"stalled",topSuspend:"suspend",topTextInput:"textInput",topTimeUpdate:"timeupdate",topTouchCancel:"touchcancel",topTouchEnd:"touchend",topTouchMove:"touchmove",topTouchStart:"touchstart",topVolumeChange:"volumechange",topWaiting:"waiting",topWheel:"wheel"},y="_reactListenersID"+String(Math.random()).slice(2),x=u({},a,{ReactEventListener:null,injection:{injectReactEventListener:function(t){t.setHandleTopLevel(x.handleTopLevel),x.ReactEventListener=t}},setEnabled:function(t){x.ReactEventListener&&x.ReactEventListener.setEnabled(t)},isEnabled:function(){return!(!x.ReactEventListener||!x.ReactEventListener.isEnabled())},listenTo:function(t,i){for(var e=i,o=s(e),a=r.registrationNameDependencies[t],h=n.topLevelTypes,l=0;l<a.length;l++){var u=a[l];o.hasOwnProperty(u)&&o[u]||(u===h.topWheel?c("wheel")?x.ReactEventListener.trapBubbledEvent(h.topWheel,"wheel",e):c("mousewheel")?x.ReactEventListener.trapBubbledEvent(h.topWheel,"mousewheel",e):x.ReactEventListener.trapBubbledEvent(h.topWheel,"DOMMouseScroll",e):u===h.topScroll?c("scroll",!0)?x.ReactEventListener.trapCapturedEvent(h.topScroll,"scroll",e):x.ReactEventListener.trapBubbledEvent(h.topScroll,"scroll",x.ReactEventListener.WINDOW_HANDLE):u===h.topFocus||u===h.topBlur?(c("focus",!0)?(x.ReactEventListener.trapCapturedEvent(h.topFocus,"focus",e),x.ReactEventListener.trapCapturedEvent(h.topBlur,"blur",e)):c("focusin")&&(x.ReactEventListener.trapBubbledEvent(h.topFocus,"focusin",e),x.ReactEventListener.trapBubbledEvent(h.topBlur,"focusout",e)),o[h.topBlur]=!0,o[h.topFocus]=!0):f.hasOwnProperty(u)&&x.ReactEventListener.trapBubbledEvent(u,f[u],e),o[u]=!0)}},trapBubbledEvent:function(t,i,e){return x.ReactEventListener.trapBubbledEvent(t,i,e)},trapCapturedEvent:function(t,i,e){return x.ReactEventListener.trapCapturedEvent(t,i,e)},ensureScrollValueMonitoring:function(){if(!d){var t=l.refreshScrollValues;x.ReactEventListener.monitorScrollValue(t),d=!0}},eventNameDispatchConfigs:o.eventNameDispatchConfigs,registrationNameModules:o.registrationNameModules,putListener:o.putListener,getListener:o.getListener,deleteListener:o.deleteListener,deleteAllListeners:o.deleteAllListeners});h.measureMethods(x,"ReactBrowserEventEmitter",{putListener:"putListener",deleteListener:"deleteListener"}),t.exports=x},function(t,i,e){"use strict";var s={};t.exports=s},function(t,i,e){"use strict";var s=e(31),n=s({prop:null,context:null,childContext:null});t.exports=n},function(t,i,e){"use strict";function s(t,i,e,s){n.call(this,t,i,e,s)}var n=e(21),o=e(73),r=e(42),a={screenX:null,screenY:null,clientX:null,clientY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:r,button:function(t){var i=t.button;return"which"in t?i:2===i?2:4===i?1:0},buttons:null,relatedTarget:function(t){return t.relatedTarget||(t.fromElement===t.srcElement?t.toElement:t.fromElement)},pageX:function(t){return"pageX"in t?t.pageX:t.clientX+o.currentScrollLeft},pageY:function(t){return"pageY"in t?t.pageY:t.clientY+o.currentScrollTop}};n.augmentClass(s,a),t.exports=s},function(t,i,e){"use strict";var s=e(1),n={reinitializeTransaction:function(){this.transactionWrappers=this.getTransactionWrappers(),this.wrapperInitData?this.wrapperInitData.length=0:this.wrapperInitData=[],this._isInTransaction=!1},_isInTransaction:!1,getTransactionWrappers:null,isInTransaction:function(){return!!this._isInTransaction},perform:function(t,i,e,n,o,r,a,h){this.isInTransaction()?s(!1):void 0;var l,u;try{this._isInTransaction=!0,l=!0,this.initializeAll(0),u=t.call(i,e,n,o,r,a,h),l=!1}finally{try{if(l)try{this.closeAll(0)}catch(c){}else this.closeAll(0)}finally{this._isInTransaction=!1}}return u},initializeAll:function(t){for(var i=this.transactionWrappers,e=t;e<i.length;e++){var s=i[e];try{this.wrapperInitData[e]=o.OBSERVED_ERROR,this.wrapperInitData[e]=s.initialize?s.initialize.call(this):null}finally{if(this.wrapperInitData[e]===o.OBSERVED_ERROR)try{this.initializeAll(e+1)}catch(n){}}}},closeAll:function(t){this.isInTransaction()?void 0:s(!1);for(var i=this.transactionWrappers,e=t;e<i.length;e++){var n,r=i[e],a=this.wrapperInitData[e];try{n=!0,a!==o.OBSERVED_ERROR&&r.close&&r.close.call(this,a),n=!1}finally{if(n)try{this.closeAll(e+1)}catch(h){}}}this.wrapperInitData.length=0}},o={Mixin:n,OBSERVED_ERROR:{}};t.exports=o},function(t,i,e){"use strict";var s=!1;t.exports=s},function(t,i){"use strict";function e(t){return n[t]}function s(t){return(""+t).replace(o,e)}var n={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#x27;"},o=/[&><"']/g;t.exports=s},function(t,i,e){"use strict";var s=e(4),n=/^[ \r\n\t\f]/,o=/<(!--|link|noscript|meta|script|style)[ \r\n\t\f\/>]/,r=function(t,i){t.innerHTML=i};if("undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction&&(r=function(t,i){MSApp.execUnsafeLocalFunction(function(){t.innerHTML=i})}),s.canUseDOM){var a=document.createElement("div");a.innerHTML=" ",""===a.innerHTML&&(r=function(t,i){if(t.parentNode&&t.parentNode.replaceChild(t,t),n.test(i)||"<"===i[0]&&o.test(i)){t.innerHTML=String.fromCharCode(65279)+i;var e=t.firstChild;1===e.data.length?t.removeChild(e):e.deleteData(0,1);
}else t.innerHTML=i})}t.exports=r},function(t,i,e){"use strict";var s=e(1),n=function(t){var i,e={};t instanceof Object&&!Array.isArray(t)?void 0:s(!1);for(i in t)t.hasOwnProperty(i)&&(e[i]=i);return e};t.exports=n},function(t,i,e){"use strict";function s(){this._callbacks=null,this._contexts=null}var n=e(12),o=e(2),r=e(1);o(s.prototype,{enqueue:function(t,i){this._callbacks=this._callbacks||[],this._contexts=this._contexts||[],this._callbacks.push(t),this._contexts.push(i)},notifyAll:function(){var t=this._callbacks,i=this._contexts;if(t){t.length!==i.length?r(!1):void 0,this._callbacks=null,this._contexts=null;for(var e=0;e<t.length;e++)t[e].call(i[e]);t.length=0,i.length=0}},reset:function(){this._callbacks=null,this._contexts=null},destructor:function(){this.reset()}}),n.addPoolingTo(s),t.exports=s},function(t,i,e){"use strict";function s(t){return u.hasOwnProperty(t)?!0:l.hasOwnProperty(t)?!1:h.test(t)?(u[t]=!0,!0):(l[t]=!0,!1)}function n(t,i){return null==i||t.hasBooleanValue&&!i||t.hasNumericValue&&isNaN(i)||t.hasPositiveNumericValue&&1>i||t.hasOverloadedBooleanValue&&i===!1}var o=e(16),r=e(7),a=e(142),h=(e(3),/^[a-zA-Z_][\w\.\-]*$/),l={},u={},c={createMarkupForID:function(t){return o.ID_ATTRIBUTE_NAME+"="+a(t)},setAttributeForID:function(t,i){t.setAttribute(o.ID_ATTRIBUTE_NAME,i)},createMarkupForProperty:function(t,i){var e=o.properties.hasOwnProperty(t)?o.properties[t]:null;if(e){if(n(e,i))return"";var s=e.attributeName;return e.hasBooleanValue||e.hasOverloadedBooleanValue&&i===!0?s+'=""':s+"="+a(i)}return o.isCustomAttribute(t)?null==i?"":t+"="+a(i):null},createMarkupForCustomAttribute:function(t,i){return s(t)&&null!=i?t+"="+a(i):""},setValueForProperty:function(t,i,e){var s=o.properties.hasOwnProperty(i)?o.properties[i]:null;if(s){var r=s.mutationMethod;if(r)r(t,e);else if(n(s,e))this.deleteValueForProperty(t,i);else if(s.mustUseAttribute){var a=s.attributeName,h=s.attributeNamespace;h?t.setAttributeNS(h,a,""+e):s.hasBooleanValue||s.hasOverloadedBooleanValue&&e===!0?t.setAttribute(a,""):t.setAttribute(a,""+e)}else{var l=s.propertyName;s.hasSideEffects&&""+t[l]==""+e||(t[l]=e)}}else o.isCustomAttribute(i)&&c.setValueForAttribute(t,i,e)},setValueForAttribute:function(t,i,e){s(i)&&(null==e?t.removeAttribute(i):t.setAttribute(i,""+e))},deleteValueForProperty:function(t,i){var e=o.properties.hasOwnProperty(i)?o.properties[i]:null;if(e){var s=e.mutationMethod;if(s)s(t,void 0);else if(e.mustUseAttribute)t.removeAttribute(e.attributeName);else{var n=e.propertyName,r=o.getDefaultValueForProperty(t.nodeName,n);e.hasSideEffects&&""+t[n]===r||(t[n]=r)}}else o.isCustomAttribute(i)&&t.removeAttribute(i)}};r.measureMethods(c,"DOMPropertyOperations",{setValueForProperty:"setValueForProperty",setValueForAttribute:"setValueForAttribute",deleteValueForProperty:"deleteValueForProperty"}),t.exports=c},function(t,i,e){"use strict";function s(t){null!=t.checkedLink&&null!=t.valueLink?l(!1):void 0}function n(t){s(t),null!=t.value||null!=t.onChange?l(!1):void 0}function o(t){s(t),null!=t.checked||null!=t.onChange?l(!1):void 0}function r(t){if(t){var i=t.getName();if(i)return" Check the render method of `"+i+"`."}return""}var a=e(71),h=e(25),l=e(1),u=(e(3),{button:!0,checkbox:!0,image:!0,hidden:!0,radio:!0,reset:!0,submit:!0}),c={value:function(t,i,e){return!t[i]||u[t.type]||t.onChange||t.readOnly||t.disabled?null:new Error("You provided a `value` prop to a form field without an `onChange` handler. This will render a read-only field. If the field should be mutable use `defaultValue`. Otherwise, set either `onChange` or `readOnly`.")},checked:function(t,i,e){return!t[i]||t.onChange||t.readOnly||t.disabled?null:new Error("You provided a `checked` prop to a form field without an `onChange` handler. This will render a read-only field. If the field should be mutable use `defaultChecked`. Otherwise, set either `onChange` or `readOnly`.")},onChange:a.func},p={},d={checkPropTypes:function(t,i,e){for(var s in c){if(c.hasOwnProperty(s))var n=c[s](i,s,t,h.prop);if(n instanceof Error&&!(n.message in p)){p[n.message]=!0;r(e)}}},getValue:function(t){return t.valueLink?(n(t),t.valueLink.value):t.value},getChecked:function(t){return t.checkedLink?(o(t),t.checkedLink.value):t.checked},executeOnChange:function(t,i){return t.valueLink?(n(t),t.valueLink.requestChange(i.target.value)):t.checkedLink?(o(t),t.checkedLink.requestChange(i.target.checked)):t.onChange?t.onChange.call(void 0,i):void 0}};t.exports=d},function(t,i,e){"use strict";var s=e(37),n=e(5),o={processChildrenUpdates:s.dangerouslyProcessChildrenUpdates,replaceNodeWithMarkupByID:s.dangerouslyReplaceNodeWithMarkupByID,unmountIDFromEnvironment:function(t){n.purgeID(t)}};t.exports=o},function(t,i,e){"use strict";var s=e(1),n=!1,o={unmountIDFromEnvironment:null,replaceNodeWithMarkupByID:null,processChildrenUpdates:null,injection:{injectEnvironment:function(t){n?s(!1):void 0,o.unmountIDFromEnvironment=t.unmountIDFromEnvironment,o.replaceNodeWithMarkupByID=t.replaceNodeWithMarkupByID,o.processChildrenUpdates=t.processChildrenUpdates,n=!0}}};t.exports=o},function(t,i,e){"use strict";var s=e(52),n=e(33),o=e(5),r=e(7),a=e(1),h={dangerouslySetInnerHTML:"`dangerouslySetInnerHTML` must be set using `updateInnerHTMLByID()`.",style:"`style` must be set using `updateStylesByID()`."},l={updatePropertyByID:function(t,i,e){var s=o.getNode(t);h.hasOwnProperty(i)?a(!1):void 0,null!=e?n.setValueForProperty(s,i,e):n.deleteValueForProperty(s,i)},dangerouslyReplaceNodeWithMarkupByID:function(t,i){var e=o.getNode(t);s.dangerouslyReplaceNodeWithMarkup(e,i)},dangerouslyProcessChildrenUpdates:function(t,i){for(var e=0;e<t.length;e++)t[e].parentNode=o.getNode(t[e].parentID);s.processUpdates(t,i)}};r.measureMethods(l,"ReactDOMIDOperations",{dangerouslyReplaceNodeWithMarkupByID:"dangerouslyReplaceNodeWithMarkupByID",dangerouslyProcessChildrenUpdates:"dangerouslyProcessChildrenUpdates"}),t.exports=l},function(t,i,e){"use strict";function s(t){a.enqueueUpdate(t)}function n(t,i){var e=r.get(t);return e?e:null}var o=(e(11),e(6)),r=e(20),a=e(8),h=e(2),l=e(1),u=(e(3),{isMounted:function(t){var i=r.get(t);return i?!!i._renderedComponent:!1},enqueueCallback:function(t,i){"function"!=typeof i?l(!1):void 0;var e=n(t);return e?(e._pendingCallbacks?e._pendingCallbacks.push(i):e._pendingCallbacks=[i],void s(e)):null},enqueueCallbackInternal:function(t,i){"function"!=typeof i?l(!1):void 0,t._pendingCallbacks?t._pendingCallbacks.push(i):t._pendingCallbacks=[i],s(t)},enqueueForceUpdate:function(t){var i=n(t,"forceUpdate");i&&(i._pendingForceUpdate=!0,s(i))},enqueueReplaceState:function(t,i){var e=n(t,"replaceState");e&&(e._pendingStateQueue=[i],e._pendingReplaceState=!0,s(e))},enqueueSetState:function(t,i){var e=n(t,"setState");if(e){var o=e._pendingStateQueue||(e._pendingStateQueue=[]);o.push(i),s(e)}},enqueueSetProps:function(t,i){var e=n(t,"setProps");e&&u.enqueueSetPropsInternal(e,i)},enqueueSetPropsInternal:function(t,i){var e=t._topLevelWrapper;e?void 0:l(!1);var n=e._pendingElement||e._currentElement,r=n.props,a=h({},r.props,i);e._pendingElement=o.cloneAndReplaceProps(n,o.cloneAndReplaceProps(r,a)),s(e)},enqueueReplaceProps:function(t,i){var e=n(t,"replaceProps");e&&u.enqueueReplacePropsInternal(e,i)},enqueueReplacePropsInternal:function(t,i){var e=t._topLevelWrapper;e?void 0:l(!1);var n=e._pendingElement||e._currentElement,r=n.props;e._pendingElement=o.cloneAndReplaceProps(n,o.cloneAndReplaceProps(r,i)),s(e)},enqueueElementInternal:function(t,i){t._pendingElement=i,s(t)}});t.exports=u},function(t,i){"use strict";t.exports="0.14.3"},function(t,i,e){"use strict";function s(t){return null==t?null:1===t.nodeType?t:n.has(t)?o.getNodeFromInstance(t):(null!=t.render&&"function"==typeof t.render?r(!1):void 0,void r(!1))}var n=(e(11),e(20)),o=e(5),r=e(1);e(3);t.exports=s},function(t,i){"use strict";function e(t){var i,e=t.keyCode;return"charCode"in t?(i=t.charCode,0===i&&13===e&&(i=13)):i=e,i>=32||13===i?i:0}t.exports=e},function(t,i){"use strict";function e(t){var i=this,e=i.nativeEvent;if(e.getModifierState)return e.getModifierState(t);var s=n[t];return s?!!e[s]:!1}function s(t){return e}var n={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};t.exports=s},function(t,i){"use strict";function e(t){var i=t.target||t.srcElement||window;return 3===i.nodeType?i.parentNode:i}t.exports=e},function(t,i){"use strict";function e(t){var i=t&&(s&&t[s]||t[n]);return"function"==typeof i?i:void 0}var s="function"==typeof Symbol&&Symbol.iterator,n="@@iterator";t.exports=e},function(t,i,e){"use strict";function s(t){return"function"==typeof t&&"undefined"!=typeof t.prototype&&"function"==typeof t.prototype.mountComponent&&"function"==typeof t.prototype.receiveComponent}function n(t){var i;if(null===t||t===!1)i=new r(n);else if("object"==typeof t){var e=t;!e||"function"!=typeof e.type&&"string"!=typeof e.type?l(!1):void 0,i="string"==typeof e.type?a.createInternalComponent(e):s(e.type)?new e.type(e):new u}else"string"==typeof t||"number"==typeof t?i=a.createInstanceForText(t):l(!1);return i.construct(t),i._mountIndex=0,i._mountImage=null,i}var o=e(102),r=e(63),a=e(69),h=e(2),l=e(1),u=(e(3),function(){});h(u.prototype,o.Mixin,{_instantiateReactComponent:n}),t.exports=n},function(t,i,e){"use strict";function s(t,i){if(!o.canUseDOM||i&&!("addEventListener"in document))return!1;var e="on"+t,s=e in document;if(!s){var r=document.createElement("div");r.setAttribute(e,"return;"),s="function"==typeof r[e]}return!s&&n&&"wheel"===t&&(s=document.implementation.hasFeature("Events.wheel","3.0")),s}var n,o=e(4);o.canUseDOM&&(n=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0),t.exports=s},function(t,i,e){"use strict";var s=e(4),n=e(29),o=e(30),r=function(t,i){t.textContent=i};s.canUseDOM&&("textContent"in document.documentElement||(r=function(t,i){o(t,n(i))})),t.exports=r},function(t,i){"use strict";function e(t,i){var e=null===t||t===!1,s=null===i||i===!1;if(e||s)return e===s;var n=typeof t,o=typeof i;return"string"===n||"number"===n?"string"===o||"number"===o:"object"===o&&t.type===i.type&&t.key===i.key}t.exports=e},function(t,i,e){"use strict";function s(t){return f[t]}function n(t,i){return t&&null!=t.key?r(t.key):i.toString(36)}function o(t){return(""+t).replace(y,s)}function r(t){return"$"+o(t)}function a(t,i,e,s){var o=typeof t;if(("undefined"===o||"boolean"===o)&&(t=null),null===t||"string"===o||"number"===o||l.isValidElement(t))return e(s,t,""===i?d+n(t,0):i),1;var h,u,f=0,y=""===i?d:i+m;if(Array.isArray(t))for(var x=0;x<t.length;x++)h=t[x],u=y+n(h,x),f+=a(h,u,e,s);else{var v=c(t);if(v){var g,b=v.call(t);if(v!==t.entries)for(var N=0;!(g=b.next()).done;)h=g.value,u=y+n(h,N++),f+=a(h,u,e,s);else for(;!(g=b.next()).done;){var C=g.value;C&&(h=C[1],u=y+r(C[0])+m+n(h,0),f+=a(h,u,e,s))}}else if("object"===o){String(t);p(!1)}}return f}function h(t,i,e){return null==t?0:a(t,"",i,e)}var l=(e(11),e(6)),u=e(17),c=e(44),p=e(1),d=(e(3),u.SEPARATOR),m=":",f={"=":"=0",".":"=1",":":"=2"},y=/[=.:]/g;t.exports=h},function(t,i,e){"use strict";var s=(e(2),e(9)),n=(e(3),s);t.exports=n},function(t,i){"use strict";function e(t,i){return t+i.charAt(0).toUpperCase()+i.substring(1)}var s={animationIterationCount:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,stopOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0},n=["Webkit","ms","Moz","O"];Object.keys(s).forEach(function(t){n.forEach(function(i){s[e(i,t)]=s[t]})});var o={background:{backgroundAttachment:!0,backgroundColor:!0,backgroundImage:!0,backgroundPositionX:!0,backgroundPositionY:!0,backgroundRepeat:!0},backgroundPosition:{backgroundPositionX:!0,backgroundPositionY:!0},border:{borderWidth:!0,borderStyle:!0,borderColor:!0},borderBottom:{borderBottomWidth:!0,borderBottomStyle:!0,borderBottomColor:!0},borderLeft:{borderLeftWidth:!0,borderLeftStyle:!0,borderLeftColor:!0},borderRight:{borderRightWidth:!0,borderRightStyle:!0,borderRightColor:!0},borderTop:{borderTopWidth:!0,borderTopStyle:!0,borderTopColor:!0},font:{fontStyle:!0,fontVariant:!0,fontWeight:!0,fontSize:!0,lineHeight:!0,fontFamily:!0},outline:{outlineWidth:!0,outlineStyle:!0,outlineColor:!0}},r={isUnitlessNumber:s,shorthandPropertyExpansions:o};t.exports=r},function(t,i,e){"use strict";function s(t,i,e){var s=e>=t.childNodes.length?null:t.childNodes.item(e);t.insertBefore(i,s)}var n=e(93),o=e(68),r=e(7),a=e(30),h=e(47),l=e(1),u={dangerouslyReplaceNodeWithMarkup:n.dangerouslyReplaceNodeWithMarkup,updateTextContent:h,processUpdates:function(t,i){for(var e,r=null,u=null,c=0;c<t.length;c++)if(e=t[c],e.type===o.MOVE_EXISTING||e.type===o.REMOVE_NODE){var p=e.fromIndex,d=e.parentNode.childNodes[p],m=e.parentID;d?void 0:l(!1),r=r||{},r[m]=r[m]||[],r[m][p]=d,u=u||[],u.push(d)}var f;if(f=i.length&&"string"==typeof i[0]?n.dangerouslyRenderMarkup(i):i,u)for(var y=0;y<u.length;y++)u[y].parentNode.removeChild(u[y]);for(var x=0;x<t.length;x++)switch(e=t[x],e.type){case o.INSERT_MARKUP:s(e.parentNode,f[e.markupIndex],e.toIndex);break;case o.MOVE_EXISTING:s(e.parentNode,r[e.parentID][e.fromIndex],e.toIndex);break;case o.SET_MARKUP:a(e.parentNode,e.content);break;case o.TEXT_CONTENT:h(e.parentNode,e.content);break;case o.REMOVE_NODE:}}};r.measureMethods(u,"DOMChildrenOperations",{updateTextContent:"updateTextContent"}),t.exports=u},function(t,i,e){"use strict";function s(){if(a)for(var t in h){var i=h[t],e=a.indexOf(t);if(e>-1?void 0:r(!1),!l.plugins[e]){i.extractEvents?void 0:r(!1),l.plugins[e]=i;var s=i.eventTypes;for(var o in s)n(s[o],i,o)?void 0:r(!1)}}}function n(t,i,e){l.eventNameDispatchConfigs.hasOwnProperty(e)?r(!1):void 0,l.eventNameDispatchConfigs[e]=t;var s=t.phasedRegistrationNames;if(s){for(var n in s)if(s.hasOwnProperty(n)){var a=s[n];o(a,i,e)}return!0}return t.registrationName?(o(t.registrationName,i,e),!0):!1}function o(t,i,e){l.registrationNameModules[t]?r(!1):void 0,l.registrationNameModules[t]=i,l.registrationNameDependencies[t]=i.eventTypes[e].dependencies}var r=e(1),a=null,h={},l={plugins:[],eventNameDispatchConfigs:{},registrationNameModules:{},registrationNameDependencies:{},injectEventPluginOrder:function(t){a?r(!1):void 0,a=Array.prototype.slice.call(t),s()},injectEventPluginsByName:function(t){var i=!1;for(var e in t)if(t.hasOwnProperty(e)){var n=t[e];h.hasOwnProperty(e)&&h[e]===n||(h[e]?r(!1):void 0,h[e]=n,i=!0)}i&&s()},getPluginModuleForEvent:function(t){var i=t.dispatchConfig;if(i.registrationName)return l.registrationNameModules[i.registrationName]||null;for(var e in i.phasedRegistrationNames)if(i.phasedRegistrationNames.hasOwnProperty(e)){var s=l.registrationNameModules[i.phasedRegistrationNames[e]];if(s)return s}return null},_resetEventPlugins:function(){a=null;for(var t in h)h.hasOwnProperty(t)&&delete h[t];l.plugins.length=0;var i=l.eventNameDispatchConfigs;for(var e in i)i.hasOwnProperty(e)&&delete i[e];var s=l.registrationNameModules;for(var n in s)s.hasOwnProperty(n)&&delete s[n]}};t.exports=l},function(t,i,e){"use strict";function s(t){return(""+t).replace(b,"//")}function n(t,i){this.func=t,this.context=i,this.count=0}function o(t,i,e){var s=t.func,n=t.context;s.call(n,i,t.count++)}function r(t,i,e){if(null==t)return t;var s=n.getPooled(i,e);x(t,o,s),n.release(s)}function a(t,i,e,s){this.result=t,this.keyPrefix=i,this.func=e,this.context=s,this.count=0}function h(t,i,e){var n=t.result,o=t.keyPrefix,r=t.func,a=t.context,h=r.call(a,i,t.count++);Array.isArray(h)?l(h,n,e,y.thatReturnsArgument):null!=h&&(f.isValidElement(h)&&(h=f.cloneAndReplaceKey(h,o+(h!==i?s(h.key||"")+"/":"")+e)),n.push(h))}function l(t,i,e,n,o){var r="";null!=e&&(r=s(e)+"/");var l=a.getPooled(i,r,n,o);x(t,h,l),a.release(l)}function u(t,i,e){if(null==t)return t;var s=[];return l(t,s,null,i,e),s}function c(t,i,e){return null}function p(t,i){return x(t,c,null)}function d(t){var i=[];return l(t,i,null,y.thatReturnsArgument),i}var m=e(12),f=e(6),y=e(9),x=e(49),v=m.twoArgumentPooler,g=m.fourArgumentPooler,b=/\/(?!\/)/g;n.prototype.destructor=function(){this.func=null,this.context=null,this.count=0},m.addPoolingTo(n,v),a.prototype.destructor=function(){this.result=null,this.keyPrefix=null,this.func=null,this.context=null,this.count=0},m.addPoolingTo(a,g);var N={forEach:r,map:u,mapIntoWithKeyPrefixInternal:l,count:p,toArray:d};t.exports=N},function(t,i,e){"use strict";function s(t,i){var e=C.hasOwnProperty(i)?C[i]:null;A.hasOwnProperty(i)&&(e!==b.OVERRIDE_BASE?y(!1):void 0),t.hasOwnProperty(i)&&(e!==b.DEFINE_MANY&&e!==b.DEFINE_MANY_MERGED?y(!1):void 0)}function n(t,i){if(i){"function"==typeof i?y(!1):void 0,p.isValidElement(i)?y(!1):void 0;var e=t.prototype;i.hasOwnProperty(g)&&P.mixins(t,i.mixins);for(var n in i)if(i.hasOwnProperty(n)&&n!==g){var o=i[n];if(s(e,n),P.hasOwnProperty(n))P[n](t,o);else{var r=C.hasOwnProperty(n),l=e.hasOwnProperty(n),u="function"==typeof o,c=u&&!r&&!l&&i.autobind!==!1;if(c)e.__reactAutoBindMap||(e.__reactAutoBindMap={}),e.__reactAutoBindMap[n]=o,e[n]=o;else if(l){var d=C[n];!r||d!==b.DEFINE_MANY_MERGED&&d!==b.DEFINE_MANY?y(!1):void 0,d===b.DEFINE_MANY_MERGED?e[n]=a(e[n],o):d===b.DEFINE_MANY&&(e[n]=h(e[n],o))}else e[n]=o}}}}function o(t,i){if(i)for(var e in i){var s=i[e];if(i.hasOwnProperty(e)){var n=e in P;n?y(!1):void 0;var o=e in t;o?y(!1):void 0,t[e]=s}}}function r(t,i){t&&i&&"object"==typeof t&&"object"==typeof i?void 0:y(!1);for(var e in i)i.hasOwnProperty(e)&&(void 0!==t[e]?y(!1):void 0,t[e]=i[e]);return t}function a(t,i){return function(){var e=t.apply(this,arguments),s=i.apply(this,arguments);if(null==e)return s;if(null==s)return e;var n={};return r(n,e),r(n,s),n}}function h(t,i){return function(){t.apply(this,arguments),i.apply(this,arguments)}}function l(t,i){var e=i.bind(t);return e}function u(t){for(var i in t.__reactAutoBindMap)if(t.__reactAutoBindMap.hasOwnProperty(i)){var e=t.__reactAutoBindMap[i];t[i]=l(t,e)}}var c=e(56),p=e(6),d=(e(25),e(24),e(70)),m=e(2),f=e(22),y=e(1),x=e(31),v=e(13),g=(e(3),v({mixins:null})),b=x({DEFINE_ONCE:null,DEFINE_MANY:null,OVERRIDE_BASE:null,DEFINE_MANY_MERGED:null}),N=[],C={mixins:b.DEFINE_MANY,statics:b.DEFINE_MANY,propTypes:b.DEFINE_MANY,contextTypes:b.DEFINE_MANY,childContextTypes:b.DEFINE_MANY,getDefaultProps:b.DEFINE_MANY_MERGED,getInitialState:b.DEFINE_MANY_MERGED,getChildContext:b.DEFINE_MANY_MERGED,render:b.DEFINE_ONCE,componentWillMount:b.DEFINE_MANY,componentDidMount:b.DEFINE_MANY,componentWillReceiveProps:b.DEFINE_MANY,shouldComponentUpdate:b.DEFINE_ONCE,componentWillUpdate:b.DEFINE_MANY,componentDidUpdate:b.DEFINE_MANY,componentWillUnmount:b.DEFINE_MANY,updateComponent:b.OVERRIDE_BASE},P={displayName:function(t,i){t.displayName=i},mixins:function(t,i){if(i)for(var e=0;e<i.length;e++)n(t,i[e])},childContextTypes:function(t,i){t.childContextTypes=m({},t.childContextTypes,i)},contextTypes:function(t,i){t.contextTypes=m({},t.contextTypes,i)},getDefaultProps:function(t,i){t.getDefaultProps?t.getDefaultProps=a(t.getDefaultProps,i):t.getDefaultProps=i},propTypes:function(t,i){t.propTypes=m({},t.propTypes,i)},statics:function(t,i){o(t,i)},autobind:function(){}},A={replaceState:function(t,i){this.updater.enqueueReplaceState(this,t),i&&this.updater.enqueueCallback(this,i)},isMounted:function(){return this.updater.isMounted(this)},setProps:function(t,i){this.updater.enqueueSetProps(this,t),i&&this.updater.enqueueCallback(this,i)},replaceProps:function(t,i){this.updater.enqueueReplaceProps(this,t),i&&this.updater.enqueueCallback(this,i)}},S=function(){};m(S.prototype,c.prototype,A);var k={createClass:function(t){var i=function(t,i,e){this.__reactAutoBindMap&&u(this),this.props=t,this.context=i,this.refs=f,this.updater=e||d,this.state=null;var s=this.getInitialState?this.getInitialState():null;"object"!=typeof s||Array.isArray(s)?y(!1):void 0,this.state=s};i.prototype=new S,i.prototype.constructor=i,N.forEach(n.bind(null,i)),n(i,t),i.getDefaultProps&&(i.defaultProps=i.getDefaultProps()),i.prototype.render?void 0:y(!1);for(var e in C)i.prototype[e]||(i.prototype[e]=null);return i},injection:{injectMixin:function(t){N.push(t)}}};t.exports=k},function(t,i,e){"use strict";function s(t,i,e){this.props=t,this.context=i,this.refs=o,this.updater=e||n}var n=e(70),o=(e(28),e(22)),r=e(1);e(3);s.prototype.isReactComponent={},s.prototype.setState=function(t,i){"object"!=typeof t&&"function"!=typeof t&&null!=t?r(!1):void 0,this.updater.enqueueSetState(this,t),i&&this.updater.enqueueCallback(this,i)},s.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this),t&&this.updater.enqueueCallback(this,t)};t.exports=s},function(t,i){"use strict";var e={useCreateElement:!1};t.exports=e},function(t,i,e){"use strict";function s(){if(this._rootNodeID&&this._wrapperState.pendingUpdate){this._wrapperState.pendingUpdate=!1;var t=this._currentElement.props,i=r.getValue(t);null!=i&&n(this,t,i)}}function n(t,i,e){var s,n,o=a.getNode(t._rootNodeID).options;if(i){for(s={},n=0;n<e.length;n++)s[""+e[n]]=!0;for(n=0;n<o.length;n++){var r=s.hasOwnProperty(o[n].value);o[n].selected!==r&&(o[n].selected=r)}}else{for(s=""+e,n=0;n<o.length;n++)if(o[n].value===s)return void(o[n].selected=!0);o.length&&(o[0].selected=!0)}}function o(t){var i=this._currentElement.props,e=r.executeOnChange(i,t);return this._wrapperState.pendingUpdate=!0,h.asap(s,this),e}var r=e(34),a=e(5),h=e(8),l=e(2),u=(e(3),"__ReactDOMSelect_value$"+Math.random().toString(36).slice(2)),c={valueContextKey:u,getNativeProps:function(t,i,e){return l({},i,{onChange:t._wrapperState.onChange,value:void 0})},mountWrapper:function(t,i){var e=r.getValue(i);t._wrapperState={pendingUpdate:!1,initialValue:null!=e?e:i.defaultValue,onChange:o.bind(t),wasMultiple:Boolean(i.multiple)}},processChildContext:function(t,i,e){var s=l({},e);return s[u]=t._wrapperState.initialValue,s},postUpdateWrapper:function(t){var i=t._currentElement.props;t._wrapperState.initialValue=void 0;var e=t._wrapperState.wasMultiple;t._wrapperState.wasMultiple=Boolean(i.multiple);var s=r.getValue(i);null!=s?(t._wrapperState.pendingUpdate=!1,n(t,Boolean(i.multiple),s)):e!==Boolean(i.multiple)&&(null!=i.defaultValue?n(t,Boolean(i.multiple),i.defaultValue):n(t,Boolean(i.multiple),i.multiple?[]:""))}};t.exports=c},function(t,i,e){"use strict";var s=e(52),n=e(33),o=e(35),r=e(5),a=e(2),h=e(29),l=e(47),u=(e(50),function(t){});a(u.prototype,{construct:function(t){this._currentElement=t,this._stringText=""+t,this._rootNodeID=null,this._mountIndex=0},mountComponent:function(t,i,e){if(this._rootNodeID=t,i.useCreateElement){var s=e[r.ownerDocumentContextKey],o=s.createElement("span");return n.setAttributeForID(o,t),r.getID(o),l(o,this._stringText),o}var a=h(this._stringText);return i.renderToStaticMarkup?a:"<span "+n.createMarkupForID(t)+">"+a+"</span>"},receiveComponent:function(t,i){if(t!==this._currentElement){this._currentElement=t;var e=""+t;if(e!==this._stringText){this._stringText=e;var n=r.getNode(this._rootNodeID);s.updateTextContent(n,e)}}},unmountComponent:function(){o.unmountIDFromEnvironment(this._rootNodeID)}}),t.exports=u},function(t,i,e){"use strict";function s(){this.reinitializeTransaction()}var n=e(8),o=e(27),r=e(2),a=e(9),h={initialize:a,close:function(){p.isBatchingUpdates=!1}},l={initialize:a,close:n.flushBatchedUpdates.bind(n)},u=[l,h];r(s.prototype,o.Mixin,{getTransactionWrappers:function(){return u}});var c=new s,p={isBatchingUpdates:!1,batchedUpdates:function(t,i,e,s,n,o){var r=p.isBatchingUpdates;p.isBatchingUpdates=!0,r?t(i,e,s,n,o):c.perform(t,null,i,e,s,n,o)}};t.exports=p},function(t,i,e){"use strict";function s(){if(!S){S=!0,x.EventEmitter.injectReactEventListener(y),x.EventPluginHub.injectEventPluginOrder(a),x.EventPluginHub.injectInstanceHandle(v),x.EventPluginHub.injectMount(g),x.EventPluginHub.injectEventPluginsByName({SimpleEventPlugin:P,EnterLeaveEventPlugin:h,ChangeEventPlugin:o,SelectEventPlugin:N,BeforeInputEventPlugin:n}),x.NativeComponent.injectGenericComponentClass(m),x.NativeComponent.injectTextComponentClass(f),x.Class.injectMixin(c),x.DOMProperty.injectDOMPropertyConfig(u),x.DOMProperty.injectDOMPropertyConfig(A),x.EmptyComponent.injectEmptyComponent("noscript"),x.Updates.injectReconcileTransaction(b),x.Updates.injectBatchingStrategy(d),x.RootIndex.injectCreateReactRootIndex(l.canUseDOM?r.createReactRootIndex:C.createReactRootIndex),x.Component.injectEnvironment(p)}}var n=e(89),o=e(91),r=e(92),a=e(94),h=e(95),l=e(4),u=e(98),c=e(100),p=e(35),d=e(60),m=e(105),f=e(59),y=e(113),x=e(114),v=e(17),g=e(5),b=e(118),N=e(124),C=e(125),P=e(126),A=e(123),S=!1;t.exports={inject:s}},function(t,i,e){"use strict";function s(){if(c.current){var t=c.current.getName();if(t)return" Check the render method of `"+t+"`."}return""}function n(t,i){if(t._store&&!t._store.validated&&null==t.key){t._store.validated=!0;o("uniqueKey",t,i)}}function o(t,i,e){var n=s();if(!n){var o="string"==typeof e?e:e.displayName||e.name;o&&(n=" Check the top-level render call using <"+o+">.")}var r=m[t]||(m[t]={});if(r[n])return null;r[n]=!0;var a={parentOrOwner:n,url:" See https://fb.me/react-warning-keys for more information.",childOwner:null};return i&&i._owner&&i._owner!==c.current&&(a.childOwner=" It was passed a child from "+i._owner.getName()+"."),a}function r(t,i){if("object"==typeof t)if(Array.isArray(t))for(var e=0;e<t.length;e++){var s=t[e];l.isValidElement(s)&&n(s,i)}else if(l.isValidElement(t))t._store&&(t._store.validated=!0);else if(t){var o=p(t);if(o&&o!==t.entries)for(var r,a=o.call(t);!(r=a.next()).done;)l.isValidElement(r.value)&&n(r.value,i)}}function a(t,i,e,n){for(var o in i)if(i.hasOwnProperty(o)){var r;try{"function"!=typeof i[o]?d(!1):void 0,r=i[o](e,o,t,n)}catch(a){r=a}if(r instanceof Error&&!(r.message in f)){f[r.message]=!0;s()}}}function h(t){var i=t.type;if("function"==typeof i){var e=i.displayName||i.name;i.propTypes&&a(e,i.propTypes,t.props,u.prop),"function"==typeof i.getDefaultProps}}var l=e(6),u=e(25),c=(e(24),e(11)),p=(e(28),e(44)),d=e(1),m=(e(3),{}),f={},y={createElement:function(t,i,e){var s="string"==typeof t||"function"==typeof t,n=l.createElement.apply(this,arguments);if(null==n)return n;if(s)for(var o=2;o<arguments.length;o++)r(arguments[o],t);return h(n),n},createFactory:function(t){var i=y.createElement.bind(null,t);return i.type=t,i},cloneElement:function(t,i,e){for(var s=l.cloneElement.apply(this,arguments),n=2;n<arguments.length;n++)r(arguments[n],s.type);return h(s),s}};t.exports=y},function(t,i,e){"use strict";var s,n=e(6),o=e(64),r=e(14),a=e(2),h={injectEmptyComponent:function(t){s=n.createElement(t)}},l=function(t){this._currentElement=null,this._rootNodeID=null,this._renderedComponent=t(s)};a(l.prototype,{construct:function(t){},mountComponent:function(t,i,e){return o.registerNullComponentID(t),this._rootNodeID=t,r.mountComponent(this._renderedComponent,t,i,e)},receiveComponent:function(){},unmountComponent:function(t,i,e){r.unmountComponent(this._renderedComponent),o.deregisterNullComponentID(this._rootNodeID),this._rootNodeID=null,this._renderedComponent=null}}),l.injection=h,t.exports=l},function(t,i){"use strict";function e(t){return!!o[t]}function s(t){o[t]=!0}function n(t){delete o[t]}var o={},r={isNullComponentID:e,registerNullComponentID:s,deregisterNullComponentID:n};t.exports=r},function(t,i,e){"use strict";function s(t,i,e,s){try{return i(e,s)}catch(o){return void(null===n&&(n=o))}}var n=null,o={invokeGuardedCallback:s,invokeGuardedCallbackWithCatch:s,rethrowCaughtError:function(){if(n){var t=n;throw n=null,t}}};t.exports=o},function(t,i,e){"use strict";function s(t){return o(document.documentElement,t)}var n=e(109),o=e(79),r=e(80),a=e(81),h={hasSelectionCapabilities:function(t){var i=t&&t.nodeName&&t.nodeName.toLowerCase();return i&&("input"===i&&"text"===t.type||"textarea"===i||"true"===t.contentEditable)},getSelectionInformation:function(){var t=a();return{focusedElem:t,selectionRange:h.hasSelectionCapabilities(t)?h.getSelection(t):null}},restoreSelection:function(t){var i=a(),e=t.focusedElem,n=t.selectionRange;i!==e&&s(e)&&(h.hasSelectionCapabilities(e)&&h.setSelection(e,n),r(e))},getSelection:function(t){var i;if("selectionStart"in t)i={start:t.selectionStart,end:t.selectionEnd};else if(document.selection&&t.nodeName&&"input"===t.nodeName.toLowerCase()){var e=document.selection.createRange();e.parentElement()===t&&(i={start:-e.moveStart("character",-t.value.length),end:-e.moveEnd("character",-t.value.length)})}else i=n.getOffsets(t);return i||{start:0,end:0}},setSelection:function(t,i){var e=i.start,s=i.end;if("undefined"==typeof s&&(s=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(s,t.value.length);else if(document.selection&&t.nodeName&&"input"===t.nodeName.toLowerCase()){var o=t.createTextRange();o.collapse(!0),o.moveStart("character",e),o.moveEnd("character",s-e),o.select()}else n.setOffsets(t,i)}};t.exports=h},function(t,i,e){"use strict";var s=e(135),n=/\/?>/,o={CHECKSUM_ATTR_NAME:"data-react-checksum",addChecksumToMarkup:function(t){var i=s(t);return t.replace(n," "+o.CHECKSUM_ATTR_NAME+'="'+i+'"$&')},canReuseMarkup:function(t,i){var e=i.getAttribute(o.CHECKSUM_ATTR_NAME);e=e&&parseInt(e,10);var n=s(t);return n===e}};t.exports=o},function(t,i,e){"use strict";var s=e(31),n=s({INSERT_MARKUP:null,MOVE_EXISTING:null,REMOVE_NODE:null,SET_MARKUP:null,TEXT_CONTENT:null});t.exports=n},function(t,i,e){"use strict";function s(t){if("function"==typeof t.type)return t.type;var i=t.type,e=c[i];return null==e&&(c[i]=e=l(i)),e}function n(t){return u?void 0:h(!1),new u(t.type,t.props)}function o(t){return new p(t)}function r(t){return t instanceof p}var a=e(2),h=e(1),l=null,u=null,c={},p=null,d={injectGenericComponentClass:function(t){u=t},injectTextComponentClass:function(t){p=t},injectComponentClasses:function(t){a(c,t)}},m={getComponentClassForElement:s,createInternalComponent:n,createInstanceForText:o,isTextComponent:r,injection:d};t.exports=m},function(t,i,e){"use strict";function s(t,i){}var n=(e(3),{isMounted:function(t){return!1},enqueueCallback:function(t,i){},enqueueForceUpdate:function(t){s(t,"forceUpdate")},enqueueReplaceState:function(t,i){s(t,"replaceState")},enqueueSetState:function(t,i){s(t,"setState")},enqueueSetProps:function(t,i){s(t,"setProps")},enqueueReplaceProps:function(t,i){s(t,"replaceProps")}});t.exports=n},function(t,i,e){"use strict";function s(t){function i(i,e,s,n,o,r){if(n=n||C,r=r||s,null==e[s]){var a=g[o];return i?new Error("Required "+a+" `"+r+"` was not specified in "+("`"+n+"`.")):null}return t(e,s,n,o,r)}var e=i.bind(null,!1);return e.isRequired=i.bind(null,!0),e}function n(t){function i(i,e,s,n,o){var r=i[e],a=f(r);if(a!==t){var h=g[n],l=y(r);return new Error("Invalid "+h+" `"+o+"` of type "+("`"+l+"` supplied to `"+s+"`, expected ")+("`"+t+"`."))}return null}return s(i)}function o(){return s(b.thatReturns(null))}function r(t){function i(i,e,s,n,o){var r=i[e];if(!Array.isArray(r)){var a=g[n],h=f(r);return new Error("Invalid "+a+" `"+o+"` of type "+("`"+h+"` supplied to `"+s+"`, expected an array."))}for(var l=0;l<r.length;l++){var u=t(r,l,s,n,o+"["+l+"]");if(u instanceof Error)return u}return null}return s(i)}function a(){function t(t,i,e,s,n){if(!v.isValidElement(t[i])){var o=g[s];return new Error("Invalid "+o+" `"+n+"` supplied to "+("`"+e+"`, expected a single ReactElement."))}return null}return s(t)}function h(t){function i(i,e,s,n,o){if(!(i[e]instanceof t)){var r=g[n],a=t.name||C,h=x(i[e]);return new Error("Invalid "+r+" `"+o+"` of type "+("`"+h+"` supplied to `"+s+"`, expected ")+("instance of `"+a+"`."))}return null}return s(i)}function l(t){function i(i,e,s,n,o){for(var r=i[e],a=0;a<t.length;a++)if(r===t[a])return null;var h=g[n],l=JSON.stringify(t);return new Error("Invalid "+h+" `"+o+"` of value `"+r+"` "+("supplied to `"+s+"`, expected one of "+l+"."))}return s(Array.isArray(t)?i:function(){return new Error("Invalid argument supplied to oneOf, expected an instance of array.");
})}function u(t){function i(i,e,s,n,o){var r=i[e],a=f(r);if("object"!==a){var h=g[n];return new Error("Invalid "+h+" `"+o+"` of type "+("`"+a+"` supplied to `"+s+"`, expected an object."))}for(var l in r)if(r.hasOwnProperty(l)){var u=t(r,l,s,n,o+"."+l);if(u instanceof Error)return u}return null}return s(i)}function c(t){function i(i,e,s,n,o){for(var r=0;r<t.length;r++){var a=t[r];if(null==a(i,e,s,n,o))return null}var h=g[n];return new Error("Invalid "+h+" `"+o+"` supplied to "+("`"+s+"`."))}return s(Array.isArray(t)?i:function(){return new Error("Invalid argument supplied to oneOfType, expected an instance of array.")})}function p(){function t(t,i,e,s,n){if(!m(t[i])){var o=g[s];return new Error("Invalid "+o+" `"+n+"` supplied to "+("`"+e+"`, expected a ReactNode."))}return null}return s(t)}function d(t){function i(i,e,s,n,o){var r=i[e],a=f(r);if("object"!==a){var h=g[n];return new Error("Invalid "+h+" `"+o+"` of type `"+a+"` "+("supplied to `"+s+"`, expected `object`."))}for(var l in t){var u=t[l];if(u){var c=u(r,l,s,n,o+"."+l);if(c)return c}}return null}return s(i)}function m(t){switch(typeof t){case"number":case"string":case"undefined":return!0;case"boolean":return!t;case"object":if(Array.isArray(t))return t.every(m);if(null===t||v.isValidElement(t))return!0;var i=N(t);if(!i)return!1;var e,s=i.call(t);if(i!==t.entries){for(;!(e=s.next()).done;)if(!m(e.value))return!1}else for(;!(e=s.next()).done;){var n=e.value;if(n&&!m(n[1]))return!1}return!0;default:return!1}}function f(t){var i=typeof t;return Array.isArray(t)?"array":t instanceof RegExp?"object":i}function y(t){var i=f(t);if("object"===i){if(t instanceof Date)return"date";if(t instanceof RegExp)return"regexp"}return i}function x(t){return t.constructor&&t.constructor.name?t.constructor.name:"<<anonymous>>"}var v=e(6),g=e(24),b=e(9),N=e(44),C="<<anonymous>>",P={array:n("array"),bool:n("boolean"),func:n("function"),number:n("number"),object:n("object"),string:n("string"),any:o(),arrayOf:r,element:a(),instanceOf:h,node:p(),objectOf:u,oneOf:l,oneOfType:c,shape:d};t.exports=P},function(t,i){"use strict";var e={injectCreateReactRootIndex:function(t){s.createReactRootIndex=t}},s={createReactRootIndex:null,injection:e};t.exports=s},function(t,i){"use strict";var e={currentScrollLeft:0,currentScrollTop:0,refreshScrollValues:function(t){e.currentScrollLeft=t.x,e.currentScrollTop=t.y}};t.exports=e},function(t,i,e){"use strict";function s(t,i){if(null==i?n(!1):void 0,null==t)return i;var e=Array.isArray(t),s=Array.isArray(i);return e&&s?(t.push.apply(t,i),t):e?(t.push(i),t):s?[t].concat(i):[t,i]}var n=e(1);t.exports=s},function(t,i){"use strict";var e=function(t,i,e){Array.isArray(t)?t.forEach(i,e):t&&i.call(e,t)};t.exports=e},function(t,i,e){"use strict";function s(){return!o&&n.canUseDOM&&(o="textContent"in document.documentElement?"textContent":"innerText"),o}var n=e(4),o=null;t.exports=s},function(t,i){"use strict";function e(t){var i=t&&t.nodeName&&t.nodeName.toLowerCase();return i&&("input"===i&&s[t.type]||"textarea"===i)}var s={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};t.exports=e},function(t,i,e){"use strict";var s=e(9),n={listen:function(t,i,e){return t.addEventListener?(t.addEventListener(i,e,!1),{remove:function(){t.removeEventListener(i,e,!1)}}):t.attachEvent?(t.attachEvent("on"+i,e),{remove:function(){t.detachEvent("on"+i,e)}}):void 0},capture:function(t,i,e){return t.addEventListener?(t.addEventListener(i,e,!0),{remove:function(){t.removeEventListener(i,e,!0)}}):{remove:s}},registerDefault:function(){}};t.exports=n},function(t,i,e){"use strict";function s(t,i){var e=!0;t:for(;e;){var s=t,o=i;if(e=!1,s&&o){if(s===o)return!0;if(n(s))return!1;if(n(o)){t=s,i=o.parentNode,e=!0;continue t}return s.contains?s.contains(o):s.compareDocumentPosition?!!(16&s.compareDocumentPosition(o)):!1}return!1}}var n=e(152);t.exports=s},function(t,i){"use strict";function e(t){try{t.focus()}catch(i){}}t.exports=e},function(t,i){"use strict";function e(){if("undefined"==typeof document)return null;try{return document.activeElement||document.body}catch(t){return document.body}}t.exports=e},function(t,i,e){"use strict";function s(t){return r?void 0:o(!1),p.hasOwnProperty(t)||(t="*"),a.hasOwnProperty(t)||("*"===t?r.innerHTML="<link />":r.innerHTML="<"+t+"></"+t+">",a[t]=!r.firstChild),a[t]?p[t]:null}var n=e(4),o=e(1),r=n.canUseDOM?document.createElement("div"):null,a={},h=[1,'<select multiple="true">',"</select>"],l=[1,"<table>","</table>"],u=[3,"<table><tbody><tr>","</tr></tbody></table>"],c=[1,'<svg xmlns="http://www.w3.org/2000/svg">',"</svg>"],p={"*":[1,"?<div>","</div>"],area:[1,"<map>","</map>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],legend:[1,"<fieldset>","</fieldset>"],param:[1,"<object>","</object>"],tr:[2,"<table><tbody>","</tbody></table>"],optgroup:h,option:h,caption:l,colgroup:l,tbody:l,tfoot:l,thead:l,td:u,th:u},d=["circle","clipPath","defs","ellipse","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","text","tspan"];d.forEach(function(t){p[t]=c,a[t]=!0}),t.exports=s},function(t,i){"use strict";function e(t,i){if(t===i)return!0;if("object"!=typeof t||null===t||"object"!=typeof i||null===i)return!1;var e=Object.keys(t),n=Object.keys(i);if(e.length!==n.length)return!1;for(var o=s.bind(i),r=0;r<e.length;r++)if(!o(e[r])||t[e[r]]!==i[e[r]])return!1;return!0}var s=Object.prototype.hasOwnProperty;t.exports=e},function(t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var e=i.BOX="box",s=i.SPHERE="sphere",n=i.CYLINDER="cylinder",o=i.JOINT_DISTANCE="jointDistance",r=i.JOINT_BALL_AND_SOCKET="jointBall",a=i.JOINT_HINGE="jointHinge",h=i.JOINT_WHEEL="jointWheel",l=i.JOINT_SLIDER="jointSlider",u=i.JOINT_PRISMATIC="jointPrismatic",c=i.BRUTE=1,p=i.SWEEP=2,d=i.TREE=3,m=(i.BROADPHASES=[c,p,d],i.SPAWN="SPAWN"),f=i.SETUP="SETUP",y=i.LOOP="LOOP",x=i.TERMINATE="TERMINATE",v=i.BODIES=[e,s,n],g=i.JOINTS=[o,r,a,h,l,u];i.OBJECTS=[].concat(v,g),i.ACTIONS=[m,f,y,x]},function(t,i,e){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function n(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function o(t,i){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!i||"object"!=typeof i&&"function"!=typeof i?t:i}function r(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function, not "+typeof i);t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i&&(Object.setPrototypeOf?Object.setPrototypeOf(t,i):t.__proto__=i)}function a(t,i){if(-1!==t.indexOf(","))throw new Error("name can't have any commas!");return i?[i,t].join(","):t}function h(t){return t.substring(0,t.lastIndexOf(","))}var l=function(){function t(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(i,e,s){return e&&t(i.prototype,e),s&&t(i,s),i}}();Object.defineProperty(i,"__esModule",{value:!0}),i.uniqueUnion=a,i.getParent=h;var u=e(156),c=s(u),p=function(t){var i=function(i){function e(){return n(this,e),o(this,Object.getPrototypeOf(e).apply(this,arguments))}return r(e,i),l(e,[{key:"getChildContext",value:function(){return{id:a(this.props.name,this.context.id)}}},{key:"render",value:function(){return c["default"].createElement(t,this.props)}}]),e}(u.Component);return i.propTypes={name:u.PropTypes.string.isRequired},i.contextTypes={id:u.PropTypes.string.isRequired},i.childContextTypes={id:u.PropTypes.string},i};i["default"]=p},function(t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var e,s={REVISION:"1.2",nextID:0,proxyID:0,BR_NULL:0,BR_BRUTE_FORCE:1,BR_SWEEP_AND_PRUNE:2,BR_BOUNDING_VOLUME_TREE:3,BODY_NULL:0,BODY_DYNAMIC:1,BODY_STATIC:2,SHAPE_NULL:0,SHAPE_SPHERE:1,SHAPE_BOX:2,SHAPE_CYLINDER:3,JOINT_NULL:0,JOINT_DISTANCE:1,JOINT_BALL_AND_SOCKET:2,JOINT_HINGE:3,JOINT_WHEEL:4,JOINT_SLIDER:5,JOINT_PRISMATIC:6,WORLD_SCALE:100,INV_SCALE:.01,AABB_PROX:.005,sqrt:Math.sqrt,abs:Math.abs,floor:Math.floor,cos:Math.cos,sin:Math.sin,acos:Math.acos,asin:Math.asin,atan2:Math.atan2,round:Math.round,pow:Math.pow,max:Math.max,min:Math.min,random:Math.random,lerp:function(t,i,e){return t+(i-t)*e},rand:function(t,i){return s.lerp(t,i,s.random())},randInt:function(t,i,e){return 1*s.lerp(t,i,s.random()).toFixed(e||0)},"int":function(t){return~~t},fix:function(t,i){return t.toFixed(i||3,10)},clamp:function(t,i,e){return s.max(i,s.min(e,t))},degtorad:.017453292519943295,radtodeg:57.29577951308232,PI:3.141592653589793,TwoPI:6.283185307179586,PI90:1.570796326794896,PI270:4.712388980384689,CustomError:null,Error:function(t,i){null==s.CustomError?console.error(t,i):s.CustomError.innerHTML+=t+" - "+i+"<br>"}};e||(e="undefined"!=typeof Float32Array?Float32Array:Array),function(t){var i,e=["now","webkitNow","msNow","mozNow"];if(t.performance)for(var n=0;n<e.length;++n){var o=e[n];if(t.performance[o]){i=function(){return t.performance[o]()};break}}i||(i=Date.now),s.now=i}(self),s.World=function(t,i,e,n){switch(this.timeStep=t||.01666,this.numIterations=e||8,i||2){case 1:this.broadPhase=new s.BruteForceBroadPhase;break;case 2:default:this.broadPhase=new s.SAPBroadPhase;break;case 3:this.broadPhase=new s.DBVTBroadPhase}this.performance=null,this.isNoStat=n||!1,this.isNoStat||(this.performance=new s.Performance(this)),this.enableRandomizer=!0,this.rigidBodies=null,this.numRigidBodies=0,this.contacts=null,this.unusedContacts=null,this.numContacts=0,this.numContactPoints=0,this.joints=null,this.numJoints=0,this.numIslands=0,this.gravity=new s.Vec3(0,-9.80665,0);var o=4;this.detectors=[],this.detectors.length=o;for(var r=o;r--;)this.detectors[r]=[],this.detectors[r].length=o;this.detectors[s.SHAPE_SPHERE][s.SHAPE_SPHERE]=new s.SphereSphereCollisionDetector,this.detectors[s.SHAPE_SPHERE][s.SHAPE_BOX]=new s.SphereBoxCollisionDetector(!1),this.detectors[s.SHAPE_BOX][s.SHAPE_SPHERE]=new s.SphereBoxCollisionDetector(!0),this.detectors[s.SHAPE_BOX][s.SHAPE_BOX]=new s.BoxBoxCollisionDetector,this.detectors[s.SHAPE_CYLINDER][s.SHAPE_CYLINDER]=new s.CylinderCylinderCollisionDetector,this.detectors[s.SHAPE_CYLINDER][s.SHAPE_BOX]=new s.BoxCylinderCollisionDetector(!0),this.detectors[s.SHAPE_BOX][s.SHAPE_CYLINDER]=new s.BoxCylinderCollisionDetector(!1),this.detectors[s.SHAPE_CYLINDER][s.SHAPE_SPHERE]=new s.SphereCylinderCollisionDetector(!0),this.detectors[s.SHAPE_SPHERE][s.SHAPE_CYLINDER]=new s.SphereCylinderCollisionDetector(!1),this.randX=65535,this.randA=98765,this.randB=123456789,this.maxIslandRigidBodies=64,this.islandRigidBodies=[],this.islandRigidBodies.length=this.maxIslandRigidBodies,this.islandStack=[],this.islandStack.length=this.maxIslandRigidBodies,this.maxIslandConstraints=128,this.islandConstraints=[],this.islandConstraints.length=this.maxIslandConstraints},s.World.prototype={constructor:s.World,clear:function(){for(this.randX=65535;null!==this.joints;)this.removeJoint(this.joints);for(;null!==this.contacts;)this.removeContact(this.contacts);for(;null!==this.rigidBodies;)this.removeRigidBody(this.rigidBodies);s.nextID=0,s.proxyID=0},addRigidBody:function(t){t.parent&&s.Error("World","It is not possible to be added to more than one world one of the rigid body"),t.parent=this,t.awake();for(var i=t.shapes;null!==i;i=i.next)this.addShape(i);null!==this.rigidBodies&&((this.rigidBodies.prev=t).next=this.rigidBodies),this.rigidBodies=t,this.numRigidBodies++},removeRigidBody:function(t){var i=t;if(i.parent===this){i.awake();for(var e=i.jointLink;null!=e;){var s=e.joint;e=e.next,this.removeJoint(s)}for(var n=t.shapes;null!==n;n=n.next)this.removeShape(n);var o=i.prev,r=i.next;null!==o&&(o.next=r),null!==r&&(r.prev=o),this.rigidBodies==i&&(this.rigidBodies=r),i.prev=null,i.next=null,i.parent=null,this.numRigidBodies--}},getByName:function(t){for(var i=null,e=this.rigidBodies;null!==e;)" "!==e.name&&e.name===t&&(i=e),e=e.next;for(var s=this.joints;null!==s;)""!==s.name&&s.name===t&&(i=s),s=s.next;return i},addShape:function(t){t.parent&&t.parent.parent||s.Error("World","It is not possible to be added alone to shape world"),t.proxy=this.broadPhase.createProxy(t),t.updateProxy(),this.broadPhase.addProxy(t.proxy)},removeShape:function(t){this.broadPhase.removeProxy(t.proxy),t.proxy=null},addJoint:function(t){t.parent&&s.Error("World","It is not possible to be added to more than one world one of the joint"),null!=this.joints&&((this.joints.prev=t).next=this.joints),this.joints=t,t.parent=this,this.numJoints++,t.awake(),t.attach()},removeJoint:function(t){var i=t,e=i.prev,s=i.next;null!==e&&(e.next=s),null!==s&&(s.prev=e),this.joints==i&&(this.joints=s),i.prev=null,i.next=null,this.numJoints--,i.awake(),i.detach(),i.parent=null},worldscale:function(t){s.WORLD_SCALE=t||100,s.INV_SCALE=1/s.WORLD_SCALE},step:function(){var t,i,e,n,o=this.isNoStat?!1:!0;o&&(t=s.now());for(var r=this.rigidBodies;null!==r;)r.addedToIsland=!1,r.sleeping&&(r.linearVelocity.testZero()||r.angularVelocity.testZero()||r.position.testDiff(r.sleepPosition)||r.orientation.testDiff(r.sleepOrientation))&&r.awake(),r=r.next;o&&(i=s.now()),this.broadPhase.detectPairs();for(var a=this.broadPhase.pairs,h=this.broadPhase.numPairs,l=h;l--;){var u,c,p=a[l];p.shape1.id<p.shape2.id?(u=p.shape1,c=p.shape2):(u=p.shape2,c=p.shape1);var d;d=u.numContacts<c.numContacts?u.contactLink:c.contactLink;for(var m=!1;d;){var f=d.contact;if(f.shape1==u&&f.shape2==c){f.persisting=!0,m=!0;break}d=d.next}m||this.addContact(u,c)}for(o&&(e=s.now(),this.performance.broadPhaseTime=e-i),this.numContactPoints=0,f=this.contacts;null!==f;)if(f.persisting||!f.shape1.aabb.intersectTest(f.shape2.aabb)){var y=f.body1,x=f.body2;(y.isDynamic&&!y.sleeping||x.isDynamic&&!x.sleeping)&&f.updateManifold(),this.numContactPoints+=f.manifold.numPoints,f.persisting=!1,f.constraint.addedToIsland=!1,f=f.next}else{var v=f.next;this.removeContact(f),f=v}o&&(n=s.now(),this.performance.narrowPhaseTime=n-e);var g,b,N=1/this.timeStep;for(g=this.joints;null!==g;g=g.next)g.addedToIsland=!1;this.maxIslandRigidBodies<this.numRigidBodies&&(this.maxIslandRigidBodies=this.numRigidBodies<<1,this.islandRigidBodies=[],this.islandStack=[],this.islandRigidBodies.length=this.maxIslandRigidBodies,this.islandStack.length=this.maxIslandRigidBodies);var C=this.numJoints+this.numContacts;this.maxIslandConstraints<C&&(this.maxIslandConstraints=C<<1,this.islandConstraints=[],this.islandConstraints.length=this.maxIslandConstraints),i=s.now(),this.numIslands=0;for(var P=this.rigidBodies;null!==P;P=P.next)if(!(P.addedToIsland||P.isStatic||P.sleeping))if(P.isLonely())P.isDynamic&&P.linearVelocity.addTime(this.gravity,this.timeStep),this.calSleep(P)?(P.sleepTime+=this.timeStep,P.sleepTime>.5?P.sleep():P.updatePosition(this.timeStep)):(P.sleepTime=0,P.updatePosition(this.timeStep)),this.numIslands++;else{var A=0,S=0,k=1;this.islandStack[0]=P,P.addedToIsland=!0;do if(r=this.islandStack[--k],this.islandStack[k]=null,r.sleeping=!1,this.islandRigidBodies[A++]=r,!r.isStatic){for(var I=r.contactLink;null!==I;I=I.next){var f=I.contact;if(b=f.constraint,!b.addedToIsland&&f.touching){this.islandConstraints[S++]=b,b.addedToIsland=!0;var v=I.body;v.addedToIsland||(this.islandStack[k++]=v,v.addedToIsland=!0)}}for(var z=r.jointLink;null!==z;z=z.next)b=z.joint,b.addedToIsland||(this.islandConstraints[S++]=b,b.addedToIsland=!0,v=z.body,!v.addedToIsland&&v.isDynamic&&(this.islandStack[k++]=v,v.addedToIsland=!0))}while(0!=k);for(var _=(new s.Vec3).addTime(this.gravity,this.timeStep),M=A;M--;)r=this.islandRigidBodies[M],r.isDynamic&&r.linearVelocity.addEqual(_);if(this.enableRandomizer)for(M=S;M--;)if(0!==M){var E=(this.randX=this.randX*this.randA+this.randB&2147483647)/2147483648*M|0;b=this.islandConstraints[M],this.islandConstraints[M]=this.islandConstraints[E],this.islandConstraints[E]=b}for(M=S;M--;)this.islandConstraints[M].preSolve(this.timeStep,N);for(var w=this.numIterations;w--;)for(M=S;M--;)this.islandConstraints[M].solve();for(M=S;M--;)this.islandConstraints[M].postSolve(),this.islandConstraints[M]=null;var D=10;for(M=A;M--;)r=this.islandRigidBodies[M],this.calSleep(r)?(r.sleepTime+=this.timeStep,r.sleepTime<D&&(D=r.sleepTime)):(r.sleepTime=0,D=0);if(D>.5)for(M=A;M--;)this.islandRigidBodies[M].sleep(),this.islandRigidBodies[M]=null;else for(M=A;M--;)this.islandRigidBodies[M].updatePosition(this.timeStep),this.islandRigidBodies[M]=null;this.numIslands++}o&&(e=s.now(),this.performance.solvingTime=e-i,e=s.now(),this.performance.upfps(),this.performance.totalTime=e-t)},addContact:function(t,i){var e;null!==this.unusedContacts?(e=this.unusedContacts,this.unusedContacts=this.unusedContacts.next):e=new s.Contact,e.attach(t,i),e.detector=this.detectors[t.type][i.type],this.contacts&&((this.contacts.prev=e).next=this.contacts),this.contacts=e,this.numContacts++},removeContact:function(t){var i=t.prev,e=t.next;e&&(e.prev=i),i&&(i.next=e),this.contacts==t&&(this.contacts=e),t.prev=null,t.next=null,t.detach(),t.next=this.unusedContacts,this.unusedContacts=t,this.numContacts--},checkContact:function(t,i){for(var e,s,n=this.contacts;null!==n;){if(e=n.body1.name||" ",s=n.body2.name||" ",e==t&&s==i||s==t&&e==i)return n.touching?!0:!1;n=n.next}return!1},calSleep:function(t){return t.allowSleep?t.linearVelocity.lengthSq()>.04?!1:t.angularVelocity.lengthSq()>.25?!1:!0:!1}},s.RigidBody=function(t,i,e,n,o,r,a){this.name=" ",this.MAX_SHAPES=64,this.prev=null,this.next=null,this.type=s.BODY_NULL,this.massInfo=new s.MassInfo,this.position=new s.Vec3(t,i,e),this.orientation=this.rotationAxisToQuad(n||0,o||0,r||0,a||0),this.newPosition=new s.Vec3,this.controlPos=!1,this.newOrientation=new s.Quat,this.newRotation=new s.Vec3,this.currentRotation=new s.Vec3,this.controlRot=!1,this.controlRotInTime=!1,this.linearVelocity=new s.Vec3,this.angularVelocity=new s.Vec3,this.matrix=new s.Mat44,this.parent=null,this.contactLink=null,this.numContacts=0,this.shapes=null,this.numShapes=0,this.jointLink=null,this.numJoints=0,this.sleepPosition=new s.Vec3,this.sleepOrientation=new s.Quat,this.isStatic=!1,this.isDynamic=!1,this.rotation=new s.Mat33,this.mass=NaN,this.inverseMass=NaN,this.inverseInertia=new s.Mat33,this.localInertia=new s.Mat33,this.inverseLocalInertia=new s.Mat33,this.addedToIsland=!1,this.allowSleep=!0,this.sleepTime=0,this.sleeping=!1},s.RigidBody.prototype={constructor:s.RigidBody,addShape:function(t){t.parent&&s.Error("RigidBody","It is not possible that you add to the multi-rigid body the shape of one"),null!=this.shapes&&((this.shapes.prev=t).next=this.shapes),this.shapes=t,t.parent=this,this.parent&&this.parent.addShape(t),this.numShapes++},removeShape:function(t){var i=t;if(i.parent==this){var e=i.prev,s=i.next;null!=e&&(e.next=s),null!=s&&(s.prev=e),this.shapes==i&&(this.shapes=s),i.prev=null,i.next=null,i.parent=null,this.parent&&this.parent.removeShape(i),this.numShapes--}},remove:function(){this.dispose()},dispose:function(){this.parent.removeRigidBody(this)},checkContact:function(t){this.parent.checkContact(this.name,t)},setupMass:function(t,i){var e=void 0!==i?i:!0;this.type=t||s.BODY_DYNAMIC,this.isDynamic=this.type==s.BODY_DYNAMIC,this.isStatic=this.type==s.BODY_STATIC,this.mass=0,this.localInertia.set(0,0,0,0,0,0,0,0,0);for(var n=this.localInertia.elements,o=new s.Mat33,r=new s.Vec3,a=this.shapes;null!=a;a=a.next){a.calculateMassInfo(this.massInfo);var h=this.massInfo.mass,l=a.relativePosition.x,u=a.relativePosition.y,c=a.relativePosition.z;r.addScale(a.relativePosition,h),this.mass+=h,this.rotateInertia(a.relativeRotation,this.massInfo.inertia,o),this.localInertia.addEqual(o),n[0]+=h*(u*u+c*c),n[4]+=h*(l*l+c*c),n[8]+=h*(l*l+u*u);var p=h*l*u,d=h*u*c,m=h*c*l;n[1]-=p,n[3]-=p,n[2]-=d,n[6]-=d,n[5]-=m,n[7]-=m}if(this.inverseMass=1/this.mass,r.scaleEqual(this.inverseMass),e){for(this.position.addEqual(r),a=this.shapes;null!=a;a=a.next)a.relativePosition.subEqual(r);l=r.x,u=r.y,c=r.z,n[0]-=this.mass*(u*u+c*c),n[4]-=this.mass*(l*l+c*c),n[8]-=this.mass*(l*l+u*u),p=this.mass*l*u,d=this.mass*u*c,m=this.mass*c*l,n[1]+=p,n[3]+=p,n[2]+=d,n[6]+=d,n[5]+=m,n[7]+=m}this.inverseLocalInertia.invert(this.localInertia),this.type==s.BODY_STATIC&&(this.inverseMass=0,this.inverseLocalInertia.set(0,0,0,0,0,0,0,0,0)),this.syncShapes(),this.awake()},awake:function(){if(this.allowSleep&&this.sleeping){this.sleeping=!1,this.sleepTime=0;for(var t=this.contactLink;null!=t;)t.body.sleepTime=0,t.body.sleeping=!1,t=t.next;for(var i=this.jointLink;null!=i;)i.body.sleepTime=0,i.body.sleeping=!1,i=i.next;for(var e=this.shapes;null!=e;e=e.next)e.updateProxy()}},sleep:function(){if(this.allowSleep&&!this.sleeping){this.linearVelocity.set(0,0,0),this.angularVelocity.set(0,0,0),this.sleepPosition.copy(this.position),this.sleepOrientation.copy(this.orientation),this.sleepTime=0,this.sleeping=!0;for(var t=this.shapes;null!=t;t=t.next)t.updateProxy()}},isLonely:function(){return 0==this.numJoints&&0==this.numContacts},updatePosition:function(t){switch(this.type){case s.BODY_STATIC:this.linearVelocity.set(0,0,0),this.angularVelocity.set(0,0,0),this.controlPos&&(this.position.copy(this.newPosition),this.controlPos=!1),this.controlRot&&(this.orientation.copy(this.newOrientation),this.controlRot=!1);break;case s.BODY_DYNAMIC:this.controlPos&&(this.angularVelocity.set(0,0,0),this.linearVelocity.set(0,0,0),this.linearVelocity.x=(this.newPosition.x-this.position.x)/t,this.linearVelocity.y=(this.newPosition.y-this.position.y)/t,this.linearVelocity.z=(this.newPosition.z-this.position.z)/t,this.controlPos=!1),this.controlRot&&(this.angularVelocity.set(0,0,0),this.orientation.copy(this.newOrientation),this.controlRot=!1),this.position.addTime(this.linearVelocity,t),this.orientation.addTime(this.angularVelocity,t);break;default:s.Error("RigidBody","Invalid type.")}this.syncShapes()},rotateInertia:function(t,i,e){var s=t.elements,n=i.elements,o=s[0],r=s[3],a=s[6],h=s[1],l=s[4],u=s[7],c=s[2],p=s[5],d=s[8],m=n[0],f=n[3],y=n[6],x=n[1],v=n[4],g=n[7],b=n[2],N=n[5],C=n[8],P=o*m+h*f+c*y,A=o*x+h*v+c*g,S=o*b+h*N+c*C,k=r*m+l*f+p*y,I=r*x+l*v+p*g,z=r*b+l*N+p*C,_=a*m+u*f+d*y,M=a*x+u*v+d*g,E=a*b+u*N+d*C,w=e.elements;w[0]=P*o+A*h+S*c,w[1]=P*r+A*l+S*p,w[2]=P*a+A*u+S*d,w[3]=k*o+I*h+z*c,w[4]=k*r+I*l+z*p,w[5]=k*a+I*u+z*d,w[6]=_*o+M*h+E*c,w[7]=_*r+M*l+E*p,w[8]=_*a+M*u+E*d},syncShapes:function(){var t=this.orientation.s,i=this.orientation.x,e=this.orientation.y,s=this.orientation.z,n=2*i,o=2*e,r=2*s,a=i*n,h=e*o,l=s*r,u=i*o,c=e*r,p=i*r,d=t*n,m=t*o,f=t*r,y=this.rotation.elements;y[0]=1-h-l,y[1]=u-f,y[2]=p+m,y[3]=u+f,y[4]=1-a-l,y[5]=c-d,y[6]=p-m,y[7]=c+d,y[8]=1-a-h,this.rotateInertia(this.rotation,this.inverseLocalInertia,this.inverseInertia);for(var x=this.shapes;null!=x;x=x.next)x.position.mul(this.position,x.relativePosition,this.rotation),x.rotation.mul(this.rotation,x.relativeRotation),x.updateProxy()},applyImpulse:function(t,i){this.linearVelocity.addScale(i,this.inverseMass);var e=new s.Vec3;e.sub(t,this.position).cross(e,i).mulMat(this.inverseInertia,e),this.angularVelocity.addEqual(e)},rotationVectToQuad:function(t){var i=s.EulerToAxis(t.x*s.degtorad,t.y*s.degtorad,t.z*s.degtorad);return this.rotationAxisToQuad(i[0],i[1],i[2],i[3])},rotationAxisToQuad:function(t,i,e,n){var o=i*i+e*e+n*n;o>0&&(o=1/s.sqrt(o),i*=o,e*=o,n*=o);var r=s.sin(.5*t),a=s.cos(.5*t);return new s.Quat(a,r*i,r*e,r*n)},setPosition:function(t){this.newPosition.copy(t).multiplyScalar(s.INV_SCALE),this.controlPos=!0},setQuaternion:function(t){this.newOrientation.set(t.x,t.y,t.z,t.w),this.controlRot=!0},setRotation:function(t){this.newOrientation=this.rotationVectToQuad(t),this.controlRot=!0},resetPosition:function(t,i,e){this.linearVelocity.set(0,0,0),this.angularVelocity.set(0,0,0),this.position.set(t,i,e).multiplyScalar(s.INV_SCALE),this.awake()},resetQuaternion:function(t){this.angularVelocity.set(0,0,0),this.orientation=new s.Quat(t.w,t.x,t.y,t.z),this.awake()},resetRotation:function(t,i,e){this.angularVelocity.set(0,0,0),this.orientation=this.rotationVectToQuad(new s.Vec3(t,i,e)),this.awake()},getPosition:function(){return(new s.Vec3).scale(this.position,s.WORLD_SCALE)},getRotation:function(){return(new s.Euler).setFromRotationMatrix(this.rotation)},getQuaternion:function(){return(new s.Quaternion).setFromRotationMatrix(this.rotation)},getMatrix:function(){var t,i,e=this.matrix.elements;return this.sleeping?e[15]=1:(t=this.rotation.elements,e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=0,e[4]=t[1],e[5]=t[4],e[6]=t[7],e[7]=0,e[8]=t[2],e[9]=t[5],e[10]=t[8],e[11]=0,i=this.position,e[12]=i.x*s.WORLD_SCALE,e[13]=i.y*s.WORLD_SCALE,e[14]=i.z*s.WORLD_SCALE,e[15]=0),e}},s.Body=function(t){var i=t||{};i.world&&(void 0===i.type&&(i.type="box"),this.name=i.name||"",this.body=i.world.add(i))},s.Body.prototype={constructor:s.Body,setPosition:function(t){this.body.setPosition(t)},setQuaternion:function(t){this.body.setQuaternion(t)},setRotation:function(t){this.body.setRotation(t)},getPosition:function(){return this.body.getPosition()},getRotation:function(){return this.body.getRotation()},getQuaternion:function(){return this.body.getQuaternion()},getMatrix:function(){return this.body.getMatrix()},getSleep:function(){return this.body.sleeping},resetPosition:function(t,i,e){this.body.resetPosition(t,i,e)},resetRotation:function(t,i,e){this.body.resetRotation(t,i,e)},awake:function(){this.body.awake()},remove:function(){this.body.dispose()},checkContact:function(t){this.body.checkContact(t)}},s.Link=function(t){var i=t||{};i.world&&(void 0===i.type&&(i.type="jointHinge"),this.name=i.name||"",this.joint=i.world.add(i))},s.Link.prototype={constructor:s.Link,getPosition:function(){return this.joint.getPosition()},getMatrix:function(){return this.joint.getMatrix()},remove:function(){this.joint.dispose()},awake:function(){this.joint.awake()}},s.Dictionary=function(){this.data={},this.keys=[]},s.Dictionary.prototype={constructor:s.Dictionary,set:function(t){var i=t.id;this.get[i]||this.keys.push(i),this.data[i]=t},get:function(t){return this.data[t]},del:function(t){var i=this.keys,e=i.indexOf(t.id);e>-1&&(delete this.data[i[e]],i.splice(e,1))},reset:function(){for(var t,i=this.data,e=this.keys;e.length>0;)t=e.pop(),delete i[t]}},s.Performance=function(t){this.parent=t,this.infos=new e(13),this.f=[0,0,0],this.types=["None","BruteForce","Sweep & Prune","Bounding Volume Tree"],this.broadPhase=this.types[this.parent.broadPhase.types],this.version=s.REVISION,this.fps=0,this.broadPhaseTime=0,this.narrowPhaseTime=0,this.solvingTime=0,this.totalTime=0},s.Performance.prototype={upfps:function(){this.f[1]=Date.now(),this.f[1]-1e3>this.f[0]&&(this.f[0]=this.f[1],this.fps=this.f[2],this.f[2]=0),this.f[2]++},updatingTime:function(){return s.fix(this.totalTime-(this.broadPhaseTime+this.narrowPhaseTime+this.solvingTime))},show:function(){var t=["Oimo.js "+this.version+"<br>",this.broadPhase+"<br><br>","FPS: "+this.fps+" fps<br><br>","rigidbody "+this.parent.numRigidBodies+"<br>","contact &nbsp;&nbsp;"+this.parent.numContacts+"<br>","ct-point &nbsp;"+this.parent.numContactPoints+"<br>","paircheck "+this.parent.broadPhase.numPairChecks+"<br>","island &nbsp;&nbsp;&nbsp;"+this.parent.numIslands+"<br><br>","Time in milliseconde<br><br>","broad-phase &nbsp;"+s.fix(this.broadPhaseTime)+"<br>","narrow-phase "+s.fix(this.narrowPhaseTime)+"<br>","solving &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+s.fix(this.solvingTime)+"<br>","total &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+s.fix(this.totalTime)+"<br>","updating &nbsp;&nbsp;&nbsp;&nbsp;"+this.updatingTime()+"<br>"].join("\n");return t},toArray:function(){return this.infos[0]=this.parent.broadPhase.types,this.infos[1]=this.parent.numRigidBodies,this.infos[2]=this.parent.numContacts,this.infos[3]=this.parent.broadPhase.numPairChecks,this.infos[4]=this.parent.numContactPoints,this.infos[5]=this.parent.numIslands,this.infos[6]=this.broadPhaseTime,this.infos[7]=this.narrowPhaseTime,this.infos[8]=this.solvingTime,this.infos[9]=this.updatingTime(),this.infos[10]=this.totalTime,this.infos[11]=this.fps,this.infos}},s.Mat44=function(t,i,s,n,o,r,a,h,l,u,c,p,d,m,f,y){this.elements=new e(16);var x=this.elements;x[0]=void 0!==t?t:1,x[4]=i||0,x[8]=s||0,x[12]=n||0,x[1]=o||0,x[5]=void 0!==r?r:1,x[9]=a||0,x[13]=h||0,x[2]=l||0,x[6]=u||0,x[10]=void 0!==c?c:1,x[14]=p||0,x[3]=d||0,x[7]=m||0,x[11]=f||0,x[15]=void 0!==y?y:1},s.Mat44.prototype={constructor:s.Mat44,set:function(t,i,e,s,n,o,r,a,h,l,u,c,p,d,m,f){var y=this.elements;return y[0]=t,y[4]=i,y[8]=e,y[12]=s,y[1]=n,y[5]=o,y[9]=r,y[13]=a,y[2]=h,y[6]=l,y[10]=u,y[14]=c,y[3]=p,y[7]=d,y[11]=m,y[15]=f,this}},s.Mat33=function(t,i,s,n,o,r,a,h,l){this.elements=new e(9);this.elements;this.init(void 0!==t?t:1,i||0,s||0,n||0,void 0!==o?o:1,r||0,a||0,h||0,void 0!==l?l:1)},s.Mat33.prototype={constructor:s.Mat33,set:function(t,i,e,s,n,o,r,a,h){var l=this.elements;return l[0]=t,l[1]=i,l[2]=e,l[3]=s,l[4]=n,l[5]=o,l[6]=r,l[7]=a,l[8]=h,this},init:function(t,i,e,s,n,o,r,a,h){var l=this.elements;return l[0]=t,l[1]=i,l[2]=e,l[3]=s,l[4]=n,l[5]=o,l[6]=r,l[7]=a,l[8]=h,this},multiply:function(t){var i=this.elements;return i[0]*=t,i[1]*=t,i[2]*=t,i[3]*=t,i[4]*=t,i[5]*=t,i[6]*=t,i[7]*=t,i[8]*=t,this},add:function(t,i){var e=this.elements,s=t.elements,n=i.elements;return e[0]=s[0]+n[0],e[1]=s[1]+n[1],e[2]=s[2]+n[2],e[3]=s[3]+n[3],e[4]=s[4]+n[4],e[5]=s[5]+n[5],e[6]=s[6]+n[6],e[7]=s[7]+n[7],e[8]=s[8]+n[8],this},addEqual:function(t){var i=this.elements,e=t.elements;return i[0]+=e[0],i[1]+=e[1],i[2]+=e[2],i[3]+=e[3],i[4]+=e[4],i[5]+=e[5],i[6]+=e[6],i[7]+=e[7],i[8]+=e[8],this},sub:function(t,i){var e=this.elements,s=t.elements,n=i.elements;return e[0]=s[0]-n[0],e[1]=s[1]-n[1],e[2]=s[2]-n[2],e[3]=s[3]-n[3],e[4]=s[4]-n[4],e[5]=s[5]-n[5],e[6]=s[6]-n[6],e[7]=s[7]-n[7],e[8]=s[8]-n[8],this},subEqual:function(t){var i=this.elements,e=t.elements;return i[0]-=e[0],i[1]-=e[1],i[2]-=e[2],i[3]-=e[3],i[4]-=e[4],i[5]-=e[5],i[6]-=e[6],i[7]-=e[7],i[8]-=e[8],this},scale:function(t,i){var e=this.elements,s=t.elements;return e[0]=s[0]*i,e[1]=s[1]*i,e[2]=s[2]*i,e[3]=s[3]*i,e[4]=s[4]*i,e[5]=s[5]*i,e[6]=s[6]*i,e[7]=s[7]*i,e[8]=s[8]*i,this},scaleEqual:function(t){var i=this.elements;return i[0]*=t,i[1]*=t,i[2]*=t,i[3]*=t,i[4]*=t,i[5]*=t,i[6]*=t,i[7]*=t,i[8]*=t,this},mul:function(t,i){var e=this.elements,s=t.elements,n=i.elements,o=s[0],r=s[3],a=s[6],h=s[1],l=s[4],u=s[7],c=s[2],p=s[5],d=s[8],m=n[0],f=n[3],y=n[6],x=n[1],v=n[4],g=n[7],b=n[2],N=n[5],C=n[8];return e[0]=o*m+h*f+c*y,e[1]=o*x+h*v+c*g,e[2]=o*b+h*N+c*C,e[3]=r*m+l*f+p*y,e[4]=r*x+l*v+p*g,e[5]=r*b+l*N+p*C,e[6]=a*m+u*f+d*y,e[7]=a*x+u*v+d*g,e[8]=a*b+u*N+d*C,this},mulScale:function(t,i,e,s,n){var o=n||!1,r=this.elements,a=t.elements;return o?(r[0]=i*a[0],r[1]=i*a[1],r[2]=i*a[2],r[3]=e*a[3],r[4]=e*a[4],r[5]=e*a[5],r[6]=s*a[6],r[7]=s*a[7],r[8]=s*a[8]):(r[0]=a[0]*i,r[1]=a[1]*e,r[2]=a[2]*s,r[3]=a[3]*i,r[4]=a[4]*e,r[5]=a[5]*s,r[6]=a[6]*i,r[7]=a[7]*e,r[8]=a[8]*s),this},mulRotate:function(t,i,e,n,o,r){var a=r||!1,h=s.sin(i),l=s.cos(i),u=1-l,c=e*e*u+l,p=e*n*u-o*h,d=e*o*u+n*h,m=n*e*u+o*h,f=n*n*u+l,y=n*o*u-e*h,x=o*e*u-n*h,v=o*n*u+e*h,g=o*o*u+l,b=t.elements,N=b[0],C=b[3],P=b[6],A=b[1],S=b[4],k=b[7],I=b[2],z=b[5],_=b[8],M=this.elements;return a?(M[0]=c*N+p*C+d*P,M[1]=c*A+p*S+d*k,M[2]=c*I+p*z+d*_,M[3]=m*N+f*C+y*P,M[4]=m*A+f*S+y*k,M[5]=m*I+f*z+y*_,M[6]=x*N+v*C+g*P,M[7]=x*A+v*S+g*k,M[8]=x*I+v*z+g*_):(M[0]=N*c+A*m+I*x,M[1]=N*p+A*f+I*v,M[2]=N*d+A*y+I*g,M[3]=C*c+S*m+z*x,M[4]=C*p+S*f+z*v,M[5]=C*d+S*y+z*g,M[6]=P*c+k*m+_*x,M[7]=P*p+k*f+_*v,M[8]=P*d+k*y+_*g),this},transpose:function(t){var i=this.elements,e=t.elements;return i[0]=e[0],i[1]=e[3],i[2]=e[6],i[3]=e[1],i[4]=e[4],i[5]=e[7],i[6]=e[2],i[7]=e[5],i[8]=e[8],this},setQuat:function(t){var i=this.elements,e=2*t.x,s=2*t.y,n=2*t.z,o=t.x*e,r=t.y*s,a=t.z*n,h=t.x*s,l=t.y*n,u=t.x*n,c=t.s*e,p=t.s*s,d=t.s*n;return i[0]=1-r-a,i[1]=h-d,i[2]=u+p,i[3]=h+d,i[4]=1-o-a,i[5]=l-c,i[6]=u-p,i[7]=l+c,i[8]=1-o-r,this},invert:function(t){
var i=this.elements,e=t.elements,s=e[0],n=e[3],o=e[6],r=e[1],a=e[4],h=e[7],l=e[2],u=e[5],c=e[8],p=a*c-h*u,d=h*l-r*c,m=r*u-a*l,f=s*p+n*d+o*m;return 0!=f&&(f=1/f),i[0]=f*p,i[1]=f*d,i[2]=f*m,i[3]=f*(u*o-n*c),i[4]=f*(s*c-l*o),i[5]=f*(l*n-s*u),i[6]=f*(n*h-a*o),i[7]=f*(r*o-s*h),i[8]=f*(s*a-r*n),this},toEuler:function(){function t(t){return s.min(s.max(t,-1),1)}var i=this.elements,e=i[0],n=i[3],o=i[6],r=(i[1],i[4]),a=i[7],h=(i[2],i[5]),l=i[8],u=new s.Vec3;new s.Quat;return u.y=s.asin(t(o)),s.abs(o)<.99999?(u.x=s.atan2(-a,l),u.z=s.atan2(-n,e)):(u.x=s.atan2(h,r),u.z=0),u},toString:function(){var t=this.elements,i="Mat33|"+t[0].toFixed(4)+", "+t[1].toFixed(4)+", "+t[2].toFixed(4)+"|\n     |"+t[3].toFixed(4)+", "+t[4].toFixed(4)+", "+t[5].toFixed(4)+"|\n     |"+t[6].toFixed(4)+", "+t[7].toFixed(4)+", "+t[8].toFixed(4)+"|";return i},multiplyScalar:function(t){var i=this.elements;return i[0]*=t,i[3]*=t,i[6]*=t,i[1]*=t,i[4]*=t,i[7]*=t,i[2]*=t,i[5]*=t,i[8]*=t,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var i=t.elements;return this.set(i[0],i[3],i[6],i[1],i[4],i[7],i[2],i[5],i[8]),this},fromArray:function(t){return this.elements.set(t),this},toArray:function(){var t=this.elements;return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]]}},s.Quat=function(t,i,e,s){this.s=void 0!==t?t:1,this.x=i||0,this.y=e||0,this.z=s||0},s.Quat.prototype={constructor:s.Quat,set:function(t,i,e,s){return this.x=t,this.y=i,this.z=e,this.s=s,this},init:function(t,i,e,s){return this.s=void 0!==t?t:1,this.x=i||0,this.y=e||0,this.z=s||0,this},add:function(t,i){return this.s=t.s+i.s,this.x=t.x+i.x,this.y=t.y+i.y,this.z=t.z+i.z,this},addTime:function(t,i){var e=t.x,n=t.y,o=t.z,r=this.s,a=this.x,h=this.y,l=this.z;i*=.5;var u=(-e*a-n*h-o*l)*i,c=(e*r+n*l-o*h)*i,p=(-e*l+n*r+o*a)*i,d=(e*h-n*a+o*r)*i;r+=u,a+=c,h+=p,l+=d;var m=1/s.sqrt(r*r+a*a+h*h+l*l);return this.s=r*m,this.x=a*m,this.y=h*m,this.z=l*m,this},sub:function(t,i){return this.s=t.s-i.s,this.x=t.x-i.x,this.y=t.y-i.y,this.z=t.z-i.z,this},scale:function(t,i){return this.s=t.s*i,this.x=t.x*i,this.y=t.y*i,this.z=t.z*i,this},mul:function(t,i){var e=t.x,s=t.y,n=t.z,o=t.s,r=i.x,a=i.y,h=i.z,l=i.s;return this.x=e*l+o*r+s*h-n*a,this.y=s*l+o*a+n*r-e*h,this.z=n*l+o*h+e*a-s*r,this.s=o*l-e*r-s*a-n*h,this},arc:function(t,i){var e=t.x,n=t.y,o=t.z,r=i.x,a=i.y,h=i.z,l=e*r+n*a+o*h;if(-1==l)return r=n*e-o*o,a=-o*n-e*e,h=e*o+n*n,l=1/s.sqrt(r*r+a*a+h*h),this.s=0,this.x=r*l,this.y=a*l,this.z=h*l,this;var u=n*h-o*a,c=o*r-e*h,p=e*a-n*r;return this.s=s.sqrt(.5*(1+l)),l=.5/this.s,this.x=u*l,this.y=c*l,this.z=p*l,this},normalize:function(t){var i=s.sqrt(t.s*t.s+t.x*t.x+t.y*t.y+t.z*t.z);return i>0&&(i=1/i),this.s=t.s*i,this.x=t.x*i,this.y=t.y*i,this.z=t.z*i,this},invert:function(t){return this.s=t.s,this.x=-t.x,this.y=-t.y,this.z=-t.z,this},length:function(){return s.sqrt(this.s*this.s+this.x*this.x+this.y*this.y+this.z*this.z)},copy:function(t){return this.s=t.s,this.x=t.x,this.y=t.y,this.z=t.z,this},testDiff:function(t){return this.s!==t.s||this.x!==t.x||this.y!==t.y||this.z!==t.z?!0:!1},clone:function(t){return new s.Quat(this.s,this.x,this.y,this.z)},toString:function(){return"Quat["+this.s.toFixed(4)+", ("+this.x.toFixed(4)+", "+this.y.toFixed(4)+", "+this.z.toFixed(4)+")]"}},s.Quaternion=function(t,i,e,s){this.x=t||0,this.y=i||0,this.z=e||0,this.w=void 0!==s?s:1},s.Quaternion.prototype={constructor:s.Quaternion,setFromRotationMatrix:function(t){var i,e=t.elements,n=e[0],o=e[1],r=e[2],a=e[3],h=e[4],l=e[5],u=e[6],c=e[7],p=e[8],d=n+h+p;return d>0?(i=.5/s.sqrt(d+1),this.w=.25/i,this.x=(c-l)*i,this.y=(r-u)*i,this.z=(a-o)*i):n>h&&n>p?(i=2*s.sqrt(1+n-h-p),this.w=(c-l)/i,this.x=.25*i,this.y=(o+a)/i,this.z=(r+u)/i):h>p?(i=2*s.sqrt(1+h-n-p),this.w=(r-u)/i,this.x=(o+a)/i,this.y=.25*i,this.z=(l+c)/i):(i=2*s.sqrt(1+p-n-h),this.w=(a-o)/i,this.x=(r+u)/i,this.y=(l+c)/i,this.z=.25*i),this}},s.Vec3=function(t,i,e){this.x=t||0,this.y=i||0,this.z=e||0},s.Vec3.prototype={constructor:s.Vec3,init:function(t,i,e){return this.x=t||0,this.y=i||0,this.z=e||0,this},set:function(t,i,e){return this.x=t,this.y=i,this.z=e,this},add:function(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this.z=t.z+i.z,this},addEqual:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},addTime:function(t,i){return this.x+=t.x*i,this.y+=t.y*i,this.z+=t.z*i,this},sub:function(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this.z=t.z-i.z,this},subEqual:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},addScale:function(t,i){return this.x+=t.x*i,this.y+=t.y*i,this.z+=t.z*i,this},scale:function(t,i){return this.x=t.x*i,this.y=t.y*i,this.z=t.z*i,this},scaleEqual:function(t){return this.x*=t,this.y*=t,this.z*=t,this},cross:function(t,i){var e=t.x,s=t.y,n=t.z,o=i.x,r=i.y,a=i.z;return this.x=s*a-n*r,this.y=n*o-e*a,this.z=e*r-s*o,this},mul:function(t,i,e){var s=e.elements;return this.x=t.x+i.x*s[0]+i.y*s[1]+i.z*s[2],this.y=t.y+i.x*s[3]+i.y*s[4]+i.z*s[5],this.z=t.z+i.x*s[6]+i.y*s[7]+i.z*s[8],this},mulMat:function(t,i){var e=t.elements;return this.x=e[0]*i.x+e[1]*i.y+e[2]*i.z,this.y=e[3]*i.x+e[4]*i.y+e[5]*i.z,this.z=e[6]*i.x+e[7]*i.y+e[8]*i.z,this},normalize:function(t){var i=t.x,e=t.y,n=t.z,o=i*i+e*e+n*n;return o>0&&(o=1/s.sqrt(o),this.x=i*o,this.y=e*o,this.z=n*o),this},invert:function(t){return this.x=-t.x,this.y=-t.y,this.z=-t.z,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return s.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},applyQuaternion:function(t){var i=this.x,e=this.y,s=this.z,n=t.x,o=t.y,r=t.z,a=t.s,h=a*i+o*s-r*e,l=a*e+r*i-n*s,u=a*s+n*e-o*i,c=-n*i-o*e-r*s;return this.x=h*a+c*-n+l*-r-u*-o,this.y=l*a+c*-o+u*-n-h*-r,this.z=u*a+c*-r+h*-o-l*-n,this},testZero:function(){return 0!==this.x||0!==this.y||0!==this.z?!0:!1},testDiff:function(t){return t.x!==this.x||t.y!==this.y||t.z!==this.z},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},clone:function(){return new this.constructor(this.x,this.y,this.z)},toString:function(){return"Vec3["+this.x.toFixed(4)+", "+this.y.toFixed(4)+", "+this.z.toFixed(4)+"]"},multiplyScalar:function(t){return isFinite(t)?(this.x*=t,this.y*=t,this.z*=t):(this.x=0,this.y=0,this.z=0),this},divideScalar:function(t){return this.multiplyScalar(1/t)},norm:function(){return this.divideScalar(this.length())}},s.Euler=function(t,i,e,n){this._x=t||0,this._y=i||0,this._z=e||0,this._order=n||s.Euler.DefaultOrder},s.Euler.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],s.Euler.DefaultOrder="XYZ",s.clamp=function(t,i,e){return i>t?i:t>e?e:t},s.Euler.prototype={constructor:s.Euler,_x:0,_y:0,_z:0,_order:s.Euler.DefaultOrder,get x(){return this._x},set x(t){this._x=t,this.onChangeCallback()},get y(){return this._y},set y(t){this._y=t,this.onChangeCallback()},get z(){return this._z},set z(t){this._z=t,this.onChangeCallback()},get order(){return this._order},set order(t){this._order=t,this.onChangeCallback()},set:function(t,i,e,s){return this._x=t,this._y=i,this._z=e,this._order=s||this._order,this.onChangeCallback(),this},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this.onChangeCallback(),this},setFromRotationMatrix:function(t,i){var e=s.clamp,n=t.elements,o=n[0],r=n[1],a=n[2],h=n[3],l=n[4],u=n[5],c=n[6],p=n[7],d=n[8];return i=i||this._order,"XYZ"===i?(this._y=s.asin(e(a,-1,1)),s.abs(a)<.99999?(this._x=s.atan2(-u,d),this._z=s.atan2(-r,o)):(this._x=s.atan2(p,l),this._z=0)):"YXZ"===i?(this._x=s.asin(-e(u,-1,1)),s.abs(u)<.99999?(this._y=s.atan2(a,d),this._z=s.atan2(h,l)):(this._y=s.atan2(-c,o),this._z=0)):"ZXY"===i?(this._x=s.asin(e(p,-1,1)),s.abs(p)<.99999?(this._y=s.atan2(-c,d),this._z=s.atan2(-r,l)):(this._y=0,this._z=s.atan2(h,o))):"ZYX"===i?(this._y=s.asin(-e(c,-1,1)),s.abs(c)<.99999?(this._x=s.atan2(p,d),this._z=s.atan2(h,o)):(this._x=0,this._z=s.atan2(-r,l))):"YZX"===i?(this._z=s.asin(e(h,-1,1)),s.abs(h)<.99999?(this._x=s.atan2(-u,l),this._y=s.atan2(-c,o)):(this._x=0,this._y=s.atan2(a,d))):"XZY"===i?(this._z=s.asin(-e(r,-1,1)),s.abs(r)<.99999?(this._x=s.atan2(p,l),this._y=s.atan2(a,o)):(this._x=s.atan2(-u,d),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+i),this._order=i,this.onChangeCallback(),this},setFromQuaternion:function(t,i,e){var n=s.clamp,o=t.x*t.x,r=t.y*t.y,a=t.z*t.z,h=t.s*t.s;return i=i||this._order,"XYZ"===i?(this._x=s.atan2(2*(t.x*t.s-t.y*t.z),h-o-r+a),this._y=s.asin(n(2*(t.x*t.z+t.y*t.s),-1,1)),this._z=s.atan2(2*(t.z*t.s-t.x*t.y),h+o-r-a)):"YXZ"===i?(this._x=s.asin(n(2*(t.x*t.s-t.y*t.z),-1,1)),this._y=s.atan2(2*(t.x*t.z+t.y*t.s),h-o-r+a),this._z=s.atan2(2*(t.x*t.y+t.z*t.s),h-o+r-a)):"ZXY"===i?(this._x=s.asin(n(2*(t.x*t.s+t.y*t.z),-1,1)),this._y=s.atan2(2*(t.y*t.s-t.z*t.x),h-o-r+a),this._z=s.atan2(2*(t.z*t.s-t.x*t.y),h-o+r-a)):"ZYX"===i?(this._x=s.atan2(2*(t.x*t.s+t.z*t.y),h-o-r+a),this._y=s.asin(n(2*(t.y*t.s-t.x*t.z),-1,1)),this._z=s.atan2(2*(t.x*t.y+t.z*t.s),h+o-r-a)):"YZX"===i?(this._x=s.atan2(2*(t.x*t.s-t.z*t.y),h-o+r-a),this._y=s.atan2(2*(t.y*t.s-t.x*t.z),h+o-r-a),this._z=s.asin(n(2*(t.x*t.y+t.z*t.s),-1,1))):"XZY"===i?(this._x=s.atan2(2*(t.x*t.s+t.y*t.z),h-o+r-a),this._y=s.atan2(2*(t.x*t.z+t.y*t.s),h+o-r-a),this._z=s.asin(n(2*(t.z*t.s-t.x*t.y),-1,1))):console.warn("OIMO.Euler: .setFromQuaternion() given unsupported order: "+i),this._order=i,e!==!1&&this.onChangeCallback(),this},reorder:function(){var t=new s.Quat;return function(i){t.setFromEuler(this),this.setFromQuaternion(t,i)}}(),equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this.onChangeCallback(),this},toArray:function(){return[this._x,this._y,this._z,this._order]},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){},clone:function(){return new s.Euler(this._x,this._y,this._z,this._order)}},s.EulerToAxis=function(t,i,e){var n=s.cos(.5*i),o=s.sin(.5*i),r=s.cos(.5*e),a=s.sin(.5*e),h=s.cos(.5*t),l=s.sin(.5*t),u=n*r,c=o*a,p=u*h-c*l,d=u*l+c*h,m=o*r*h+n*a*l,f=n*a*h-o*r*l,y=2*s.acos(p),x=d*d+m*m+f*f;return.001>x?(d=1,m=f=0):(x=s.sqrt(x),d/=x,m/=x,f/=x),[y,d,m,f]},s.EulerToMatrix=function(t,i,e){var n=s.cos(i),o=s.sin(i),r=s.cos(e),a=s.sin(e),h=s.cos(t),l=s.sin(t),u=new s.Mat33,c=u.elements;return c[0]=n*r,c[1]=o*l-n*a*h,c[2]=n*a*l+o*h,c[3]=a,c[4]=r*h,c[5]=-r*l,c[6]=-o*r,c[7]=o*a*h+n*l,c[8]=-o*a*l+n*h,u},s.MatrixToEuler=function(t){var i,e,n,o=t.elements;return o[3]>.998?(e=s.atan2(o[2],o[8]),n=s.PI/2,i=0):o[3]<-.998?(e=s.atan2(o[2],o[8]),n=-s.PI/2,i=0):(e=s.atan2(-o[6],o[0]),i=s.atan2(-o[5],o[4]),n=s.asin(o[3])),[i,e,n]},s.unwrapDegrees=function(t){return t%=360,t>180&&(t-=360),-180>t&&(t+=360),t},s.unwrapRadian=function(t){return t%=s.TwoPI,t>s.PI&&(t-=s.TwoPI),t<-s.PI&&(t+=s.TwoPI),t},s.Distance3d=function(t,i){var e=i[0]-t[0],n=i[1]-t[1],o=i[2]-t[2];return s.sqrt(e*e+n*n+o*o)},s.Constraint=function(){this.parent=null,this.body1=null,this.body2=null,this.addedToIsland=!1},s.Constraint.prototype={constructor:s.Constraint,preSolve:function(t,i){s.Error("Constraint","Inheritance error.")},solve:function(){s.Error("Constraint","Inheritance error.")},postSolve:function(){s.Error("Constraint","Inheritance error.")}},s.Joint=function(t){s.Constraint.call(this),this.name="",this.type=s.JOINT_NULL,this.prev=null,this.next=null,this.body1=t.body1,this.body2=t.body2,this.localAnchorPoint1=(new s.Vec3).copy(t.localAnchorPoint1),this.localAnchorPoint2=(new s.Vec3).copy(t.localAnchorPoint2),this.relativeAnchorPoint1=new s.Vec3,this.relativeAnchorPoint2=new s.Vec3,this.anchorPoint1=new s.Vec3,this.anchorPoint2=new s.Vec3,this.allowCollision=t.allowCollision,this.b1Link=new s.JointLink(this),this.b2Link=new s.JointLink(this),this.matrix=new s.Mat44},s.Joint.prototype=Object.create(s.Constraint.prototype),s.Joint.prototype.constructor=s.Joint,s.Joint.prototype.updateAnchorPoints=function(){this.relativeAnchorPoint1.mulMat(this.body1.rotation,this.localAnchorPoint1),this.relativeAnchorPoint2.mulMat(this.body2.rotation,this.localAnchorPoint2),this.anchorPoint1.add(this.relativeAnchorPoint1,this.body1.position),this.anchorPoint2.add(this.relativeAnchorPoint2,this.body2.position)},s.Joint.prototype.attach=function(){this.b1Link.body=this.body2,this.b2Link.body=this.body1,null!=this.body1.jointLink?(this.b1Link.next=this.body1.jointLink).prev=this.b1Link:this.b1Link.next=null,this.body1.jointLink=this.b1Link,this.body1.numJoints++,null!=this.body2.jointLink?(this.b2Link.next=this.body2.jointLink).prev=this.b2Link:this.b2Link.next=null,this.body2.jointLink=this.b2Link,this.body2.numJoints++},s.Joint.prototype.detach=function(){var t=this.b1Link.prev,i=this.b1Link.next;null!=t&&(t.next=i),null!=i&&(i.prev=t),this.body1.jointLink==this.b1Link&&(this.body1.jointLink=i),this.b1Link.prev=null,this.b1Link.next=null,this.b1Link.body=null,this.body1.numJoints--,t=this.b2Link.prev,i=this.b2Link.next,null!=t&&(t.next=i),null!=i&&(i.prev=t),this.body2.jointLink==this.b2Link&&(this.body2.jointLink=i),this.b2Link.prev=null,this.b2Link.next=null,this.b2Link.body=null,this.body2.numJoints--,this.b1Link.body=null,this.b2Link.body=null},s.Joint.prototype.awake=function(){this.body1.awake(),this.body2.awake()},s.Joint.prototype.preSolve=function(t,i){},s.Joint.prototype.solve=function(){},s.Joint.prototype.postSolve=function(){},s.Joint.prototype.remove=function(){this.dispose()},s.Joint.prototype.dispose=function(){this.parent.removeJoint(this)},s.Joint.prototype.getPosition=function(){var t=(new s.Vec3).scale(this.anchorPoint1,s.WORLD_SCALE),i=(new s.Vec3).scale(this.anchorPoint2,s.WORLD_SCALE);return[t,i]},s.Joint.prototype.getMatrix=function(){var t=this.matrix.elements,i=this.anchorPoint1,e=this.anchorPoint2;return t[0]=i.x*s.WORLD_SCALE,t[1]=i.y*s.WORLD_SCALE,t[2]=i.z*s.WORLD_SCALE,t[3]=0,t[4]=e.x*s.WORLD_SCALE,t[5]=e.y*s.WORLD_SCALE,t[6]=e.z*s.WORLD_SCALE,t[7]=0,t},s.JointConfig=function(){this.body1=null,this.body2=null,this.localAnchorPoint1=new s.Vec3,this.localAnchorPoint2=new s.Vec3,this.localAxis1=new s.Vec3,this.localAxis2=new s.Vec3,this.allowCollision=!1},s.JointLink=function(t){this.prev=null,this.next=null,this.body=null,this.joint=t},s.LimitMotor=function(t,i){i=i||!1,this.axis=t,this.angle=0,this.lowerLimit=i?0:1,this.upperLimit=0,this.motorSpeed=0,this.maxMotorForce=0,this.frequency=0,this.dampingRatio=0},s.LimitMotor.prototype={constructor:s.LimitMotor,setLimit:function(t,i){this.lowerLimit=t,this.upperLimit=i},setMotor:function(t,i){this.motorSpeed=t,this.maxMotorForce=i},setSpring:function(t,i){this.frequency=t,this.dampingRatio=i}},s.BallAndSocketJoint=function(t){s.Joint.call(this,t),this.type=s.JOINT_BALL_AND_SOCKET,this.lc=new s.LinearConstraint(this)},s.BallAndSocketJoint.prototype=Object.create(s.Joint.prototype),s.BallAndSocketJoint.prototype.constructor=s.BallAndSocketJoint,s.BallAndSocketJoint.prototype.preSolve=function(t,i){this.updateAnchorPoints(),this.lc.preSolve(t,i)},s.BallAndSocketJoint.prototype.solve=function(){this.lc.solve()},s.BallAndSocketJoint.prototype.postSolve=function(){},s.DistanceJoint=function(t,i,e){s.Joint.call(this,t),this.type=s.JOINT_DISTANCE,this.normal=new s.Vec3,this.nr=new s.Vec3,this.limitMotor=new s.LimitMotor(this.normal,!0),this.limitMotor.lowerLimit=i,this.limitMotor.upperLimit=e,this.t=new s.TranslationalConstraint(this,this.limitMotor)},s.DistanceJoint.prototype=Object.create(s.Joint.prototype),s.DistanceJoint.prototype.constructor=s.DistanceJoint,s.DistanceJoint.prototype.preSolve=function(t,i){this.updateAnchorPoints(),this.nr.sub(this.anchorPoint2,this.anchorPoint1),this.normal.normalize(this.nr),this.t.preSolve(t,i)},s.DistanceJoint.prototype.solve=function(){this.t.solve()},s.DistanceJoint.prototype.postSolve=function(){},s.HingeJoint=function(t,i,e){s.Joint.call(this,t),this.type=s.JOINT_HINGE,this.localAxis1=t.localAxis1.clone().norm(),this.localAxis2=t.localAxis2.clone().norm(),this.localAngle1=new s.Vec3(this.localAxis1.y*this.localAxis1.x-this.localAxis1.z*this.localAxis1.z,-this.localAxis1.z*this.localAxis1.y-this.localAxis1.x*this.localAxis1.x,this.localAxis1.x*this.localAxis1.z+this.localAxis1.y*this.localAxis1.y).norm();var n=(new s.Mat33).setQuat((new s.Quat).arc(this.localAxis1,this.localAxis2));this.localAngle2=(new s.Vec3).mulMat(n,this.localAngle1),this.nor=new s.Vec3,this.tan=new s.Vec3,this.bin=new s.Vec3,this.ax1=new s.Vec3,this.ax2=new s.Vec3,this.an1=new s.Vec3,this.an2=new s.Vec3,this.limitMotor=new s.LimitMotor(this.nor,!1),this.limitMotor.lowerLimit=i,this.limitMotor.upperLimit=e,this.lc=new s.LinearConstraint(this),this.r3=new s.Rotational3Constraint(this,this.limitMotor,new s.LimitMotor(this.tan,!0),new s.LimitMotor(this.bin,!0))},s.HingeJoint.prototype=Object.create(s.Joint.prototype),s.HingeJoint.prototype.constructor=s.HingeJoint,s.HingeJoint.prototype.preSolve=function(t,i){var e,s,n,o;this.updateAnchorPoints(),this.ax1.mulMat(this.body1.rotation,this.localAxis1),this.ax2.mulMat(this.body2.rotation,this.localAxis2),this.an1.mulMat(this.body1.rotation,this.localAngle1),this.an2.mulMat(this.body2.rotation,this.localAngle2),this.nor.set(this.ax1.x*this.body2.inverseMass+this.ax2.x*this.body1.inverseMass,this.ax1.y*this.body2.inverseMass+this.ax2.y*this.body1.inverseMass,this.ax1.z*this.body2.inverseMass+this.ax2.z*this.body1.inverseMass).norm(),this.tan.set(this.nor.y*this.nor.x-this.nor.z*this.nor.z,-this.nor.z*this.nor.y-this.nor.x*this.nor.x,this.nor.x*this.nor.z+this.nor.y*this.nor.y).norm(),this.bin.set(this.nor.y*this.tan.z-this.nor.z*this.tan.y,this.nor.z*this.tan.x-this.nor.x*this.tan.z,this.nor.x*this.tan.y-this.nor.y*this.tan.x),o=this.acosClamp(this.an1.x*this.an2.x+this.an1.y*this.an2.y+this.an1.z*this.an2.z),this.nor.x*(this.an1.y*this.an2.z-this.an1.z*this.an2.y)+this.nor.y*(this.an1.z*this.an2.x-this.an1.x*this.an2.z)+this.nor.z*(this.an1.x*this.an2.y-this.an1.y*this.an2.x)<0?this.limitMotor.angle=-o:this.limitMotor.angle=o,e=this.ax1.y*this.ax2.z-this.ax1.z*this.ax2.y,s=this.ax1.z*this.ax2.x-this.ax1.x*this.ax2.z,n=this.ax1.x*this.ax2.y-this.ax1.y*this.ax2.x,this.r3.limitMotor2.angle=this.tan.x*e+this.tan.y*s+this.tan.z*n,this.r3.limitMotor3.angle=this.bin.x*e+this.bin.y*s+this.bin.z*n,this.r3.preSolve(t,i),this.lc.preSolve(t,i)},s.HingeJoint.prototype.solve=function(){this.r3.solve(),this.lc.solve()},s.HingeJoint.prototype.postSolve=function(){},s.HingeJoint.prototype.acosClamp=function(t){return t>1?0:-1>t?s.PI:s.acos(t)},s.PrismaticJoint=function(t,i,e){s.Joint.call(this,t),this.type=s.JOINT_PRISMATIC,this.localAxis1=(new s.Vec3).normalize(t.localAxis1),this.localAxis2=(new s.Vec3).normalize(t.localAxis2),this.localAxis1X=this.localAxis1.x,this.localAxis1Y=this.localAxis1.y,this.localAxis1Z=this.localAxis1.z,this.localAxis2X=this.localAxis2.x,this.localAxis2Y=this.localAxis2.y,this.localAxis2Z=this.localAxis2.z,this.nor=new s.Vec3,this.tan=new s.Vec3,this.bin=new s.Vec3,this.ac=new s.AngularConstraint(this,(new s.Quat).arc(this.localAxis1,this.localAxis2)),this.limitMotor=new s.LimitMotor(this.nor,!0),this.limitMotor.lowerLimit=i,this.limitMotor.upperLimit=e,this.t3=new s.Translational3Constraint(this,this.limitMotor,new s.LimitMotor(this.tan,!0),new s.LimitMotor(this.bin,!0))},s.PrismaticJoint.prototype=Object.create(s.Joint.prototype),s.PrismaticJoint.prototype.constructor=s.PrismaticJoint,s.PrismaticJoint.prototype.preSolve=function(t,i){var e,n;this.updateAnchorPoints(),e=this.body1.rotation.elements;var o=this.localAxis1X*e[0]+this.localAxis1Y*e[1]+this.localAxis1Z*e[2],r=this.localAxis1X*e[3]+this.localAxis1Y*e[4]+this.localAxis1Z*e[5],a=this.localAxis1X*e[6]+this.localAxis1Y*e[7]+this.localAxis1Z*e[8];e=this.body2.rotation.elements;var h=this.localAxis2X*e[0]+this.localAxis2Y*e[1]+this.localAxis2Z*e[2],l=this.localAxis2X*e[3]+this.localAxis2Y*e[4]+this.localAxis2Z*e[5],u=this.localAxis2X*e[6]+this.localAxis2Y*e[7]+this.localAxis2Z*e[8],c=o*this.body2.inverseMass+h*this.body1.inverseMass,p=r*this.body2.inverseMass+l*this.body1.inverseMass,d=a*this.body2.inverseMass+u*this.body1.inverseMass;n=s.sqrt(c*c+p*p+d*d),n>0&&(n=1/n),c*=n,p*=n,d*=n;var m=p*c-d*d,f=-d*p-c*c,y=c*d+p*p;n=1/s.sqrt(m*m+f*f+y*y),m*=n,f*=n,y*=n;var x=p*y-d*f,v=d*m-c*y,g=c*f-p*m;this.nor.init(c,p,d),this.tan.init(m,f,y),this.bin.init(x,v,g),this.ac.preSolve(t,i),this.t3.preSolve(t,i)},s.PrismaticJoint.prototype.solve=function(){this.ac.solve(),this.t3.solve()},s.PrismaticJoint.prototype.postSolve=function(){},s.SliderJoint=function(t,i,e){s.Joint.call(this,t),this.type=s.JOINT_SLIDER,this.localAxis1=(new s.Vec3).normalize(t.localAxis1),this.localAxis2=(new s.Vec3).normalize(t.localAxis2);var n;this.localAxis1X=this.localAxis1.x,this.localAxis1Y=this.localAxis1.y,this.localAxis1Z=this.localAxis1.z,this.localAngAxis1X=this.localAxis1Y*this.localAxis1X-this.localAxis1Z*this.localAxis1Z,this.localAngAxis1Y=-this.localAxis1Z*this.localAxis1Y-this.localAxis1X*this.localAxis1X,this.localAngAxis1Z=this.localAxis1X*this.localAxis1Z+this.localAxis1Y*this.localAxis1Y,n=1/s.sqrt(this.localAngAxis1X*this.localAngAxis1X+this.localAngAxis1Y*this.localAngAxis1Y+this.localAngAxis1Z*this.localAngAxis1Z),this.localAngAxis1X*=n,this.localAngAxis1Y*=n,this.localAngAxis1Z*=n,this.localAxis2X=this.localAxis2.x,this.localAxis2Y=this.localAxis2.y,this.localAxis2Z=this.localAxis2.z;var o=(new s.Mat33).setQuat((new s.Quat).arc(this.localAxis1,this.localAxis2)),r=o.elements;this.localAngAxis2X=this.localAngAxis1X*r[0]+this.localAngAxis1Y*r[1]+this.localAngAxis1Z*r[2],this.localAngAxis2Y=this.localAngAxis1X*r[3]+this.localAngAxis1Y*r[4]+this.localAngAxis1Z*r[5],this.localAngAxis2Z=this.localAngAxis1X*r[6]+this.localAngAxis1Y*r[7]+this.localAngAxis1Z*r[8],this.nor=new s.Vec3,this.tan=new s.Vec3,this.bin=new s.Vec3,this.rotationalLimitMotor=new s.LimitMotor(this.nor,!1),this.r3=new s.Rotational3Constraint(this,this.rotationalLimitMotor,new s.LimitMotor(this.tan,!0),new s.LimitMotor(this.bin,!0)),this.translationalLimitMotor=new s.LimitMotor(this.nor,!0),this.translationalLimitMotor.lowerLimit=i,this.translationalLimitMotor.upperLimit=e,this.t3=new s.Translational3Constraint(this,this.translationalLimitMotor,new s.LimitMotor(this.tan,!0),new s.LimitMotor(this.bin,!0))},s.SliderJoint.prototype=Object.create(s.Joint.prototype),s.SliderJoint.prototype.constructor=s.SliderJoint,s.SliderJoint.prototype.preSolve=function(t,i){var e,n,o,r;this.updateAnchorPoints(),e=this.body1.rotation.elements;var a=this.localAxis1X*e[0]+this.localAxis1Y*e[1]+this.localAxis1Z*e[2],h=this.localAxis1X*e[3]+this.localAxis1Y*e[4]+this.localAxis1Z*e[5],l=this.localAxis1X*e[6]+this.localAxis1Y*e[7]+this.localAxis1Z*e[8],u=this.localAngAxis1X*e[0]+this.localAngAxis1Y*e[1]+this.localAngAxis1Z*e[2],c=this.localAngAxis1X*e[3]+this.localAngAxis1Y*e[4]+this.localAngAxis1Z*e[5],p=this.localAngAxis1X*e[6]+this.localAngAxis1Y*e[7]+this.localAngAxis1Z*e[8];e=this.body2.rotation.elements;var d=this.localAxis2X*e[0]+this.localAxis2Y*e[1]+this.localAxis2Z*e[2],m=this.localAxis2X*e[3]+this.localAxis2Y*e[4]+this.localAxis2Z*e[5],f=this.localAxis2X*e[6]+this.localAxis2Y*e[7]+this.localAxis2Z*e[8],y=this.localAngAxis2X*e[0]+this.localAngAxis2Y*e[1]+this.localAngAxis2Z*e[2],x=this.localAngAxis2X*e[3]+this.localAngAxis2Y*e[4]+this.localAngAxis2Z*e[5],v=this.localAngAxis2X*e[6]+this.localAngAxis2Y*e[7]+this.localAngAxis2Z*e[8],g=a*this.body2.inverseMass+d*this.body1.inverseMass,b=h*this.body2.inverseMass+m*this.body1.inverseMass,N=l*this.body2.inverseMass+f*this.body1.inverseMass;n=s.sqrt(g*g+b*b+N*N),n>0&&(n=1/n),g*=n,b*=n,N*=n;var C=b*g-N*N,P=-N*b-g*g,A=g*N+b*b;n=1/s.sqrt(C*C+P*P+A*A),C*=n,P*=n,A*=n;var S=b*A-N*P,k=N*C-g*A,I=g*P-b*C;this.nor.init(g,b,N),this.tan.init(C,P,A),this.bin.init(S,k,I),0>g*(c*v-p*x)+b*(p*y-u*v)+N*(u*x-c*y)?this.rotationalLimitMotor.angle=-this.acosClamp(u*y+c*x+p*v):this.rotationalLimitMotor.angle=this.acosClamp(u*y+c*x+p*v),n=h*f-l*m,o=l*d-a*f,r=a*m-h*d,this.r3.limitMotor2.angle=C*n+P*o+A*r,this.r3.limitMotor3.angle=S*n+k*o+I*r,this.r3.preSolve(t,i),this.t3.preSolve(t,i)},s.SliderJoint.prototype.solve=function(){this.r3.solve(),this.t3.solve()},s.SliderJoint.prototype.postSolve=function(){},s.SliderJoint.prototype.acosClamp=function(t){return t>1?0:-1>t?s.PI:s.acos(t)},s.WheelJoint=function(t){s.Joint.call(this,t),this.type=s.JOINT_WHEEL,this.localAxis1=(new s.Vec3).normalize(t.localAxis1),this.localAxis2=(new s.Vec3).normalize(t.localAxis2);var i;this.localAxis1X=this.localAxis1.x,this.localAxis1Y=this.localAxis1.y,this.localAxis1Z=this.localAxis1.z,this.localAxis2X=this.localAxis2.x,this.localAxis2Y=this.localAxis2.y,this.localAxis2Z=this.localAxis2.z;var e=this.localAxis1X*this.localAxis2X+this.localAxis1Y*this.localAxis2Y+this.localAxis1Z*this.localAxis2Z;if(e>-1&&1>e)this.localAngAxis1X=this.localAxis2X-e*this.localAxis1X,this.localAngAxis1Y=this.localAxis2Y-e*this.localAxis1Y,this.localAngAxis1Z=this.localAxis2Z-e*this.localAxis1Z,this.localAngAxis2X=this.localAxis1X-e*this.localAxis2X,this.localAngAxis2Y=this.localAxis1Y-e*this.localAxis2Y,this.localAngAxis2Z=this.localAxis1Z-e*this.localAxis2Z,i=1/s.sqrt(this.localAngAxis1X*this.localAngAxis1X+this.localAngAxis1Y*this.localAngAxis1Y+this.localAngAxis1Z*this.localAngAxis1Z),this.localAngAxis1X*=i,this.localAngAxis1Y*=i,this.localAngAxis1Z*=i,i=1/s.sqrt(this.localAngAxis2X*this.localAngAxis2X+this.localAngAxis2Y*this.localAngAxis2Y+this.localAngAxis2Z*this.localAngAxis2Z),this.localAngAxis2X*=i,this.localAngAxis2Y*=i,this.localAngAxis2Z*=i;else{this.localAngAxis1X=this.localAxis1Y*this.localAxis1X-this.localAxis1Z*this.localAxis1Z,this.localAngAxis1Y=-this.localAxis1Z*this.localAxis1Y-this.localAxis1X*this.localAxis1X,this.localAngAxis1Z=this.localAxis1X*this.localAxis1Z+this.localAxis1Y*this.localAxis1Y,i=1/s.sqrt(this.localAngAxis1X*this.localAngAxis1X+this.localAngAxis1Y*this.localAngAxis1Y+this.localAngAxis1Z*this.localAngAxis1Z),this.localAngAxis1X*=i,this.localAngAxis1Y*=i,this.localAngAxis1Z*=i;var n=(new s.Mat33).setQuat((new s.Quat).arc(this.localAxis1,this.localAxis2)),o=n.elements;this.localAngAxis2X=this.localAngAxis1X*o[0]+this.localAngAxis1Y*o[1]+this.localAngAxis1Z*o[2],this.localAngAxis2Y=this.localAngAxis1X*o[3]+this.localAngAxis1Y*o[4]+this.localAngAxis1Z*o[5],this.localAngAxis2Z=this.localAngAxis1X*o[6]+this.localAngAxis1Y*o[7]+this.localAngAxis1Z*o[8]}this.nor=new s.Vec3,this.tan=new s.Vec3,this.bin=new s.Vec3,this.translationalLimitMotor=new s.LimitMotor(this.tan,!0),this.translationalLimitMotor.frequency=8,this.translationalLimitMotor.dampingRatio=1,this.rotationalLimitMotor1=new s.LimitMotor(this.tan,!1),this.rotationalLimitMotor2=new s.LimitMotor(this.bin,!1),this.t3=new s.Translational3Constraint(this,new s.LimitMotor(this.nor,!0),this.translationalLimitMotor,new s.LimitMotor(this.bin,!0)),this.t3.weight=1,this.r3=new s.Rotational3Constraint(this,new s.LimitMotor(this.nor,!0),this.rotationalLimitMotor1,this.rotationalLimitMotor2)},s.WheelJoint.prototype=Object.create(s.Joint.prototype),s.WheelJoint.prototype.constructor=s.WheelJoint,s.WheelJoint.prototype.preSolve=function(t,i){var e,n;this.updateAnchorPoints(),e=this.body1.rotation.elements;var o=this.localAxis1X*e[0]+this.localAxis1Y*e[1]+this.localAxis1Z*e[2],r=this.localAxis1X*e[3]+this.localAxis1Y*e[4]+this.localAxis1Z*e[5],a=this.localAxis1X*e[6]+this.localAxis1Y*e[7]+this.localAxis1Z*e[8],h=this.localAngAxis1X*e[0]+this.localAngAxis1Y*e[1]+this.localAngAxis1Z*e[2],l=this.localAngAxis1X*e[3]+this.localAngAxis1Y*e[4]+this.localAngAxis1Z*e[5],u=this.localAngAxis1X*e[6]+this.localAngAxis1Y*e[7]+this.localAngAxis1Z*e[8];e=this.body2.rotation.elements;var c=this.localAxis2X*e[0]+this.localAxis2Y*e[1]+this.localAxis2Z*e[2],p=this.localAxis2X*e[3]+this.localAxis2Y*e[4]+this.localAxis2Z*e[5],d=this.localAxis2X*e[6]+this.localAxis2Y*e[7]+this.localAxis2Z*e[8],m=this.localAngAxis2X*e[0]+this.localAngAxis2Y*e[1]+this.localAngAxis2Z*e[2],f=this.localAngAxis2X*e[3]+this.localAngAxis2Y*e[4]+this.localAngAxis2Z*e[5],y=this.localAngAxis2X*e[6]+this.localAngAxis2Y*e[7]+this.localAngAxis2Z*e[8];this.r3.limitMotor1.angle=o*c+r*p+a*d,0>o*(l*d-u*p)+r*(u*c-h*d)+a*(h*p-l*c)?this.rotationalLimitMotor1.angle=-this.acosClamp(h*c+l*p+u*d):this.rotationalLimitMotor1.angle=this.acosClamp(h*c+l*p+u*d),0>c*(f*a-y*r)+p*(y*o-m*a)+d*(m*r-f*o)?this.rotationalLimitMotor2.angle=this.acosClamp(m*o+f*r+y*a):this.rotationalLimitMotor2.angle=-this.acosClamp(m*o+f*r+y*a);var x=p*a-d*r,v=d*o-c*a,g=c*r-p*o;n=s.sqrt(x*x+v*v+g*g),n>0&&(n=1/n),x*=n,v*=n,g*=n;var b=v*d-g*p,N=g*c-x*d,C=x*p-v*c;n=s.sqrt(b*b+N*N+C*C),n>0&&(n=1/n),b*=n,N*=n,C*=n;var P=r*g-a*v,A=a*x-o*g,S=o*v-r*x;n=s.sqrt(P*P+A*A+S*S),n>0&&(n=1/n),P*=n,A*=n,S*=n,this.nor.init(x,v,g),this.tan.init(b,N,C),this.bin.init(P,A,S),this.r3.preSolve(t,i),this.t3.preSolve(t,i)},s.WheelJoint.prototype.solve=function(){this.r3.solve(),this.t3.solve()},s.WheelJoint.prototype.postSolve=function(){},s.WheelJoint.prototype.acosClamp=function(t){return t>1?0:-1>t?s.PI:s.acos(t)},s.AngularConstraint=function(t,i){this.joint=t,this.targetOrientation=(new s.Quat).invert(i),this.relativeOrientation=new s.Quat,this.ii1=null,this.ii2=null,this.dd=null,this.vel=new s.Vec3,this.imp=new s.Vec3,this.rn0=new s.Vec3,this.rn1=new s.Vec3,this.rn2=new s.Vec3,this.b1=t.body1,this.b2=t.body2,this.a1=this.b1.angularVelocity,this.a2=this.b2.angularVelocity,this.i1=this.b1.inverseInertia,this.i2=this.b2.inverseInertia},s.AngularConstraint.prototype={constructor:s.AngularConstraint,preSolve:function(t,i){var e,n,o;this.ii1=this.i1.clone(),this.ii2=this.i2.clone(),o=(new s.Mat33).add(this.ii1,this.ii2).elements,e=1/(o[0]*(o[4]*o[8]-o[7]*o[5])+o[3]*(o[7]*o[2]-o[1]*o[8])+o[6]*(o[1]*o[5]-o[4]*o[2])),this.dd=new s.Mat33(o[4]*o[8]-o[5]*o[7],o[2]*o[7]-o[1]*o[8],o[1]*o[5]-o[2]*o[4],o[5]*o[6]-o[3]*o[8],o[0]*o[8]-o[2]*o[6],o[2]*o[3]-o[0]*o[5],o[3]*o[7]-o[4]*o[6],o[1]*o[6]-o[0]*o[7],o[0]*o[4]-o[1]*o[3]).multiply(e),this.relativeOrientation.invert(this.b1.orientation),this.relativeOrientation.mul(this.targetOrientation,this.relativeOrientation),this.relativeOrientation.mul(this.b2.orientation,this.relativeOrientation),e=2*this.relativeOrientation.s,this.vel.scale(this.relativeOrientation,e),n=this.vel.length(),n>.02?(n=(.02-n)/n*i*.05,this.vel.scaleEqual(n)):this.vel.init(),this.rn1.mulMat(this.ii1,this.imp),this.rn2.mulMat(this.ii2,this.imp),this.a1.addEqual(this.rn1),this.a2.subEqual(this.rn2)},solve:function(){var t=this.a2.clone().subEqual(this.a1).subEqual(this.vel);this.rn0.mulMat(this.dd,t),this.rn1.mulMat(this.ii1,this.rn0),this.rn2.mulMat(this.ii2,this.rn0),this.imp.addEqual(this.rn0),this.a1.addEqual(this.rn1),this.a2.subEqual(this.rn2)}},s.LinearConstraint=function(t){this.m1=NaN,this.m2=NaN,this.ii1=null,this.ii2=null,this.dd=null,this.r1x=NaN,this.r1y=NaN,this.r1z=NaN,this.r2x=NaN,this.r2y=NaN,this.r2z=NaN,this.ax1x=NaN,this.ax1y=NaN,this.ax1z=NaN,this.ay1x=NaN,this.ay1y=NaN,this.ay1z=NaN,this.az1x=NaN,this.az1y=NaN,this.az1z=NaN,this.ax2x=NaN,this.ax2y=NaN,this.ax2z=NaN,this.ay2x=NaN,this.ay2y=NaN,this.ay2z=NaN,this.az2x=NaN,this.az2y=NaN,this.az2z=NaN,this.vel=NaN,this.velx=NaN,this.vely=NaN,this.velz=NaN,this.joint=t,this.r1=t.relativeAnchorPoint1,this.r2=t.relativeAnchorPoint2,this.p1=t.anchorPoint1,this.p2=t.anchorPoint2,this.b1=t.body1,this.b2=t.body2,this.l1=this.b1.linearVelocity,this.l2=this.b2.linearVelocity,this.a1=this.b1.angularVelocity,this.a2=this.b2.angularVelocity,this.i1=this.b1.inverseInertia,this.i2=this.b2.inverseInertia,this.impx=0,this.impy=0,this.impz=0},s.LinearConstraint.prototype={constructor:s.LinearConstraint,preSolve:function(t,i){this.r1x=this.r1.x,this.r1y=this.r1.y,this.r1z=this.r1.z,this.r2x=this.r2.x,this.r2y=this.r2.y,this.r2z=this.r2.z,this.m1=this.b1.inverseMass,this.m2=this.b2.inverseMass,
this.ii1=this.i1.clone(),this.ii2=this.i2.clone();var e=this.ii1.elements,n=this.ii2.elements;this.ax1x=this.r1z*e[1]+-this.r1y*e[2],this.ax1y=this.r1z*e[4]+-this.r1y*e[5],this.ax1z=this.r1z*e[7]+-this.r1y*e[8],this.ay1x=-this.r1z*e[0]+this.r1x*e[2],this.ay1y=-this.r1z*e[3]+this.r1x*e[5],this.ay1z=-this.r1z*e[6]+this.r1x*e[8],this.az1x=this.r1y*e[0]+-this.r1x*e[1],this.az1y=this.r1y*e[3]+-this.r1x*e[4],this.az1z=this.r1y*e[6]+-this.r1x*e[7],this.ax2x=this.r2z*n[1]+-this.r2y*n[2],this.ax2y=this.r2z*n[4]+-this.r2y*n[5],this.ax2z=this.r2z*n[7]+-this.r2y*n[8],this.ay2x=-this.r2z*n[0]+this.r2x*n[2],this.ay2y=-this.r2z*n[3]+this.r2x*n[5],this.ay2z=-this.r2z*n[6]+this.r2x*n[8],this.az2x=this.r2y*n[0]+-this.r2x*n[1],this.az2y=this.r2y*n[3]+-this.r2x*n[4],this.az2z=this.r2y*n[6]+-this.r2x*n[7];var o=this.m1+this.m2,r=new s.Mat33(o,0,0,0,o,0,0,0,o),a=r.elements;a[0]+=e[4]*this.r1z*this.r1z-(e[7]+e[5])*this.r1y*this.r1z+e[8]*this.r1y*this.r1y,a[1]+=(e[6]*this.r1y+e[5]*this.r1x)*this.r1z-e[3]*this.r1z*this.r1z-e[8]*this.r1x*this.r1y,a[2]+=(e[3]*this.r1y-e[4]*this.r1x)*this.r1z-e[6]*this.r1y*this.r1y+e[7]*this.r1x*this.r1y,a[3]+=(e[2]*this.r1y+e[7]*this.r1x)*this.r1z-e[1]*this.r1z*this.r1z-e[8]*this.r1x*this.r1y,a[4]+=e[0]*this.r1z*this.r1z-(e[6]+e[2])*this.r1x*this.r1z+e[8]*this.r1x*this.r1x,a[5]+=(e[1]*this.r1x-e[0]*this.r1y)*this.r1z-e[7]*this.r1x*this.r1x+e[6]*this.r1x*this.r1y,a[6]+=(e[1]*this.r1y-e[4]*this.r1x)*this.r1z-e[2]*this.r1y*this.r1y+e[5]*this.r1x*this.r1y,a[7]+=(e[3]*this.r1x-e[0]*this.r1y)*this.r1z-e[5]*this.r1x*this.r1x+e[2]*this.r1x*this.r1y,a[8]+=e[0]*this.r1y*this.r1y-(e[3]+e[1])*this.r1x*this.r1y+e[4]*this.r1x*this.r1x,a[0]+=n[4]*this.r2z*this.r2z-(n[7]+n[5])*this.r2y*this.r2z+n[8]*this.r2y*this.r2y,a[1]+=(n[6]*this.r2y+n[5]*this.r2x)*this.r2z-n[3]*this.r2z*this.r2z-n[8]*this.r2x*this.r2y,a[2]+=(n[3]*this.r2y-n[4]*this.r2x)*this.r2z-n[6]*this.r2y*this.r2y+n[7]*this.r2x*this.r2y,a[3]+=(n[2]*this.r2y+n[7]*this.r2x)*this.r2z-n[1]*this.r2z*this.r2z-n[8]*this.r2x*this.r2y,a[4]+=n[0]*this.r2z*this.r2z-(n[6]+n[2])*this.r2x*this.r2z+n[8]*this.r2x*this.r2x,a[5]+=(n[1]*this.r2x-n[0]*this.r2y)*this.r2z-n[7]*this.r2x*this.r2x+n[6]*this.r2x*this.r2y,a[6]+=(n[1]*this.r2y-n[4]*this.r2x)*this.r2z-n[2]*this.r2y*this.r2y+n[5]*this.r2x*this.r2y,a[7]+=(n[3]*this.r2x-n[0]*this.r2y)*this.r2z-n[5]*this.r2x*this.r2x+n[2]*this.r2x*this.r2y,a[8]+=n[0]*this.r2y*this.r2y-(n[3]+n[1])*this.r2x*this.r2y+n[4]*this.r2x*this.r2x;var h=1/(a[0]*(a[4]*a[8]-a[7]*a[5])+a[3]*(a[7]*a[2]-a[1]*a[8])+a[6]*(a[1]*a[5]-a[4]*a[2]));this.dd=new s.Mat33(a[4]*a[8]-a[5]*a[7],a[2]*a[7]-a[1]*a[8],a[1]*a[5]-a[2]*a[4],a[5]*a[6]-a[3]*a[8],a[0]*a[8]-a[2]*a[6],a[2]*a[3]-a[0]*a[5],a[3]*a[7]-a[4]*a[6],a[1]*a[6]-a[0]*a[7],a[0]*a[4]-a[1]*a[3]).multiply(h),this.velx=this.p2.x-this.p1.x,this.vely=this.p2.y-this.p1.y,this.velz=this.p2.z-this.p1.z;var l=s.sqrt(this.velx*this.velx+this.vely*this.vely+this.velz*this.velz);l>.005?(l=(.005-l)/l*i*.05,this.velx*=l,this.vely*=l,this.velz*=l):(this.velx=0,this.vely=0,this.velz=0),this.impx*=.95,this.impy*=.95,this.impz*=.95,this.l1.x+=this.impx*this.m1,this.l1.y+=this.impy*this.m1,this.l1.z+=this.impz*this.m1,this.a1.x+=this.impx*this.ax1x+this.impy*this.ay1x+this.impz*this.az1x,this.a1.y+=this.impx*this.ax1y+this.impy*this.ay1y+this.impz*this.az1y,this.a1.z+=this.impx*this.ax1z+this.impy*this.ay1z+this.impz*this.az1z,this.l2.x-=this.impx*this.m2,this.l2.y-=this.impy*this.m2,this.l2.z-=this.impz*this.m2,this.a2.x-=this.impx*this.ax2x+this.impy*this.ay2x+this.impz*this.az2x,this.a2.y-=this.impx*this.ax2y+this.impy*this.ay2y+this.impz*this.az2y,this.a2.z-=this.impx*this.ax2z+this.impy*this.ay2z+this.impz*this.az2z},solve:function(){var t=this.dd.elements,i=this.l2.x-this.l1.x+this.a2.y*this.r2z-this.a2.z*this.r2y-this.a1.y*this.r1z+this.a1.z*this.r1y-this.velx,e=this.l2.y-this.l1.y+this.a2.z*this.r2x-this.a2.x*this.r2z-this.a1.z*this.r1x+this.a1.x*this.r1z-this.vely,s=this.l2.z-this.l1.z+this.a2.x*this.r2y-this.a2.y*this.r2x-this.a1.x*this.r1y+this.a1.y*this.r1x-this.velz,n=i*t[0]+e*t[1]+s*t[2],o=i*t[3]+e*t[4]+s*t[5],r=i*t[6]+e*t[7]+s*t[8];this.impx+=n,this.impy+=o,this.impz+=r,this.l1.x+=n*this.m1,this.l1.y+=o*this.m1,this.l1.z+=r*this.m1,this.a1.x+=n*this.ax1x+o*this.ay1x+r*this.az1x,this.a1.y+=n*this.ax1y+o*this.ay1y+r*this.az1y,this.a1.z+=n*this.ax1z+o*this.ay1z+r*this.az1z,this.l2.x-=n*this.m2,this.l2.y-=o*this.m2,this.l2.z-=r*this.m2,this.a2.x-=n*this.ax2x+o*this.ay2x+r*this.az2x,this.a2.y-=n*this.ax2y+o*this.ay2y+r*this.az2y,this.a2.z-=n*this.ax2z+o*this.ay2z+r*this.az2z}},s.Rotational3Constraint=function(t,i,e,s){this.cfm1=NaN,this.cfm2=NaN,this.cfm3=NaN,this.i1e00=NaN,this.i1e01=NaN,this.i1e02=NaN,this.i1e10=NaN,this.i1e11=NaN,this.i1e12=NaN,this.i1e20=NaN,this.i1e21=NaN,this.i1e22=NaN,this.i2e00=NaN,this.i2e01=NaN,this.i2e02=NaN,this.i2e10=NaN,this.i2e11=NaN,this.i2e12=NaN,this.i2e20=NaN,this.i2e21=NaN,this.i2e22=NaN,this.ax1=NaN,this.ay1=NaN,this.az1=NaN,this.ax2=NaN,this.ay2=NaN,this.az2=NaN,this.ax3=NaN,this.ay3=NaN,this.az3=NaN,this.a1x1=NaN,this.a1y1=NaN,this.a1z1=NaN,this.a2x1=NaN,this.a2y1=NaN,this.a2z1=NaN,this.a1x2=NaN,this.a1y2=NaN,this.a1z2=NaN,this.a2x2=NaN,this.a2y2=NaN,this.a2z2=NaN,this.a1x3=NaN,this.a1y3=NaN,this.a1z3=NaN,this.a2x3=NaN,this.a2y3=NaN,this.a2z3=NaN,this.lowerLimit1=NaN,this.upperLimit1=NaN,this.limitVelocity1=NaN,this.limitState1=0,this.enableMotor1=!1,this.motorSpeed1=NaN,this.maxMotorForce1=NaN,this.maxMotorImpulse1=NaN,this.lowerLimit2=NaN,this.upperLimit2=NaN,this.limitVelocity2=NaN,this.limitState2=0,this.enableMotor2=!1,this.motorSpeed2=NaN,this.maxMotorForce2=NaN,this.maxMotorImpulse2=NaN,this.lowerLimit3=NaN,this.upperLimit3=NaN,this.limitVelocity3=NaN,this.limitState3=0,this.enableMotor3=!1,this.motorSpeed3=NaN,this.maxMotorForce3=NaN,this.maxMotorImpulse3=NaN,this.k00=NaN,this.k01=NaN,this.k02=NaN,this.k10=NaN,this.k11=NaN,this.k12=NaN,this.k20=NaN,this.k21=NaN,this.k22=NaN,this.kv00=NaN,this.kv11=NaN,this.kv22=NaN,this.dv00=NaN,this.dv11=NaN,this.dv22=NaN,this.d00=NaN,this.d01=NaN,this.d02=NaN,this.d10=NaN,this.d11=NaN,this.d12=NaN,this.d20=NaN,this.d21=NaN,this.d22=NaN,this.limitMotor1=i,this.limitMotor2=e,this.limitMotor3=s,this.b1=t.body1,this.b2=t.body2,this.a1=this.b1.angularVelocity,this.a2=this.b2.angularVelocity,this.i1=this.b1.inverseInertia,this.i2=this.b2.inverseInertia,this.limitImpulse1=0,this.motorImpulse1=0,this.limitImpulse2=0,this.motorImpulse2=0,this.limitImpulse3=0,this.motorImpulse3=0},s.Rotational3Constraint.prototype={constructor:s.Rotational3Constraint,preSolve:function(t,i){this.ax1=this.limitMotor1.axis.x,this.ay1=this.limitMotor1.axis.y,this.az1=this.limitMotor1.axis.z,this.ax2=this.limitMotor2.axis.x,this.ay2=this.limitMotor2.axis.y,this.az2=this.limitMotor2.axis.z,this.ax3=this.limitMotor3.axis.x,this.ay3=this.limitMotor3.axis.y,this.az3=this.limitMotor3.axis.z,this.lowerLimit1=this.limitMotor1.lowerLimit,this.upperLimit1=this.limitMotor1.upperLimit,this.motorSpeed1=this.limitMotor1.motorSpeed,this.maxMotorForce1=this.limitMotor1.maxMotorForce,this.enableMotor1=this.maxMotorForce1>0,this.lowerLimit2=this.limitMotor2.lowerLimit,this.upperLimit2=this.limitMotor2.upperLimit,this.motorSpeed2=this.limitMotor2.motorSpeed,this.maxMotorForce2=this.limitMotor2.maxMotorForce,this.enableMotor2=this.maxMotorForce2>0,this.lowerLimit3=this.limitMotor3.lowerLimit,this.upperLimit3=this.limitMotor3.upperLimit,this.motorSpeed3=this.limitMotor3.motorSpeed,this.maxMotorForce3=this.limitMotor3.maxMotorForce,this.enableMotor3=this.maxMotorForce3>0;var e=this.i1.elements,s=this.i2.elements;this.i1e00=e[0],this.i1e01=e[1],this.i1e02=e[2],this.i1e10=e[3],this.i1e11=e[4],this.i1e12=e[5],this.i1e20=e[6],this.i1e21=e[7],this.i1e22=e[8],this.i2e00=s[0],this.i2e01=s[1],this.i2e02=s[2],this.i2e10=s[3],this.i2e11=s[4],this.i2e12=s[5],this.i2e20=s[6],this.i2e21=s[7],this.i2e22=s[8];var n=this.limitMotor1.frequency,o=this.limitMotor2.frequency,r=this.limitMotor3.frequency,a=n>0,h=o>0,l=r>0,u=this.lowerLimit1<=this.upperLimit1,c=this.lowerLimit2<=this.upperLimit2,p=this.lowerLimit3<=this.upperLimit3,d=this.limitMotor1.angle;u?(this.lowerLimit1==this.upperLimit1?(0!=this.limitState1&&(this.limitState1=0,this.limitImpulse1=0),this.limitVelocity1=this.lowerLimit1-d):d<this.lowerLimit1?(-1!=this.limitState1&&(this.limitState1=-1,this.limitImpulse1=0),this.limitVelocity1=this.lowerLimit1-d):d>this.upperLimit1?(1!=this.limitState1&&(this.limitState1=1,this.limitImpulse1=0),this.limitVelocity1=this.upperLimit1-d):(this.limitState1=2,this.limitImpulse1=0,this.limitVelocity1=0),a||(this.limitVelocity1>.02?this.limitVelocity1-=.02:this.limitVelocity1<-.02?this.limitVelocity1+=.02:this.limitVelocity1=0)):(this.limitState1=2,this.limitImpulse1=0);var m=this.limitMotor2.angle;c?(this.lowerLimit2==this.upperLimit2?(0!=this.limitState2&&(this.limitState2=0,this.limitImpulse2=0),this.limitVelocity2=this.lowerLimit2-m):m<this.lowerLimit2?(-1!=this.limitState2&&(this.limitState2=-1,this.limitImpulse2=0),this.limitVelocity2=this.lowerLimit2-m):m>this.upperLimit2?(1!=this.limitState2&&(this.limitState2=1,this.limitImpulse2=0),this.limitVelocity2=this.upperLimit2-m):(this.limitState2=2,this.limitImpulse2=0,this.limitVelocity2=0),h||(this.limitVelocity2>.02?this.limitVelocity2-=.02:this.limitVelocity2<-.02?this.limitVelocity2+=.02:this.limitVelocity2=0)):(this.limitState2=2,this.limitImpulse2=0);var f=this.limitMotor3.angle;if(p?(this.lowerLimit3==this.upperLimit3?(0!=this.limitState3&&(this.limitState3=0,this.limitImpulse3=0),this.limitVelocity3=this.lowerLimit3-f):f<this.lowerLimit3?(-1!=this.limitState3&&(this.limitState3=-1,this.limitImpulse3=0),this.limitVelocity3=this.lowerLimit3-f):f>this.upperLimit3?(1!=this.limitState3&&(this.limitState3=1,this.limitImpulse3=0),this.limitVelocity3=this.upperLimit3-f):(this.limitState3=2,this.limitImpulse3=0,this.limitVelocity3=0),l||(this.limitVelocity3>.02?this.limitVelocity3-=.02:this.limitVelocity3<-.02?this.limitVelocity3+=.02:this.limitVelocity3=0)):(this.limitState3=2,this.limitImpulse3=0),this.enableMotor1&&(0!=this.limitState1||a)?this.maxMotorImpulse1=this.maxMotorForce1*t:(this.motorImpulse1=0,this.maxMotorImpulse1=0),this.enableMotor2&&(0!=this.limitState2||h)?this.maxMotorImpulse2=this.maxMotorForce2*t:(this.motorImpulse2=0,this.maxMotorImpulse2=0),this.enableMotor3&&(0!=this.limitState3||l)?this.maxMotorImpulse3=this.maxMotorForce3*t:(this.motorImpulse3=0,this.maxMotorImpulse3=0),this.a1x1=this.ax1*this.i1e00+this.ay1*this.i1e01+this.az1*this.i1e02,this.a1y1=this.ax1*this.i1e10+this.ay1*this.i1e11+this.az1*this.i1e12,this.a1z1=this.ax1*this.i1e20+this.ay1*this.i1e21+this.az1*this.i1e22,this.a2x1=this.ax1*this.i2e00+this.ay1*this.i2e01+this.az1*this.i2e02,this.a2y1=this.ax1*this.i2e10+this.ay1*this.i2e11+this.az1*this.i2e12,this.a2z1=this.ax1*this.i2e20+this.ay1*this.i2e21+this.az1*this.i2e22,this.a1x2=this.ax2*this.i1e00+this.ay2*this.i1e01+this.az2*this.i1e02,this.a1y2=this.ax2*this.i1e10+this.ay2*this.i1e11+this.az2*this.i1e12,this.a1z2=this.ax2*this.i1e20+this.ay2*this.i1e21+this.az2*this.i1e22,this.a2x2=this.ax2*this.i2e00+this.ay2*this.i2e01+this.az2*this.i2e02,this.a2y2=this.ax2*this.i2e10+this.ay2*this.i2e11+this.az2*this.i2e12,this.a2z2=this.ax2*this.i2e20+this.ay2*this.i2e21+this.az2*this.i2e22,this.a1x3=this.ax3*this.i1e00+this.ay3*this.i1e01+this.az3*this.i1e02,this.a1y3=this.ax3*this.i1e10+this.ay3*this.i1e11+this.az3*this.i1e12,this.a1z3=this.ax3*this.i1e20+this.ay3*this.i1e21+this.az3*this.i1e22,this.a2x3=this.ax3*this.i2e00+this.ay3*this.i2e01+this.az3*this.i2e02,this.a2y3=this.ax3*this.i2e10+this.ay3*this.i2e11+this.az3*this.i2e12,this.a2z3=this.ax3*this.i2e20+this.ay3*this.i2e21+this.az3*this.i2e22,this.k00=this.ax1*(this.a1x1+this.a2x1)+this.ay1*(this.a1y1+this.a2y1)+this.az1*(this.a1z1+this.a2z1),this.k01=this.ax1*(this.a1x2+this.a2x2)+this.ay1*(this.a1y2+this.a2y2)+this.az1*(this.a1z2+this.a2z2),this.k02=this.ax1*(this.a1x3+this.a2x3)+this.ay1*(this.a1y3+this.a2y3)+this.az1*(this.a1z3+this.a2z3),this.k10=this.ax2*(this.a1x1+this.a2x1)+this.ay2*(this.a1y1+this.a2y1)+this.az2*(this.a1z1+this.a2z1),this.k11=this.ax2*(this.a1x2+this.a2x2)+this.ay2*(this.a1y2+this.a2y2)+this.az2*(this.a1z2+this.a2z2),this.k12=this.ax2*(this.a1x3+this.a2x3)+this.ay2*(this.a1y3+this.a2y3)+this.az2*(this.a1z3+this.a2z3),this.k20=this.ax3*(this.a1x1+this.a2x1)+this.ay3*(this.a1y1+this.a2y1)+this.az3*(this.a1z1+this.a2z1),this.k21=this.ax3*(this.a1x2+this.a2x2)+this.ay3*(this.a1y2+this.a2y2)+this.az3*(this.a1z2+this.a2z2),this.k22=this.ax3*(this.a1x3+this.a2x3)+this.ay3*(this.a1y3+this.a2y3)+this.az3*(this.a1z3+this.a2z3),this.kv00=this.k00,this.kv11=this.k11,this.kv22=this.k22,this.dv00=1/this.kv00,this.dv11=1/this.kv11,this.dv22=1/this.kv22,a&&2!=this.limitState1){var y=6.2831853*n,x=y*y*t,v=i/(x+2*this.limitMotor1.dampingRatio*y);this.cfm1=this.kv00*v,this.limitVelocity1*=x*v}else this.cfm1=0,this.limitVelocity1*=.05*i;h&&2!=this.limitState2?(y=6.2831853*o,x=y*y*t,v=i/(x+2*this.limitMotor2.dampingRatio*y),this.cfm2=this.kv11*v,this.limitVelocity2*=x*v):(this.cfm2=0,this.limitVelocity2*=.05*i),l&&2!=this.limitState3?(y=6.2831853*r,x=y*y*t,v=i/(x+2*this.limitMotor3.dampingRatio*y),this.cfm3=this.kv22*v,this.limitVelocity3*=x*v):(this.cfm3=0,this.limitVelocity3*=.05*i),this.k00+=this.cfm1,this.k11+=this.cfm2,this.k22+=this.cfm3;var g=1/(this.k00*(this.k11*this.k22-this.k21*this.k12)+this.k10*(this.k21*this.k02-this.k01*this.k22)+this.k20*(this.k01*this.k12-this.k11*this.k02));this.d00=(this.k11*this.k22-this.k12*this.k21)*g,this.d01=(this.k02*this.k21-this.k01*this.k22)*g,this.d02=(this.k01*this.k12-this.k02*this.k11)*g,this.d10=(this.k12*this.k20-this.k10*this.k22)*g,this.d11=(this.k00*this.k22-this.k02*this.k20)*g,this.d12=(this.k02*this.k10-this.k00*this.k12)*g,this.d20=(this.k10*this.k21-this.k11*this.k20)*g,this.d21=(this.k01*this.k20-this.k00*this.k21)*g,this.d22=(this.k00*this.k11-this.k01*this.k10)*g,this.limitImpulse1*=.95,this.motorImpulse1*=.95,this.limitImpulse2*=.95,this.motorImpulse2*=.95,this.limitImpulse3*=.95,this.motorImpulse3*=.95;var b=this.limitImpulse1+this.motorImpulse1,N=this.limitImpulse2+this.motorImpulse2,C=this.limitImpulse3+this.motorImpulse3;this.a1.x+=b*this.a1x1+N*this.a1x2+C*this.a1x3,this.a1.y+=b*this.a1y1+N*this.a1y2+C*this.a1y3,this.a1.z+=b*this.a1z1+N*this.a1z2+C*this.a1z3,this.a2.x-=b*this.a2x1+N*this.a2x2+C*this.a2x3,this.a2.y-=b*this.a2y1+N*this.a2y2+C*this.a2y3,this.a2.z-=b*this.a2z1+N*this.a2z2+C*this.a2z3},solve_:function(){var t=this.a2.x-this.a1.x,i=this.a2.y-this.a1.y,e=this.a2.z-this.a1.z;this.limitVelocity3=30;var s=t*this.ax1+i*this.ay1+e*this.az1-this.limitVelocity1,n=t*this.ax2+i*this.ay2+e*this.az2-this.limitVelocity2,o=t*this.ax3+i*this.ay3+e*this.az3-this.limitVelocity3,r=s*this.d00+n*this.d01+o*this.d02,a=s*this.d10+n*this.d11+o*this.d12,h=s*this.d20+n*this.d21+o*this.d22;this.limitImpulse1+=r,this.limitImpulse2+=a,this.limitImpulse3+=h,this.a1.x+=r*this.a1x1+a*this.a1x2+h*this.a1x3,this.a1.y+=r*this.a1y1+a*this.a1y2+h*this.a1y3,this.a1.z+=r*this.a1z1+a*this.a1z2+h*this.a1z3,this.a2.x-=r*this.a2x1+a*this.a2x2+h*this.a2x3,this.a2.y-=r*this.a2y1+a*this.a2y2+h*this.a2y3,this.a2.z-=r*this.a2z1+a*this.a2z2+h*this.a2z3},solve:function(){var t=this.a2.x-this.a1.x,i=this.a2.y-this.a1.y,e=this.a2.z-this.a1.z,s=t*this.ax1+i*this.ay1+e*this.az1,n=t*this.ax2+i*this.ay2+e*this.az2,o=t*this.ax3+i*this.ay3+e*this.az3,r=this.motorImpulse1,a=this.motorImpulse2,h=this.motorImpulse3,l=0,u=0,c=0;this.enableMotor1&&(l=(s-this.motorSpeed1)*this.dv00,this.motorImpulse1+=l,this.motorImpulse1>this.maxMotorImpulse1?this.motorImpulse1=this.maxMotorImpulse1:this.motorImpulse1<-this.maxMotorImpulse1&&(this.motorImpulse1=-this.maxMotorImpulse1),l=this.motorImpulse1-r),this.enableMotor2&&(u=(n-this.motorSpeed2)*this.dv11,this.motorImpulse2+=u,this.motorImpulse2>this.maxMotorImpulse2?this.motorImpulse2=this.maxMotorImpulse2:this.motorImpulse2<-this.maxMotorImpulse2&&(this.motorImpulse2=-this.maxMotorImpulse2),u=this.motorImpulse2-a),this.enableMotor3&&(c=(o-this.motorSpeed3)*this.dv22,this.motorImpulse3+=c,this.motorImpulse3>this.maxMotorImpulse3?this.motorImpulse3=this.maxMotorImpulse3:this.motorImpulse3<-this.maxMotorImpulse3&&(this.motorImpulse3=-this.maxMotorImpulse3),c=this.motorImpulse3-h),s+=l*this.kv00+u*this.k01+c*this.k02,n+=l*this.k10+u*this.kv11+c*this.k12,o+=l*this.k20+u*this.k21+c*this.kv22,s-=this.limitVelocity1+this.limitImpulse1*this.cfm1,n-=this.limitVelocity2+this.limitImpulse2*this.cfm2,o-=this.limitVelocity3+this.limitImpulse3*this.cfm3;var p=this.limitImpulse1,d=this.limitImpulse2,m=this.limitImpulse3,f=s*this.d00+n*this.d01+o*this.d02,y=s*this.d10+n*this.d11+o*this.d12,x=s*this.d20+n*this.d21+o*this.d22;this.limitImpulse1+=f,this.limitImpulse2+=y,this.limitImpulse3+=x;var v=0;(2==this.limitState1||this.limitImpulse1*this.limitState1<0)&&(f=-p,n+=f*this.k10,o+=f*this.k20,v|=1),(2==this.limitState2||this.limitImpulse2*this.limitState2<0)&&(y=-d,s+=y*this.k01,o+=y*this.k21,v|=2),(2==this.limitState3||this.limitImpulse3*this.limitState3<0)&&(x=-m,s+=x*this.k02,n+=x*this.k12,v|=4);var g;switch(v){case 1:g=1/(this.k11*this.k22-this.k12*this.k21),y=(this.k22*n+-this.k12*o)*g,x=(-this.k21*n+this.k11*o)*g;break;case 2:g=1/(this.k00*this.k22-this.k02*this.k20),f=(this.k22*s+-this.k02*o)*g,x=(-this.k20*s+this.k00*o)*g;break;case 3:x=o/this.k22;break;case 4:g=1/(this.k00*this.k11-this.k01*this.k10),f=(this.k11*s+-this.k01*n)*g,y=(-this.k10*s+this.k00*n)*g;break;case 5:y=n/this.k11;break;case 6:f=s/this.k00}this.limitImpulse1=f+p,this.limitImpulse2=y+d,this.limitImpulse3=x+m;var b=l+f,N=u+y,C=c+x;this.a1.x+=b*this.a1x1+N*this.a1x2+C*this.a1x3,this.a1.y+=b*this.a1y1+N*this.a1y2+C*this.a1y3,this.a1.z+=b*this.a1z1+N*this.a1z2+C*this.a1z3,this.a2.x-=b*this.a2x1+N*this.a2x2+C*this.a2x3,this.a2.y-=b*this.a2y1+N*this.a2y2+C*this.a2y3,this.a2.z-=b*this.a2z1+N*this.a2z2+C*this.a2z3,t=this.a2.x-this.a1.x,i=this.a2.y-this.a1.y,e=this.a2.z-this.a1.z,n=t*this.ax2+i*this.ay2+e*this.az2}},s.RotationalConstraint=function(t,i){this.cfm=NaN,this.i1e00=NaN,this.i1e01=NaN,this.i1e02=NaN,this.i1e10=NaN,this.i1e11=NaN,this.i1e12=NaN,this.i1e20=NaN,this.i1e21=NaN,this.i1e22=NaN,this.i2e00=NaN,this.i2e01=NaN,this.i2e02=NaN,this.i2e10=NaN,this.i2e11=NaN,this.i2e12=NaN,this.i2e20=NaN,this.i2e21=NaN,this.i2e22=NaN,this.motorDenom=NaN,this.invMotorDenom=NaN,this.invDenom=NaN,this.ax=NaN,this.ay=NaN,this.az=NaN,this.a1x=NaN,this.a1y=NaN,this.a1z=NaN,this.a2x=NaN,this.a2y=NaN,this.a2z=NaN,this.enableLimit=!1,this.lowerLimit=NaN,this.upperLimit=NaN,this.limitVelocity=NaN,this.limitState=0,this.enableMotor=!1,this.motorSpeed=NaN,this.maxMotorForce=NaN,this.maxMotorImpulse=NaN,this.limitMotor=i,this.b1=t.body1,this.b2=t.body2,this.a1=this.b1.angularVelocity,this.a2=this.b2.angularVelocity,this.i1=this.b1.inverseInertia,this.i2=this.b2.inverseInertia,this.limitImpulse=0,this.motorImpulse=0},s.RotationalConstraint.prototype={constructor:s.RotationalConstraint,preSolve:function(t,i){this.ax=this.limitMotor.axis.x,this.ay=this.limitMotor.axis.y,this.az=this.limitMotor.axis.z,this.lowerLimit=this.limitMotor.lowerLimit,this.upperLimit=this.limitMotor.upperLimit,this.motorSpeed=this.limitMotor.motorSpeed,this.maxMotorForce=this.limitMotor.maxMotorForce,this.enableMotor=this.maxMotorForce>0;var e=this.i1.elements,s=this.i2.elements;this.i1e00=e[0],this.i1e01=e[1],this.i1e02=e[2],this.i1e10=e[3],this.i1e11=e[4],this.i1e12=e[5],this.i1e20=e[6],this.i1e21=e[7],this.i1e22=e[8],this.i2e00=s[0],this.i2e01=s[1],this.i2e02=s[2],this.i2e10=s[3],this.i2e11=s[4],this.i2e12=s[5],this.i2e20=s[6],this.i2e21=s[7],this.i2e22=s[8];var n=this.limitMotor.frequency,o=n>0,r=this.lowerLimit<=this.upperLimit,a=this.limitMotor.angle;if(r?(this.lowerLimit==this.upperLimit?(0!=this.limitState&&(this.limitState=0,this.limitImpulse=0),this.limitVelocity=this.lowerLimit-a):a<this.lowerLimit?(-1!=this.limitState&&(this.limitState=-1,this.limitImpulse=0),this.limitVelocity=this.lowerLimit-a):a>this.upperLimit?(1!=this.limitState&&(this.limitState=1,this.limitImpulse=0),this.limitVelocity=this.upperLimit-a):(this.limitState=2,this.limitImpulse=0,this.limitVelocity=0),o||(this.limitVelocity>.02?this.limitVelocity-=.02:this.limitVelocity<-.02?this.limitVelocity+=.02:this.limitVelocity=0)):(this.limitState=2,this.limitImpulse=0),this.enableMotor&&(0!=this.limitState||o)?this.maxMotorImpulse=this.maxMotorForce*t:(this.motorImpulse=0,this.maxMotorImpulse=0),this.a1x=this.ax*this.i1e00+this.ay*this.i1e01+this.az*this.i1e02,this.a1y=this.ax*this.i1e10+this.ay*this.i1e11+this.az*this.i1e12,this.a1z=this.ax*this.i1e20+this.ay*this.i1e21+this.az*this.i1e22,this.a2x=this.ax*this.i2e00+this.ay*this.i2e01+this.az*this.i2e02,this.a2y=this.ax*this.i2e10+this.ay*this.i2e11+this.az*this.i2e12,this.a2z=this.ax*this.i2e20+this.ay*this.i2e21+this.az*this.i2e22,this.motorDenom=this.ax*(this.a1x+this.a2x)+this.ay*(this.a1y+this.a2y)+this.az*(this.a1z+this.a2z),this.invMotorDenom=1/this.motorDenom,o&&2!=this.limitState){var h=6.2831853*n,l=h*h*t,u=i/(l+2*this.limitMotor.dampingRatio*h);this.cfm=this.motorDenom*u,this.limitVelocity*=l*u}else this.cfm=0,this.limitVelocity*=.05*i;this.invDenom=1/(this.motorDenom+this.cfm),this.limitImpulse*=.95,this.motorImpulse*=.95;var c=this.limitImpulse+this.motorImpulse;this.a1.x+=c*this.a1x,this.a1.y+=c*this.a1y,this.a1.z+=c*this.a1z,this.a2.x-=c*this.a2x,this.a2.y-=c*this.a2y,this.a2.z-=c*this.a2z},solve:function(){var t,i=this.ax*(this.a2.x-this.a1.x)+this.ay*(this.a2.y-this.a1.y)+this.az*(this.a2.z-this.a1.z);if(this.enableMotor){t=(i-this.motorSpeed)*this.invMotorDenom;var e=this.motorImpulse;this.motorImpulse+=t,this.motorImpulse>this.maxMotorImpulse?this.motorImpulse=this.maxMotorImpulse:this.motorImpulse<-this.maxMotorImpulse&&(this.motorImpulse=-this.maxMotorImpulse),t=this.motorImpulse-e,i-=t*this.motorDenom}else t=0;var s;if(2!=this.limitState){s=(i-this.limitVelocity-this.limitImpulse*this.cfm)*this.invDenom;var n=this.limitImpulse;this.limitImpulse+=s,this.limitImpulse*this.limitState<0&&(this.limitImpulse=0),s=this.limitImpulse-n}else s=0;var o=s+t;this.a1.x+=o*this.a1x,this.a1.y+=o*this.a1y,this.a1.z+=o*this.a1z,this.a2.x-=o*this.a2x,this.a2.y-=o*this.a2y,this.a2.z-=o*this.a2z}},s.Translational3Constraint=function(t,i,e,s){this.m1=NaN,this.m2=NaN,this.i1e00=NaN,this.i1e01=NaN,this.i1e02=NaN,this.i1e10=NaN,this.i1e11=NaN,this.i1e12=NaN,this.i1e20=NaN,this.i1e21=NaN,this.i1e22=NaN,this.i2e00=NaN,this.i2e01=NaN,this.i2e02=NaN,this.i2e10=NaN,this.i2e11=NaN,this.i2e12=NaN,this.i2e20=NaN,this.i2e21=NaN,this.i2e22=NaN,this.ax1=NaN,this.ay1=NaN,this.az1=NaN,this.ax2=NaN,this.ay2=NaN,this.az2=NaN,this.ax3=NaN,this.ay3=NaN,this.az3=NaN,this.r1x=NaN,this.r1y=NaN,this.r1z=NaN,this.r2x=NaN,this.r2y=NaN,this.r2z=NaN,this.t1x1=NaN,this.t1y1=NaN,this.t1z1=NaN,this.t2x1=NaN,this.t2y1=NaN,this.t2z1=NaN,this.l1x1=NaN,this.l1y1=NaN,this.l1z1=NaN,this.l2x1=NaN,this.l2y1=NaN,this.l2z1=NaN,this.a1x1=NaN,this.a1y1=NaN,this.a1z1=NaN,this.a2x1=NaN,this.a2y1=NaN,this.a2z1=NaN,this.t1x2=NaN,this.t1y2=NaN,this.t1z2=NaN,this.t2x2=NaN,this.t2y2=NaN,this.t2z2=NaN,this.l1x2=NaN,this.l1y2=NaN,this.l1z2=NaN,this.l2x2=NaN,this.l2y2=NaN,this.l2z2=NaN,this.a1x2=NaN,this.a1y2=NaN,this.a1z2=NaN,this.a2x2=NaN,this.a2y2=NaN,this.a2z2=NaN,this.t1x3=NaN,this.t1y3=NaN,this.t1z3=NaN,this.t2x3=NaN,this.t2y3=NaN,this.t2z3=NaN,this.l1x3=NaN,this.l1y3=NaN,this.l1z3=NaN,this.l2x3=NaN,this.l2y3=NaN,this.l2z3=NaN,this.a1x3=NaN,this.a1y3=NaN,this.a1z3=NaN,this.a2x3=NaN,this.a2y3=NaN,this.a2z3=NaN,this.lowerLimit1=NaN,this.upperLimit1=NaN,this.limitVelocity1=NaN,this.limitState1=0,this.enableMotor1=!1,this.motorSpeed1=NaN,this.maxMotorForce1=NaN,this.maxMotorImpulse1=NaN,this.lowerLimit2=NaN,this.upperLimit2=NaN,this.limitVelocity2=NaN,this.limitState2=0,this.enableMotor2=!1,this.motorSpeed2=NaN,this.maxMotorForce2=NaN,this.maxMotorImpulse2=NaN,this.lowerLimit3=NaN,this.upperLimit3=NaN,this.limitVelocity3=NaN,this.limitState3=0,this.enableMotor3=!1,this.motorSpeed3=NaN,this.maxMotorForce3=NaN,this.maxMotorImpulse3=NaN,this.k00=NaN,this.k01=NaN,this.k02=NaN,this.k10=NaN,this.k11=NaN,this.k12=NaN,this.k20=NaN,this.k21=NaN,this.k22=NaN,this.kv00=NaN,this.kv11=NaN,this.kv22=NaN,this.dv00=NaN,this.dv11=NaN,this.dv22=NaN,this.d00=NaN,this.d01=NaN,this.d02=NaN,this.d10=NaN,this.d11=NaN,this.d12=NaN,this.d20=NaN,this.d21=NaN,this.d22=NaN,this.limitMotor1=i,this.limitMotor2=e,this.limitMotor3=s,this.b1=t.body1,this.b2=t.body2,this.p1=t.anchorPoint1,this.p2=t.anchorPoint2,this.r1=t.relativeAnchorPoint1,this.r2=t.relativeAnchorPoint2,this.l1=this.b1.linearVelocity,this.l2=this.b2.linearVelocity,this.a1=this.b1.angularVelocity,this.a2=this.b2.angularVelocity,this.i1=this.b1.inverseInertia,this.i2=this.b2.inverseInertia,this.limitImpulse1=0,this.motorImpulse1=0,this.limitImpulse2=0,this.motorImpulse2=0,this.limitImpulse3=0,this.motorImpulse3=0,this.cfm1=0,this.cfm2=0,this.cfm3=0,this.weight=-1},s.Translational3Constraint.prototype={constructor:s.Translational3Constraint,preSolve:function(t,i){this.ax1=this.limitMotor1.axis.x,this.ay1=this.limitMotor1.axis.y,this.az1=this.limitMotor1.axis.z,this.ax2=this.limitMotor2.axis.x,this.ay2=this.limitMotor2.axis.y,this.az2=this.limitMotor2.axis.z,this.ax3=this.limitMotor3.axis.x,this.ay3=this.limitMotor3.axis.y,this.az3=this.limitMotor3.axis.z,this.lowerLimit1=this.limitMotor1.lowerLimit,this.upperLimit1=this.limitMotor1.upperLimit,this.motorSpeed1=this.limitMotor1.motorSpeed,this.maxMotorForce1=this.limitMotor1.maxMotorForce,this.enableMotor1=this.maxMotorForce1>0,this.lowerLimit2=this.limitMotor2.lowerLimit,this.upperLimit2=this.limitMotor2.upperLimit,this.motorSpeed2=this.limitMotor2.motorSpeed,this.maxMotorForce2=this.limitMotor2.maxMotorForce,this.enableMotor2=this.maxMotorForce2>0,this.lowerLimit3=this.limitMotor3.lowerLimit,this.upperLimit3=this.limitMotor3.upperLimit,this.motorSpeed3=this.limitMotor3.motorSpeed,this.maxMotorForce3=this.limitMotor3.maxMotorForce,this.enableMotor3=this.maxMotorForce3>0,this.m1=this.b1.inverseMass,this.m2=this.b2.inverseMass;var e=this.i1.elements,s=this.i2.elements;this.i1e00=e[0],this.i1e01=e[1],this.i1e02=e[2],this.i1e10=e[3],this.i1e11=e[4],this.i1e12=e[5],this.i1e20=e[6],this.i1e21=e[7],this.i1e22=e[8],this.i2e00=s[0],this.i2e01=s[1],this.i2e02=s[2],this.i2e10=s[3],this.i2e11=s[4],this.i2e12=s[5],this.i2e20=s[6],this.i2e21=s[7],this.i2e22=s[8];var n=this.p2.x-this.p1.x,o=this.p2.y-this.p1.y,r=this.p2.z-this.p1.z,a=n*this.ax1+o*this.ay1+r*this.az1,h=n*this.ax2+o*this.ay2+r*this.az2,l=n*this.ax3+o*this.ay3+r*this.az3,u=this.limitMotor1.frequency,c=this.limitMotor2.frequency,p=this.limitMotor3.frequency,d=u>0,m=c>0,f=p>0,y=this.lowerLimit1<=this.upperLimit1,x=this.lowerLimit2<=this.upperLimit2,v=this.lowerLimit3<=this.upperLimit3;(d&&a>20||-20>a)&&(d=!1),(m&&h>20||-20>h)&&(m=!1),(f&&l>20||-20>l)&&(f=!1),y?(this.lowerLimit1==this.upperLimit1?(0!=this.limitState1&&(this.limitState1=0,this.limitImpulse1=0),this.limitVelocity1=this.lowerLimit1-a,d||(a=this.lowerLimit1)):a<this.lowerLimit1?(-1!=this.limitState1&&(this.limitState1=-1,this.limitImpulse1=0),this.limitVelocity1=this.lowerLimit1-a,d||(a=this.lowerLimit1)):a>this.upperLimit1?(1!=this.limitState1&&(this.limitState1=1,this.limitImpulse1=0),this.limitVelocity1=this.upperLimit1-a,d||(a=this.upperLimit1)):(this.limitState1=2,this.limitImpulse1=0,this.limitVelocity1=0),d||(this.limitVelocity1>.005?this.limitVelocity1-=.005:this.limitVelocity1<-.005?this.limitVelocity1+=.005:this.limitVelocity1=0)):(this.limitState1=2,this.limitImpulse1=0),x?(this.lowerLimit2==this.upperLimit2?(0!=this.limitState2&&(this.limitState2=0,this.limitImpulse2=0),this.limitVelocity2=this.lowerLimit2-h,m||(h=this.lowerLimit2)):h<this.lowerLimit2?(-1!=this.limitState2&&(this.limitState2=-1,this.limitImpulse2=0),this.limitVelocity2=this.lowerLimit2-h,m||(h=this.lowerLimit2)):h>this.upperLimit2?(1!=this.limitState2&&(this.limitState2=1,this.limitImpulse2=0),this.limitVelocity2=this.upperLimit2-h,m||(h=this.upperLimit2)):(this.limitState2=2,this.limitImpulse2=0,this.limitVelocity2=0),m||(this.limitVelocity2>.005?this.limitVelocity2-=.005:this.limitVelocity2<-.005?this.limitVelocity2+=.005:this.limitVelocity2=0)):(this.limitState2=2,this.limitImpulse2=0),v?(this.lowerLimit3==this.upperLimit3?(0!=this.limitState3&&(this.limitState3=0,this.limitImpulse3=0),this.limitVelocity3=this.lowerLimit3-l,f||(l=this.lowerLimit3)):l<this.lowerLimit3?(-1!=this.limitState3&&(this.limitState3=-1,this.limitImpulse3=0),this.limitVelocity3=this.lowerLimit3-l,f||(l=this.lowerLimit3)):l>this.upperLimit3?(1!=this.limitState3&&(this.limitState3=1,this.limitImpulse3=0),this.limitVelocity3=this.upperLimit3-l,f||(l=this.upperLimit3)):(this.limitState3=2,this.limitImpulse3=0,this.limitVelocity3=0),f||(this.limitVelocity3>.005?this.limitVelocity3-=.005:this.limitVelocity3<-.005?this.limitVelocity3+=.005:this.limitVelocity3=0)):(this.limitState3=2,this.limitImpulse3=0),this.enableMotor1&&(0!=this.limitState1||d)?this.maxMotorImpulse1=this.maxMotorForce1*t:(this.motorImpulse1=0,this.maxMotorImpulse1=0),this.enableMotor2&&(0!=this.limitState2||m)?this.maxMotorImpulse2=this.maxMotorForce2*t:(this.motorImpulse2=0,this.maxMotorImpulse2=0),this.enableMotor3&&(0!=this.limitState3||f)?this.maxMotorImpulse3=this.maxMotorForce3*t:(this.motorImpulse3=0,this.maxMotorImpulse3=0);var g=a*this.ax1+h*this.ax2+l*this.ax2,b=a*this.ay1+h*this.ay2+l*this.ay2,N=a*this.az1+h*this.az2+l*this.az2,C=this.m2/(this.m1+this.m2);this.weight>=0&&(C=this.weight);var P=1-C;this.r1x=this.r1.x+g*C,this.r1y=this.r1.y+b*C,this.r1z=this.r1.z+N*C,this.r2x=this.r2.x-g*P,this.r2y=this.r2.y-b*P,this.r2z=this.r2.z-N*P,this.t1x1=this.r1y*this.az1-this.r1z*this.ay1,this.t1y1=this.r1z*this.ax1-this.r1x*this.az1,this.t1z1=this.r1x*this.ay1-this.r1y*this.ax1,this.t2x1=this.r2y*this.az1-this.r2z*this.ay1,this.t2y1=this.r2z*this.ax1-this.r2x*this.az1,this.t2z1=this.r2x*this.ay1-this.r2y*this.ax1,this.l1x1=this.ax1*this.m1,this.l1y1=this.ay1*this.m1,this.l1z1=this.az1*this.m1,this.l2x1=this.ax1*this.m2,this.l2y1=this.ay1*this.m2,this.l2z1=this.az1*this.m2,this.a1x1=this.t1x1*this.i1e00+this.t1y1*this.i1e01+this.t1z1*this.i1e02,this.a1y1=this.t1x1*this.i1e10+this.t1y1*this.i1e11+this.t1z1*this.i1e12,this.a1z1=this.t1x1*this.i1e20+this.t1y1*this.i1e21+this.t1z1*this.i1e22,this.a2x1=this.t2x1*this.i2e00+this.t2y1*this.i2e01+this.t2z1*this.i2e02,this.a2y1=this.t2x1*this.i2e10+this.t2y1*this.i2e11+this.t2z1*this.i2e12,this.a2z1=this.t2x1*this.i2e20+this.t2y1*this.i2e21+this.t2z1*this.i2e22,this.t1x2=this.r1y*this.az2-this.r1z*this.ay2,this.t1y2=this.r1z*this.ax2-this.r1x*this.az2,this.t1z2=this.r1x*this.ay2-this.r1y*this.ax2,this.t2x2=this.r2y*this.az2-this.r2z*this.ay2,this.t2y2=this.r2z*this.ax2-this.r2x*this.az2,this.t2z2=this.r2x*this.ay2-this.r2y*this.ax2,this.l1x2=this.ax2*this.m1,this.l1y2=this.ay2*this.m1,this.l1z2=this.az2*this.m1,this.l2x2=this.ax2*this.m2,this.l2y2=this.ay2*this.m2,this.l2z2=this.az2*this.m2,this.a1x2=this.t1x2*this.i1e00+this.t1y2*this.i1e01+this.t1z2*this.i1e02,this.a1y2=this.t1x2*this.i1e10+this.t1y2*this.i1e11+this.t1z2*this.i1e12,this.a1z2=this.t1x2*this.i1e20+this.t1y2*this.i1e21+this.t1z2*this.i1e22,this.a2x2=this.t2x2*this.i2e00+this.t2y2*this.i2e01+this.t2z2*this.i2e02,this.a2y2=this.t2x2*this.i2e10+this.t2y2*this.i2e11+this.t2z2*this.i2e12,this.a2z2=this.t2x2*this.i2e20+this.t2y2*this.i2e21+this.t2z2*this.i2e22,this.t1x3=this.r1y*this.az3-this.r1z*this.ay3,this.t1y3=this.r1z*this.ax3-this.r1x*this.az3,this.t1z3=this.r1x*this.ay3-this.r1y*this.ax3,this.t2x3=this.r2y*this.az3-this.r2z*this.ay3,this.t2y3=this.r2z*this.ax3-this.r2x*this.az3,this.t2z3=this.r2x*this.ay3-this.r2y*this.ax3,this.l1x3=this.ax3*this.m1,this.l1y3=this.ay3*this.m1,this.l1z3=this.az3*this.m1,this.l2x3=this.ax3*this.m2,this.l2y3=this.ay3*this.m2,this.l2z3=this.az3*this.m2,this.a1x3=this.t1x3*this.i1e00+this.t1y3*this.i1e01+this.t1z3*this.i1e02,this.a1y3=this.t1x3*this.i1e10+this.t1y3*this.i1e11+this.t1z3*this.i1e12,
this.a1z3=this.t1x3*this.i1e20+this.t1y3*this.i1e21+this.t1z3*this.i1e22,this.a2x3=this.t2x3*this.i2e00+this.t2y3*this.i2e01+this.t2z3*this.i2e02,this.a2y3=this.t2x3*this.i2e10+this.t2y3*this.i2e11+this.t2z3*this.i2e12,this.a2z3=this.t2x3*this.i2e20+this.t2y3*this.i2e21+this.t2z3*this.i2e22;var A=this.m1+this.m2;if(this.k00=(this.ax1*this.ax1+this.ay1*this.ay1+this.az1*this.az1)*A,this.k01=(this.ax1*this.ax2+this.ay1*this.ay2+this.az1*this.az2)*A,this.k02=(this.ax1*this.ax3+this.ay1*this.ay3+this.az1*this.az3)*A,this.k10=(this.ax2*this.ax1+this.ay2*this.ay1+this.az2*this.az1)*A,this.k11=(this.ax2*this.ax2+this.ay2*this.ay2+this.az2*this.az2)*A,this.k12=(this.ax2*this.ax3+this.ay2*this.ay3+this.az2*this.az3)*A,this.k20=(this.ax3*this.ax1+this.ay3*this.ay1+this.az3*this.az1)*A,this.k21=(this.ax3*this.ax2+this.ay3*this.ay2+this.az3*this.az2)*A,this.k22=(this.ax3*this.ax3+this.ay3*this.ay3+this.az3*this.az3)*A,this.k00+=this.t1x1*this.a1x1+this.t1y1*this.a1y1+this.t1z1*this.a1z1,this.k01+=this.t1x1*this.a1x2+this.t1y1*this.a1y2+this.t1z1*this.a1z2,this.k02+=this.t1x1*this.a1x3+this.t1y1*this.a1y3+this.t1z1*this.a1z3,this.k10+=this.t1x2*this.a1x1+this.t1y2*this.a1y1+this.t1z2*this.a1z1,this.k11+=this.t1x2*this.a1x2+this.t1y2*this.a1y2+this.t1z2*this.a1z2,this.k12+=this.t1x2*this.a1x3+this.t1y2*this.a1y3+this.t1z2*this.a1z3,this.k20+=this.t1x3*this.a1x1+this.t1y3*this.a1y1+this.t1z3*this.a1z1,this.k21+=this.t1x3*this.a1x2+this.t1y3*this.a1y2+this.t1z3*this.a1z2,this.k22+=this.t1x3*this.a1x3+this.t1y3*this.a1y3+this.t1z3*this.a1z3,this.k00+=this.t2x1*this.a2x1+this.t2y1*this.a2y1+this.t2z1*this.a2z1,this.k01+=this.t2x1*this.a2x2+this.t2y1*this.a2y2+this.t2z1*this.a2z2,this.k02+=this.t2x1*this.a2x3+this.t2y1*this.a2y3+this.t2z1*this.a2z3,this.k10+=this.t2x2*this.a2x1+this.t2y2*this.a2y1+this.t2z2*this.a2z1,this.k11+=this.t2x2*this.a2x2+this.t2y2*this.a2y2+this.t2z2*this.a2z2,this.k12+=this.t2x2*this.a2x3+this.t2y2*this.a2y3+this.t2z2*this.a2z3,this.k20+=this.t2x3*this.a2x1+this.t2y3*this.a2y1+this.t2z3*this.a2z1,this.k21+=this.t2x3*this.a2x2+this.t2y3*this.a2y2+this.t2z3*this.a2z2,this.k22+=this.t2x3*this.a2x3+this.t2y3*this.a2y3+this.t2z3*this.a2z3,this.kv00=this.k00,this.kv11=this.k11,this.kv22=this.k22,this.dv00=1/this.kv00,this.dv11=1/this.kv11,this.dv22=1/this.kv22,d&&2!=this.limitState1){var S=6.2831853*u,k=S*S*t,I=i/(k+2*this.limitMotor1.dampingRatio*S);this.cfm1=this.kv00*I,this.limitVelocity1*=k*I}else this.cfm1=0,this.limitVelocity1*=.05*i;m&&2!=this.limitState2?(S=6.2831853*c,k=S*S*t,I=i/(k+2*this.limitMotor2.dampingRatio*S),this.cfm2=this.kv11*I,this.limitVelocity2*=k*I):(this.cfm2=0,this.limitVelocity2*=.05*i),f&&2!=this.limitState3?(S=6.2831853*p,k=S*S*t,I=i/(k+2*this.limitMotor3.dampingRatio*S),this.cfm3=this.kv22*I,this.limitVelocity3*=k*I):(this.cfm3=0,this.limitVelocity3*=.05*i),this.k00+=this.cfm1,this.k11+=this.cfm2,this.k22+=this.cfm3;var z=1/(this.k00*(this.k11*this.k22-this.k21*this.k12)+this.k10*(this.k21*this.k02-this.k01*this.k22)+this.k20*(this.k01*this.k12-this.k11*this.k02));this.d00=(this.k11*this.k22-this.k12*this.k21)*z,this.d01=(this.k02*this.k21-this.k01*this.k22)*z,this.d02=(this.k01*this.k12-this.k02*this.k11)*z,this.d10=(this.k12*this.k20-this.k10*this.k22)*z,this.d11=(this.k00*this.k22-this.k02*this.k20)*z,this.d12=(this.k02*this.k10-this.k00*this.k12)*z,this.d20=(this.k10*this.k21-this.k11*this.k20)*z,this.d21=(this.k01*this.k20-this.k00*this.k21)*z,this.d22=(this.k00*this.k11-this.k01*this.k10)*z;var _=this.limitImpulse1+this.motorImpulse1,M=this.limitImpulse2+this.motorImpulse2,E=this.limitImpulse3+this.motorImpulse3;this.l1.x+=_*this.l1x1+M*this.l1x2+E*this.l1x3,this.l1.y+=_*this.l1y1+M*this.l1y2+E*this.l1y3,this.l1.z+=_*this.l1z1+M*this.l1z2+E*this.l1z3,this.a1.x+=_*this.a1x1+M*this.a1x2+E*this.a1x3,this.a1.y+=_*this.a1y1+M*this.a1y2+E*this.a1y3,this.a1.z+=_*this.a1z1+M*this.a1z2+E*this.a1z3,this.l2.x-=_*this.l2x1+M*this.l2x2+E*this.l2x3,this.l2.y-=_*this.l2y1+M*this.l2y2+E*this.l2y3,this.l2.z-=_*this.l2z1+M*this.l2z2+E*this.l2z3,this.a2.x-=_*this.a2x1+M*this.a2x2+E*this.a2x3,this.a2.y-=_*this.a2y1+M*this.a2y2+E*this.a2y3,this.a2.z-=_*this.a2z1+M*this.a2z2+E*this.a2z3},solve:function(){var t=this.l2.x-this.l1.x+this.a2.y*this.r2z-this.a2.z*this.r2y-this.a1.y*this.r1z+this.a1.z*this.r1y,i=this.l2.y-this.l1.y+this.a2.z*this.r2x-this.a2.x*this.r2z-this.a1.z*this.r1x+this.a1.x*this.r1z,e=this.l2.z-this.l1.z+this.a2.x*this.r2y-this.a2.y*this.r2x-this.a1.x*this.r1y+this.a1.y*this.r1x,s=t*this.ax1+i*this.ay1+e*this.az1,n=t*this.ax2+i*this.ay2+e*this.az2,o=t*this.ax3+i*this.ay3+e*this.az3,r=this.motorImpulse1,a=this.motorImpulse2,h=this.motorImpulse3,l=0,u=0,c=0;this.enableMotor1&&(l=(s-this.motorSpeed1)*this.dv00,this.motorImpulse1+=l,this.motorImpulse1>this.maxMotorImpulse1?this.motorImpulse1=this.maxMotorImpulse1:this.motorImpulse1<-this.maxMotorImpulse1&&(this.motorImpulse1=-this.maxMotorImpulse1),l=this.motorImpulse1-r),this.enableMotor2&&(u=(n-this.motorSpeed2)*this.dv11,this.motorImpulse2+=u,this.motorImpulse2>this.maxMotorImpulse2?this.motorImpulse2=this.maxMotorImpulse2:this.motorImpulse2<-this.maxMotorImpulse2&&(this.motorImpulse2=-this.maxMotorImpulse2),u=this.motorImpulse2-a),this.enableMotor3&&(c=(o-this.motorSpeed3)*this.dv22,this.motorImpulse3+=c,this.motorImpulse3>this.maxMotorImpulse3?this.motorImpulse3=this.maxMotorImpulse3:this.motorImpulse3<-this.maxMotorImpulse3&&(this.motorImpulse3=-this.maxMotorImpulse3),c=this.motorImpulse3-h),s+=l*this.kv00+u*this.k01+c*this.k02,n+=l*this.k10+u*this.kv11+c*this.k12,o+=l*this.k20+u*this.k21+c*this.kv22,s-=this.limitVelocity1+this.limitImpulse1*this.cfm1,n-=this.limitVelocity2+this.limitImpulse2*this.cfm2,o-=this.limitVelocity3+this.limitImpulse3*this.cfm3;var p=this.limitImpulse1,d=this.limitImpulse2,m=this.limitImpulse3,f=s*this.d00+n*this.d01+o*this.d02,y=s*this.d10+n*this.d11+o*this.d12,x=s*this.d20+n*this.d21+o*this.d22;this.limitImpulse1+=f,this.limitImpulse2+=y,this.limitImpulse3+=x;var v=0;(2==this.limitState1||this.limitImpulse1*this.limitState1<0)&&(f=-p,n+=f*this.k10,o+=f*this.k20,v|=1),(2==this.limitState2||this.limitImpulse2*this.limitState2<0)&&(y=-d,s+=y*this.k01,o+=y*this.k21,v|=2),(2==this.limitState3||this.limitImpulse3*this.limitState3<0)&&(x=-m,s+=x*this.k02,n+=x*this.k12,v|=4);var g;switch(v){case 1:g=1/(this.k11*this.k22-this.k12*this.k21),y=(this.k22*n+-this.k12*o)*g,x=(-this.k21*n+this.k11*o)*g;break;case 2:g=1/(this.k00*this.k22-this.k02*this.k20),f=(this.k22*s+-this.k02*o)*g,x=(-this.k20*s+this.k00*o)*g;break;case 3:x=o/this.k22;break;case 4:g=1/(this.k00*this.k11-this.k01*this.k10),f=(this.k11*s+-this.k01*n)*g,y=(-this.k10*s+this.k00*n)*g;break;case 5:y=n/this.k11;break;case 6:f=s/this.k00}this.limitImpulse1=p+f,this.limitImpulse2=d+y,this.limitImpulse3=m+x;var b=l+f,N=u+y,C=c+x;this.l1.x+=b*this.l1x1+N*this.l1x2+C*this.l1x3,this.l1.y+=b*this.l1y1+N*this.l1y2+C*this.l1y3,this.l1.z+=b*this.l1z1+N*this.l1z2+C*this.l1z3,this.a1.x+=b*this.a1x1+N*this.a1x2+C*this.a1x3,this.a1.y+=b*this.a1y1+N*this.a1y2+C*this.a1y3,this.a1.z+=b*this.a1z1+N*this.a1z2+C*this.a1z3,this.l2.x-=b*this.l2x1+N*this.l2x2+C*this.l2x3,this.l2.y-=b*this.l2y1+N*this.l2y2+C*this.l2y3,this.l2.z-=b*this.l2z1+N*this.l2z2+C*this.l2z3,this.a2.x-=b*this.a2x1+N*this.a2x2+C*this.a2x3,this.a2.y-=b*this.a2y1+N*this.a2y2+C*this.a2y3,this.a2.z-=b*this.a2z1+N*this.a2z2+C*this.a2z3}},s.TranslationalConstraint=function(t,i){this.cfm=NaN,this.m1=NaN,this.m2=NaN,this.i1e00=NaN,this.i1e01=NaN,this.i1e02=NaN,this.i1e10=NaN,this.i1e11=NaN,this.i1e12=NaN,this.i1e20=NaN,this.i1e21=NaN,this.i1e22=NaN,this.i2e00=NaN,this.i2e01=NaN,this.i2e02=NaN,this.i2e10=NaN,this.i2e11=NaN,this.i2e12=NaN,this.i2e20=NaN,this.i2e21=NaN,this.i2e22=NaN,this.motorDenom=NaN,this.invMotorDenom=NaN,this.invDenom=NaN,this.ax=NaN,this.ay=NaN,this.az=NaN,this.r1x=NaN,this.r1y=NaN,this.r1z=NaN,this.r2x=NaN,this.r2y=NaN,this.r2z=NaN,this.t1x=NaN,this.t1y=NaN,this.t1z=NaN,this.t2x=NaN,this.t2y=NaN,this.t2z=NaN,this.l1x=NaN,this.l1y=NaN,this.l1z=NaN,this.l2x=NaN,this.l2y=NaN,this.l2z=NaN,this.a1x=NaN,this.a1y=NaN,this.a1z=NaN,this.a2x=NaN,this.a2y=NaN,this.a2z=NaN,this.lowerLimit=NaN,this.upperLimit=NaN,this.limitVelocity=NaN,this.limitState=0,this.enableMotor=!1,this.motorSpeed=NaN,this.maxMotorForce=NaN,this.maxMotorImpulse=NaN,this.limitMotor=i,this.b1=t.body1,this.b2=t.body2,this.p1=t.anchorPoint1,this.p2=t.anchorPoint2,this.r1=t.relativeAnchorPoint1,this.r2=t.relativeAnchorPoint2,this.l1=this.b1.linearVelocity,this.l2=this.b2.linearVelocity,this.a1=this.b1.angularVelocity,this.a2=this.b2.angularVelocity,this.i1=this.b1.inverseInertia,this.i2=this.b2.inverseInertia,this.limitImpulse=0,this.motorImpulse=0},s.TranslationalConstraint.prototype={constructor:s.TranslationalConstraint,preSolve:function(t,i){this.ax=this.limitMotor.axis.x,this.ay=this.limitMotor.axis.y,this.az=this.limitMotor.axis.z,this.lowerLimit=this.limitMotor.lowerLimit,this.upperLimit=this.limitMotor.upperLimit,this.motorSpeed=this.limitMotor.motorSpeed,this.maxMotorForce=this.limitMotor.maxMotorForce,this.enableMotor=this.maxMotorForce>0,this.m1=this.b1.inverseMass,this.m2=this.b2.inverseMass;var e=this.i1.elements,s=this.i2.elements;this.i1e00=e[0],this.i1e01=e[1],this.i1e02=e[2],this.i1e10=e[3],this.i1e11=e[4],this.i1e12=e[5],this.i1e20=e[6],this.i1e21=e[7],this.i1e22=e[8],this.i2e00=s[0],this.i2e01=s[1],this.i2e02=s[2],this.i2e10=s[3],this.i2e11=s[4],this.i2e12=s[5],this.i2e20=s[6],this.i2e21=s[7],this.i2e22=s[8];var n=this.p2.x-this.p1.x,o=this.p2.y-this.p1.y,r=this.p2.z-this.p1.z,a=n*this.ax+o*this.ay+r*this.az,h=this.limitMotor.frequency,l=h>0,u=this.lowerLimit<=this.upperLimit;(l&&a>20||-20>a)&&(l=!1),u?(this.lowerLimit==this.upperLimit?(0!=this.limitState&&(this.limitState=0,this.limitImpulse=0),this.limitVelocity=this.lowerLimit-a,l||(a=this.lowerLimit)):a<this.lowerLimit?(-1!=this.limitState&&(this.limitState=-1,this.limitImpulse=0),this.limitVelocity=this.lowerLimit-a,l||(a=this.lowerLimit)):a>this.upperLimit?(1!=this.limitState&&(this.limitState=1,this.limitImpulse=0),this.limitVelocity=this.upperLimit-a,l||(a=this.upperLimit)):(this.limitState=2,this.limitImpulse=0,this.limitVelocity=0),l||(this.limitVelocity>.005?this.limitVelocity-=.005:this.limitVelocity<-.005?this.limitVelocity+=.005:this.limitVelocity=0)):(this.limitState=2,this.limitImpulse=0),this.enableMotor&&(0!=this.limitState||l)?this.maxMotorImpulse=this.maxMotorForce*t:(this.motorImpulse=0,this.maxMotorImpulse=0);var c=a*this.ax,p=a*this.ay,d=a*this.az,m=this.m1/(this.m1+this.m2),f=1-m;if(this.r1x=this.r1.x+c*m,this.r1y=this.r1.y+p*m,this.r1z=this.r1.z+d*m,this.r2x=this.r2.x-c*f,this.r2y=this.r2.y-p*f,this.r2z=this.r2.z-d*f,this.t1x=this.r1y*this.az-this.r1z*this.ay,this.t1y=this.r1z*this.ax-this.r1x*this.az,this.t1z=this.r1x*this.ay-this.r1y*this.ax,this.t2x=this.r2y*this.az-this.r2z*this.ay,this.t2y=this.r2z*this.ax-this.r2x*this.az,this.t2z=this.r2x*this.ay-this.r2y*this.ax,this.l1x=this.ax*this.m1,this.l1y=this.ay*this.m1,this.l1z=this.az*this.m1,this.l2x=this.ax*this.m2,this.l2y=this.ay*this.m2,this.l2z=this.az*this.m2,this.a1x=this.t1x*this.i1e00+this.t1y*this.i1e01+this.t1z*this.i1e02,this.a1y=this.t1x*this.i1e10+this.t1y*this.i1e11+this.t1z*this.i1e12,this.a1z=this.t1x*this.i1e20+this.t1y*this.i1e21+this.t1z*this.i1e22,this.a2x=this.t2x*this.i2e00+this.t2y*this.i2e01+this.t2z*this.i2e02,this.a2y=this.t2x*this.i2e10+this.t2y*this.i2e11+this.t2z*this.i2e12,this.a2z=this.t2x*this.i2e20+this.t2y*this.i2e21+this.t2z*this.i2e22,this.motorDenom=this.m1+this.m2+this.ax*(this.a1y*this.r1z-this.a1z*this.r1y+this.a2y*this.r2z-this.a2z*this.r2y)+this.ay*(this.a1z*this.r1x-this.a1x*this.r1z+this.a2z*this.r2x-this.a2x*this.r2z)+this.az*(this.a1x*this.r1y-this.a1y*this.r1x+this.a2x*this.r2y-this.a2y*this.r2x),this.invMotorDenom=1/this.motorDenom,l&&2!=this.limitState){var y=6.2831853*h,x=y*y*t,v=i/(x+2*this.limitMotor.dampingRatio*y);this.cfm=this.motorDenom*v,this.limitVelocity*=x*v}else this.cfm=0,this.limitVelocity*=.05*i;this.invDenom=1/(this.motorDenom+this.cfm);var g=this.limitImpulse+this.motorImpulse;this.l1.x+=g*this.l1x,this.l1.y+=g*this.l1y,this.l1.z+=g*this.l1z,this.a1.x+=g*this.a1x,this.a1.y+=g*this.a1y,this.a1.z+=g*this.a1z,this.l2.x-=g*this.l2x,this.l2.y-=g*this.l2y,this.l2.z-=g*this.l2z,this.a2.x-=g*this.a2x,this.a2.y-=g*this.a2y,this.a2.z-=g*this.a2z},solve:function(){var t,i=this.ax*(this.l2.x-this.l1.x)+this.ay*(this.l2.y-this.l1.y)+this.az*(this.l2.z-this.l1.z)+this.t2x*this.a2.x-this.t1x*this.a1.x+this.t2y*this.a2.y-this.t1y*this.a1.y+this.t2z*this.a2.z-this.t1z*this.a1.z;if(this.enableMotor){t=(i-this.motorSpeed)*this.invMotorDenom;var e=this.motorImpulse;this.motorImpulse+=t,this.motorImpulse>this.maxMotorImpulse?this.motorImpulse=this.maxMotorImpulse:this.motorImpulse<-this.maxMotorImpulse&&(this.motorImpulse=-this.maxMotorImpulse),t=this.motorImpulse-e,i-=t*this.motorDenom}else t=0;var s;if(2!=this.limitState){s=(i-this.limitVelocity-this.limitImpulse*this.cfm)*this.invDenom;var n=this.limitImpulse;this.limitImpulse+=s,this.limitImpulse*this.limitState<0&&(this.limitImpulse=0),s=this.limitImpulse-n}else s=0;var o=s+t;this.l1.x+=o*this.l1x,this.l1.y+=o*this.l1y,this.l1.z+=o*this.l1z,this.a1.x+=o*this.a1x,this.a1.y+=o*this.a1y,this.a1.z+=o*this.a1z,this.l2.x-=o*this.l2x,this.l2.y-=o*this.l2y,this.l2.z-=o*this.l2z,this.a2.x-=o*this.a2x,this.a2.y-=o*this.a2y,this.a2.z-=o*this.a2z}},s.Contact=function(){this.shape1=null,this.shape2=null,this.body1=null,this.body2=null,this.prev=null,this.next=null,this.persisting=!1,this.sleeping=!1,this.detector=null,this.constraint=null,this.touching=!1,this.b1Link=new s.ContactLink(this),this.b2Link=new s.ContactLink(this),this.s1Link=new s.ContactLink(this),this.s2Link=new s.ContactLink(this),this.manifold=new s.ContactManifold,this.buffer=[],this.buffer.length=4,this.buffer[0]=new s.ImpulseDataBuffer,this.buffer[1]=new s.ImpulseDataBuffer,this.buffer[2]=new s.ImpulseDataBuffer,this.buffer[3]=new s.ImpulseDataBuffer,this.points=this.manifold.points,this.constraint=new s.ContactConstraint(this.manifold)},s.Contact.prototype={constructor:s.Contact,mixRestitution:function(t,i){return s.sqrt(t*i)},mixFriction:function(t,i){return s.sqrt(t*i)},updateManifold:function(){this.constraint.restitution=this.mixRestitution(this.shape1.restitution,this.shape2.restitution),this.constraint.friction=this.mixFriction(this.shape1.friction,this.shape2.friction);for(var t=this.manifold.numPoints,i=t;i--;){var e=this.buffer[i],s=this.points[i];e.lp1X=s.localPoint1.x,e.lp1Y=s.localPoint1.y,e.lp1Z=s.localPoint1.z,e.lp2X=s.localPoint2.x,e.lp2Y=s.localPoint2.y,e.lp2Z=s.localPoint2.z,e.impulse=s.normalImpulse}this.manifold.numPoints=0,this.detector.detectCollision(this.shape1,this.shape2,this.manifold);var n=this.manifold.numPoints;if(0==n)return void(this.touching=!1);for(this.touching=!0,i=n;i--;){s=this.points[i];for(var o=s.localPoint1.x,r=s.localPoint1.y,a=s.localPoint1.z,h=s.localPoint2.x,l=s.localPoint2.y,u=s.localPoint2.z,c=-1,p=4e-4,d=t;d--;){e=this.buffer[d];var m=e.lp1X-o,f=e.lp1Y-r,y=e.lp1Z-a,x=m*m+f*f+y*y;m=e.lp2X-h,f=e.lp2Y-l,y=e.lp2Z-u;var v=m*m+f*f+y*y;v>x?p>x&&(p=x,c=d):p>v&&(p=v,c=d)}if(-1!=c){var g=this.buffer[c];this.buffer[c]=this.buffer[--t],this.buffer[t]=g,s.normalImpulse=g.impulse,s.warmStarted=!0}else s.normalImpulse=0,s.warmStarted=!1}},attach:function(t,i){this.shape1=t,this.shape2=i,this.body1=t.parent,this.body2=i.parent,this.manifold.body1=this.body1,this.manifold.body2=this.body2,this.constraint.body1=this.body1,this.constraint.body2=this.body2,this.constraint.attach(),this.s1Link.shape=i,this.s1Link.body=this.body2,this.s2Link.shape=t,this.s2Link.body=this.body1,null!=t.contactLink?(this.s1Link.next=t.contactLink).prev=this.s1Link:this.s1Link.next=null,t.contactLink=this.s1Link,t.numContacts++,null!=i.contactLink?(this.s2Link.next=i.contactLink).prev=this.s2Link:this.s2Link.next=null,i.contactLink=this.s2Link,i.numContacts++,this.b1Link.shape=i,this.b1Link.body=this.body2,this.b2Link.shape=t,this.b2Link.body=this.body1,null!=this.body1.contactLink?(this.b1Link.next=this.body1.contactLink).prev=this.b1Link:this.b1Link.next=null,this.body1.contactLink=this.b1Link,this.body1.numContacts++,null!=this.body2.contactLink?(this.b2Link.next=this.body2.contactLink).prev=this.b2Link:this.b2Link.next=null,this.body2.contactLink=this.b2Link,this.body2.numContacts++,this.prev=null,this.next=null,this.persisting=!0,this.sleeping=this.body1.sleeping&&this.body2.sleeping,this.manifold.numPoints=0},detach:function(){var t=this.s1Link.prev,i=this.s1Link.next;null!==t&&(t.next=i),null!==i&&(i.prev=t),this.shape1.contactLink==this.s1Link&&(this.shape1.contactLink=i),this.s1Link.prev=null,this.s1Link.next=null,this.s1Link.shape=null,this.s1Link.body=null,this.shape1.numContacts--,t=this.s2Link.prev,i=this.s2Link.next,null!==t&&(t.next=i),null!==i&&(i.prev=t),this.shape2.contactLink==this.s2Link&&(this.shape2.contactLink=i),this.s2Link.prev=null,this.s2Link.next=null,this.s2Link.shape=null,this.s2Link.body=null,this.shape2.numContacts--,t=this.b1Link.prev,i=this.b1Link.next,null!==t&&(t.next=i),null!==i&&(i.prev=t),this.body1.contactLink==this.b1Link&&(this.body1.contactLink=i),this.b1Link.prev=null,this.b1Link.next=null,this.b1Link.shape=null,this.b1Link.body=null,this.body1.numContacts--,t=this.b2Link.prev,i=this.b2Link.next,null!==t&&(t.next=i),null!==i&&(i.prev=t),this.body2.contactLink==this.b2Link&&(this.body2.contactLink=i),this.b2Link.prev=null,this.b2Link.next=null,this.b2Link.shape=null,this.b2Link.body=null,this.body2.numContacts--,this.manifold.body1=null,this.manifold.body2=null,this.constraint.body1=null,this.constraint.body2=null,this.constraint.detach(),this.shape1=null,this.shape2=null,this.body1=null,this.body2=null}},s.ContactConstraint=function(t){s.Constraint.call(this),this.manifold=t,this.restitution=NaN,this.friction=NaN,this.p1=null,this.p2=null,this.lv1=null,this.lv2=null,this.av1=null,this.av2=null,this.i1=null,this.i2=null,this.ii1=null,this.ii2=null,this.m1=NaN,this.m2=NaN,this.num=0,this.ps=t.points,this.cs=new s.ContactPointDataBuffer,this.cs.next=new s.ContactPointDataBuffer,this.cs.next.next=new s.ContactPointDataBuffer,this.cs.next.next.next=new s.ContactPointDataBuffer},s.ContactConstraint.prototype=Object.create(s.Constraint.prototype),s.ContactConstraint.prototype.attach=function(){this.p1=this.body1.position,this.p2=this.body2.position,this.lv1=this.body1.linearVelocity,this.av1=this.body1.angularVelocity,this.lv2=this.body2.linearVelocity,this.av2=this.body2.angularVelocity,this.i1=this.body1.inverseInertia,this.i2=this.body2.inverseInertia},s.ContactConstraint.prototype.detach=function(){this.p1=null,this.p2=null,this.lv1=null,this.lv2=null,this.av1=null,this.av2=null,this.i1=null,this.i2=null},s.ContactConstraint.prototype.preSolve=function(t,i){this.m1=this.body1.inverseMass,this.m2=this.body2.inverseMass,this.ii1=this.i1.clone(),this.ii2=this.i2.clone();var e=this.ii1.elements,n=this.ii2.elements,o=this.p1.x,r=this.p1.y,a=this.p1.z,h=this.p2.x,l=this.p2.y,u=this.p2.z,c=this.m1+this.m2;this.num=this.manifold.numPoints;for(var p=this.cs,d=0;d<this.num;d++){var m,f,y,x,v,g,b=this.ps[d];m=b.position.x,f=b.position.y,y=b.position.z;var N=m-o,C=f-r,P=y-a,A=m-h,S=f-l,k=y-u;p.rp1X=N,p.rp1Y=C,p.rp1Z=P,p.rp2X=A,p.rp2Y=S,p.rp2Z=k,p.norImp=b.normalImpulse,p.tanImp=b.tangentImpulse,p.binImp=b.binormalImpulse;var I=b.normal.x,z=b.normal.y,_=b.normal.z,M=this.lv2.x+this.av2.y*k-this.av2.z*S-(this.lv1.x+this.av1.y*P-this.av1.z*C),E=this.lv2.y+this.av2.z*A-this.av2.x*k-(this.lv1.y+this.av1.z*N-this.av1.x*P),w=this.lv2.z+this.av2.x*S-this.av2.y*A-(this.lv1.z+this.av1.x*C-this.av1.y*N),D=I*M+z*E+_*w,T=M-D*I,L=E-D*z,R=w-D*_,O=T*T+L*L+R*R;O>.04?O=1/s.sqrt(O):(T=z*I-_*_,L=-_*z-I*I,R=I*_+z*z,O=1/s.sqrt(T*T+L*L+R*R)),T*=O,L*=O,R*=O;var V=z*R-_*L,B=_*T-I*R,U=I*L-z*T;p.norX=I,p.norY=z,p.norZ=_,p.tanX=T,p.tanY=L,p.tanZ=R,p.binX=V,p.binY=B,p.binZ=U,p.norU1X=I*this.m1,p.norU1Y=z*this.m1,p.norU1Z=_*this.m1,p.norU2X=I*this.m2,p.norU2Y=z*this.m2,p.norU2Z=_*this.m2,p.tanU1X=T*this.m1,p.tanU1Y=L*this.m1,p.tanU1Z=R*this.m1,p.tanU2X=T*this.m2,p.tanU2Y=L*this.m2,p.tanU2Z=R*this.m2,p.binU1X=V*this.m1,p.binU1Y=B*this.m1,p.binU1Z=U*this.m1,p.binU2X=V*this.m2,p.binU2Y=B*this.m2,p.binU2Z=U*this.m2;var F=C*_-P*z,j=P*I-N*_,Y=N*z-C*I,X=S*_-k*z,W=k*I-A*_,Z=A*z-S*I,q=C*R-P*L,H=P*T-N*R,J=N*L-C*T,K=S*R-k*L,Q=k*T-A*R,G=A*L-S*T,$=C*U-P*B,tt=P*V-N*U,it=N*B-C*V,et=S*U-k*B,st=k*V-A*U,nt=A*B-S*V,ot=F*e[0]+j*e[1]+Y*e[2],rt=F*e[3]+j*e[4]+Y*e[5],at=F*e[6]+j*e[7]+Y*e[8],ht=X*n[0]+W*n[1]+Z*n[2],lt=X*n[3]+W*n[4]+Z*n[5],ut=X*n[6]+W*n[7]+Z*n[8],ct=q*e[0]+H*e[1]+J*e[2],pt=q*e[3]+H*e[4]+J*e[5],dt=q*e[6]+H*e[7]+J*e[8],mt=K*n[0]+Q*n[1]+G*n[2],ft=K*n[3]+Q*n[4]+G*n[5],yt=K*n[6]+Q*n[7]+G*n[8],xt=$*e[0]+tt*e[1]+it*e[2],vt=$*e[3]+tt*e[4]+it*e[5],gt=$*e[6]+tt*e[7]+it*e[8],bt=et*n[0]+st*n[1]+nt*n[2],Nt=et*n[3]+st*n[4]+nt*n[5],Ct=et*n[6]+st*n[7]+nt*n[8];p.norT1X=F,p.norT1Y=j,p.norT1Z=Y,p.tanT1X=q,p.tanT1Y=H,p.tanT1Z=J,p.binT1X=$,p.binT1Y=tt,p.binT1Z=it,p.norT2X=X,p.norT2Y=W,p.norT2Z=Z,p.tanT2X=K,p.tanT2Y=Q,p.tanT2Z=G,p.binT2X=et,p.binT2Y=st,p.binT2Z=nt,p.norTU1X=ot,p.norTU1Y=rt,p.norTU1Z=at,p.tanTU1X=ct,p.tanTU1Y=pt,p.tanTU1Z=dt,p.binTU1X=xt,p.binTU1Y=vt,p.binTU1Z=gt,p.norTU2X=ht,p.norTU2Y=lt,p.norTU2Z=ut,p.tanTU2X=mt,p.tanTU2Y=ft,p.tanTU2Z=yt,p.binTU2X=bt,p.binTU2Y=Nt,p.binTU2Z=Ct,m=F*e[0]+j*e[1]+Y*e[2],f=F*e[3]+j*e[4]+Y*e[5],y=F*e[6]+j*e[7]+Y*e[8],x=f*P-y*C,v=y*N-m*P,g=m*C-f*N,m=X*n[0]+W*n[1]+Z*n[2],f=X*n[3]+W*n[4]+Z*n[5],y=X*n[6]+W*n[7]+Z*n[8],x+=f*k-y*S,v+=y*A-m*k,g+=m*S-f*A;var Pt=1/(c+I*x+z*v+_*g);m=q*e[0]+H*e[1]+J*e[2],f=q*e[3]+H*e[4]+J*e[5],y=q*e[6]+H*e[7]+J*e[8],x=f*P-y*C,v=y*N-m*P,g=m*C-f*N,m=K*n[0]+Q*n[1]+G*n[2],f=K*n[3]+Q*n[4]+G*n[5],y=K*n[6]+Q*n[7]+G*n[8],x+=f*k-y*S,v+=y*A-m*k,g+=m*S-f*A;var At=1/(c+T*x+L*v+R*g);m=$*e[0]+tt*e[1]+it*e[2],f=$*e[3]+tt*e[4]+it*e[5],y=$*e[6]+tt*e[7]+it*e[8],x=f*P-y*C,v=y*N-m*P,g=m*C-f*N,m=et*n[0]+st*n[1]+nt*n[2],f=et*n[3]+st*n[4]+nt*n[5],y=et*n[6]+st*n[7]+nt*n[8],x+=f*k-y*S,v+=y*A-m*k,g+=m*S-f*A;var St=1/(c+V*x+B*v+U*g);if(p.norDen=Pt,p.tanDen=At,p.binDen=St,b.warmStarted){var kt=b.normalImpulse;this.lv1.x+=p.norU1X*kt,this.lv1.y+=p.norU1Y*kt,this.lv1.z+=p.norU1Z*kt,this.av1.x+=ot*kt,this.av1.y+=rt*kt,this.av1.z+=at*kt,this.lv2.x-=p.norU2X*kt,this.lv2.y-=p.norU2Y*kt,this.lv2.z-=p.norU2Z*kt,this.av2.x-=ht*kt,this.av2.y-=lt*kt,this.av2.z-=ut*kt,p.norImp=kt,p.tanImp=0,p.binImp=0,D=0}else p.norImp=0,p.tanImp=0,p.binImp=0;D>-1&&(D=0);var It=this.restitution*-D,zt=-(b.penetration+.005)*i*.05;zt>It&&(It=zt),p.norTar=It,p.last=d==this.num-1,p=p.next}},s.ContactConstraint.prototype.solve=function(){for(var t=this.lv1.x,i=this.lv1.y,e=this.lv1.z,n=this.lv2.x,o=this.lv2.y,r=this.lv2.z,a=this.av1.x,h=this.av1.y,l=this.av1.z,u=this.av2.x,c=this.av2.y,p=this.av2.z,d=this.cs;;){var m,f,y,x,v,g=d.norImp,b=d.tanImp,N=d.binImp,C=-g*this.friction,P=n-t,A=o-i,S=r-e;v=P*d.tanX+A*d.tanY+S*d.tanZ+u*d.tanT2X+c*d.tanT2Y+p*d.tanT2Z-a*d.tanT1X-h*d.tanT1Y-l*d.tanT1Z,m=b,f=v*d.tanDen,b+=f,v=P*d.binX+A*d.binY+S*d.binZ+u*d.binT2X+c*d.binT2Y+p*d.binT2Z-a*d.binT1X-h*d.binT1Y-l*d.binT1Z,y=N,x=v*d.binDen,N+=x;var k=b*b+N*N;if(k>C*C&&(k=C/s.sqrt(k),b*=k,N*=k),f=b-m,x=N-y,t+=d.tanU1X*f+d.binU1X*x,i+=d.tanU1Y*f+d.binU1Y*x,e+=d.tanU1Z*f+d.binU1Z*x,a+=d.tanTU1X*f+d.binTU1X*x,h+=d.tanTU1Y*f+d.binTU1Y*x,l+=d.tanTU1Z*f+d.binTU1Z*x,n-=d.tanU2X*f+d.binU2X*x,o-=d.tanU2Y*f+d.binU2Y*x,r-=d.tanU2Z*f+d.binU2Z*x,u-=d.tanTU2X*f+d.binTU2X*x,c-=d.tanTU2Y*f+d.binTU2Y*x,p-=d.tanTU2Z*f+d.binTU2Z*x,v=(n-t)*d.norX+(o-i)*d.norY+(r-e)*d.norZ+u*d.norT2X+c*d.norT2Y+p*d.norT2Z-a*d.norT1X-h*d.norT1Y-l*d.norT1Z,m=g,f=(v-d.norTar)*d.norDen,g+=f,g>0&&(g=0),f=g-m,t+=d.norU1X*f,i+=d.norU1Y*f,e+=d.norU1Z*f,a+=d.norTU1X*f,h+=d.norTU1Y*f,l+=d.norTU1Z*f,n-=d.norU2X*f,o-=d.norU2Y*f,r-=d.norU2Z*f,u-=d.norTU2X*f,c-=d.norTU2Y*f,p-=d.norTU2Z*f,d.norImp=g,d.tanImp=b,d.binImp=N,d.last)break;d=d.next}this.lv1.x=t,this.lv1.y=i,this.lv1.z=e,this.lv2.x=n,this.lv2.y=o,this.lv2.z=r,this.av1.x=a,this.av1.y=h,this.av1.z=l,this.av2.x=u,this.av2.y=c,this.av2.z=p},s.ContactConstraint.prototype.postSolve=function(){for(var t=this.cs,i=this.num;i--;){var e=this.ps[i];e.normal.x=t.norX,e.normal.y=t.norY,e.normal.z=t.norZ,e.tangent.x=t.tanX,e.tangent.y=t.tanY,e.tangent.z=t.tanZ,e.binormal.x=t.binX,e.binormal.y=t.binY,e.binormal.z=t.binZ,e.normalImpulse=t.norImp,e.tangentImpulse=t.tanImp,e.binormalImpulse=t.binImp,e.normalDenominator=t.norDen,e.tangentDenominator=t.tanDen,e.binormalDenominator=t.binDen,t=t.next}},s.ContactLink=function(t){this.prev=null,this.next=null,this.shape=null,this.body=null,this.contact=t},s.ContactManifold=function(){this.body1=null,this.body2=null,this.numPoints=0,this.points=[],this.points.length=4,this.points[0]=new s.ManifoldPoint,this.points[1]=new s.ManifoldPoint,this.points[2]=new s.ManifoldPoint,this.points[3]=new s.ManifoldPoint},s.ContactManifold.prototype={constructor:s.ContactManifold,reset:function(t,i){this.body1=t.parent,this.body2=i.parent,this.numPoints=0},addPoint:function(t,i,e,s,n,o,r,a){var h=this.points[this.numPoints++];h.position.x=t,h.position.y=i,h.position.z=e;var l=this.body1.rotation,u=t-this.body1.position.x,c=i-this.body1.position.y,p=e-this.body1.position.z,d=l.elements;h.localPoint1.x=u*d[0]+c*d[3]+p*d[6],h.localPoint1.y=u*d[1]+c*d[4]+p*d[7],h.localPoint1.z=u*d[2]+c*d[5]+p*d[8],l=this.body2.rotation,u=t-this.body2.position.x,c=i-this.body2.position.y,p=e-this.body2.position.z,h.localPoint2.x=u*d[0]+c*d[3]+p*d[6],h.localPoint2.y=u*d[1]+c*d[4]+p*d[7],h.localPoint2.z=u*d[2]+c*d[5]+p*d[8],h.normalImpulse=0,a?(h.normal.x=-s,h.normal.y=-n,h.normal.z=-o):(h.normal.x=s,h.normal.y=n,h.normal.z=o),h.penetration=r,h.warmStarted=!1}},s.ContactPointDataBuffer=function(){this.norX=NaN,this.norY=NaN,this.norZ=NaN,this.tanX=NaN,this.tanY=NaN,this.tanZ=NaN,this.binX=NaN,this.binY=NaN,this.binZ=NaN,this.rp1X=NaN,this.rp1Y=NaN,this.rp1Z=NaN,this.rp2X=NaN,this.rp2Y=NaN,this.rp2Z=NaN,this.norU1X=NaN,this.norU1Y=NaN,this.norU1Z=NaN,this.norU2X=NaN,this.norU2Y=NaN,this.norU2Z=NaN,this.tanU1X=NaN,this.tanU1Y=NaN,this.tanU1Z=NaN,this.tanU2X=NaN,this.tanU2Y=NaN,this.tanU2Z=NaN,this.binU1X=NaN,this.binU1Y=NaN,this.binU1Z=NaN,this.binU2X=NaN,this.binU2Y=NaN,this.binU2Z=NaN,this.norT1X=NaN,this.norT1Y=NaN,this.norT1Z=NaN,this.norT2X=NaN,this.norT2Y=NaN,this.norT2Z=NaN,this.tanT1X=NaN,this.tanT1Y=NaN,this.tanT1Z=NaN,this.tanT2X=NaN,this.tanT2Y=NaN,this.tanT2Z=NaN,this.binT1X=NaN,this.binT1Y=NaN,this.binT1Z=NaN,this.binT2X=NaN,this.binT2Y=NaN,this.binT2Z=NaN,this.norTU1X=NaN,this.norTU1Y=NaN,this.norTU1Z=NaN,this.norTU2X=NaN,this.norTU2Y=NaN,this.norTU2Z=NaN,this.tanTU1X=NaN,this.tanTU1Y=NaN,this.tanTU1Z=NaN,this.tanTU2X=NaN,this.tanTU2Y=NaN,this.tanTU2Z=NaN,this.binTU1X=NaN,this.binTU1Y=NaN,this.binTU1Z=NaN,this.binTU2X=NaN,this.binTU2Y=NaN,this.binTU2Z=NaN,this.norImp=NaN,this.tanImp=NaN,this.binImp=NaN,this.norDen=NaN,this.tanDen=NaN,this.binDen=NaN,this.norTar=NaN,this.next=null,this.last=!1},s.ImpulseDataBuffer=function(){this.lp1X=NaN,this.lp1Y=NaN,this.lp1Z=NaN,this.lp2X=NaN,this.lp2Y=NaN,this.lp2Z=NaN,this.impulse=NaN},s.ManifoldPoint=function(){this.warmStarted=!1,this.position=new s.Vec3,this.localPoint1=new s.Vec3,this.localPoint2=new s.Vec3,this.normal=new s.Vec3,this.tangent=new s.Vec3,this.binormal=new s.Vec3,this.normalImpulse=0,this.tangentImpulse=0,this.binormalImpulse=0,this.normalDenominator=0,this.tangentDenominator=0,this.binormalDenominator=0,this.penetration=0},s.MassInfo=function(){this.mass=0,this.inertia=new s.Mat33},s.Shape=function(t){this.type=s.SHAPE_NULL,this.id=s.nextID++,this.prev=null,this.next=null,this.proxy=null,this.parent=null,this.contactLink=null,this.numContacts=0,this.position=new s.Vec3,this.rotation=new s.Mat33,this.relativePosition=(new s.Vec3).copy(t.relativePosition),this.relativeRotation=(new s.Mat33).copy(t.relativeRotation),this.aabb=new s.AABB,this.density=t.density,this.friction=t.friction,this.restitution=t.restitution,this.belongsTo=t.belongsTo,this.collidesWith=t.collidesWith},s.Shape.prototype={constructor:s.Shape,calculateMassInfo:function(t){s.Error("Shape","Inheritance error.")},updateProxy:function(){s.Error("Shape","Inheritance error.")}},s.ShapeConfig=function(){this.relativePosition=new s.Vec3,this.relativeRotation=new s.Mat33,this.friction=.4,this.restitution=.2,this.density=1,this.belongsTo=1,this.collidesWith=4294967295},s.BoxShape=function(t,i,n,o){s.Shape.call(this,t),this.type=s.SHAPE_BOX,this.width=i,this.height=n,this.depth=o,this.halfWidth=.5*i,this.halfHeight=.5*n,this.halfDepth=.5*o,this.dimentions=new e(18),this.elements=new e(24)},s.BoxShape.prototype=Object.create(s.Shape.prototype),s.BoxShape.prototype.constructor=s.BoxShape,s.BoxShape.prototype.calculateMassInfo=function(t){var i=this.width*this.height*this.depth*this.density,e=1/12;t.mass=i,t.inertia.set(i*(this.height*this.height+this.depth*this.depth)*e,0,0,0,i*(this.width*this.width+this.depth*this.depth)*e,0,0,0,i*(this.width*this.width+this.height*this.height)*e)},s.BoxShape.prototype.updateProxy=function(){var t=this.rotation.elements,i=this.dimentions;i[0]=t[0],i[1]=t[3],i[2]=t[6],i[3]=t[1],i[4]=t[4],i[5]=t[7],i[6]=t[2],i[7]=t[5],i[8]=t[8],i[9]=t[0]*this.halfWidth,i[10]=t[3]*this.halfWidth,i[11]=t[6]*this.halfWidth,i[12]=t[1]*this.halfHeight,i[13]=t[4]*this.halfHeight,i[14]=t[7]*this.halfHeight,i[15]=t[2]*this.halfDepth,i[16]=t[5]*this.halfDepth,i[17]=t[8]*this.halfDepth;var e=i[9],n=i[10],o=i[11],r=i[12],a=i[13],h=i[14],l=i[15],u=i[16],c=i[17],p=this.position.x,d=this.position.y,m=this.position.z,f=this.elements;f[0]=p+e+r+l,f[1]=d+n+a+u,f[2]=m+o+h+c,f[3]=p+e+r-l,f[4]=d+n+a-u,f[5]=m+o+h-c,f[6]=p+e-r+l,f[7]=d+n-a+u,f[8]=m+o-h+c,f[9]=p+e-r-l,f[10]=d+n-a-u,f[11]=m+o-h-c,f[12]=p-e+r+l,f[13]=d-n+a+u,f[14]=m-o+h+c,f[15]=p-e+r-l,f[16]=d-n+a-u,f[17]=m-o+h-c,f[18]=p-e-r+l,f[19]=d-n-a+u,f[20]=m-o-h+c,f[21]=p-e-r-l,f[22]=d-n-a-u,f[23]=m-o-h-c;var y=i[9]<0?-i[9]:i[9],x=i[10]<0?-i[10]:i[10],v=i[11]<0?-i[11]:i[11];y=i[12]<0?y-i[12]:y+i[12],x=i[13]<0?x-i[13]:x+i[13],v=i[14]<0?v-i[14]:v+i[14],y=i[15]<0?y-i[15]:y+i[15],x=i[16]<0?x-i[16]:x+i[16],v=i[17]<0?v-i[17]:v+i[17];var g=s.AABB_PROX;this.aabb.set(this.position.x-y-g,this.position.x+y+g,this.position.y-x-g,this.position.y+x+g,this.position.z-v-g,this.position.z+v+g),null!=this.proxy&&this.proxy.update()},s.SphereShape=function(t,i){s.Shape.call(this,t),this.type=s.SHAPE_SPHERE,this.radius=i},s.SphereShape.prototype=Object.create(s.Shape.prototype),s.SphereShape.prototype.constructor=s.SphereShape,s.SphereShape.prototype.calculateMassInfo=function(t){var i=1.333*s.PI*this.radius*this.radius*this.radius*this.density;t.mass=i;var e=i*this.radius*this.radius*.4;t.inertia.set(e,0,0,0,e,0,0,0,e)},s.SphereShape.prototype.updateProxy=function(){var t=s.AABB_PROX;this.aabb.set(this.position.x-this.radius-t,this.position.x+this.radius+t,this.position.y-this.radius-t,this.position.y+this.radius+t,this.position.z-this.radius-t,this.position.z+this.radius+t),null!=this.proxy&&this.proxy.update()},s.CylinderShape=function(t,i,e){s.Shape.call(this,t),this.type=s.SHAPE_CYLINDER,this.radius=i,this.height=e,this.halfHeight=.5*e,this.normalDirection=new s.Vec3,this.halfDirection=new s.Vec3},s.CylinderShape.prototype=Object.create(s.Shape.prototype),s.CylinderShape.prototype.constructor=s.CylinderShape,s.CylinderShape.prototype.calculateMassInfo=function(t){var i=this.radius*this.radius,e=s.PI*i*this.height*this.density,n=(.25*i+.0833*this.height*this.height)*e,o=.5*i;t.mass=e,t.inertia.set(n,0,0,0,o,0,0,0,n)},s.CylinderShape.prototype.updateProxy=function(){var t,i,e,n,o,r,a,h,l,u,c,p=this.rotation.elements;o=p[1]*p[1],r=p[4]*p[4],a=p[7]*p[7],this.normalDirection.set(p[1],p[4],p[7]),this.halfDirection.scale(this.normalDirection,this.halfHeight),i=1-o,t=s.sqrt(i*i+o*r+o*a),t>0&&(t=this.radius/t),i*=t,e=1-r,t=s.sqrt(r*o+e*e+r*a),t>0&&(t=this.radius/t),e*=t,n=1-a,t=s.sqrt(a*o+a*r+n*n),t>0&&(t=this.radius/t),n*=t,h=this.halfDirection.x<0?-this.halfDirection.x:this.halfDirection.x,l=this.halfDirection.y<0?-this.halfDirection.y:this.halfDirection.y,
u=this.halfDirection.z<0?-this.halfDirection.z:this.halfDirection.z,h=0>i?h-i:h+i,l=0>e?l-e:l+e,u=0>n?u-n:u+n,c=s.AABB_PROX,this.aabb.set(this.position.x-h-c,this.position.x+h+c,this.position.y-l-c,this.position.y+l+c,this.position.z-u-c,this.position.z+u+c),null!=this.proxy&&this.proxy.update()},s.CollisionDetector=function(){this.flip=!1},s.CollisionDetector.prototype={constructor:s.CollisionDetector,detectCollision:function(t,i,e){s.Error("CollisionDetector","Inheritance error.")}},s.BoxBoxCollisionDetector=function(){s.CollisionDetector.call(this),this.clipVertices1=new e(24),this.clipVertices2=new e(24),this.used=new e(8),this.INF=1/0},s.BoxBoxCollisionDetector.prototype=Object.create(s.CollisionDetector.prototype),s.BoxBoxCollisionDetector.prototype.constructor=s.BoxBoxCollisionDetector,s.BoxBoxCollisionDetector.prototype.detectCollision=function(t,i,e){var n,o;t.id<i.id?(n=t,o=i):(n=i,o=t);var r,a,h,l,u,c,p,d,m,f,y,x,v,g,b,N,C,P,A,S,k,I,z,_,M,E,w,D,T,L,R,O,V,B,U,F,j=n.elements,Y=o.elements,X=n.dimentions,W=o.dimentions,Z=n.position,q=o.position,H=Z.x,J=Z.y,K=Z.z,Q=q.x,G=q.y,$=q.z,tt=Q-H,it=G-J,et=$-K,st=n.halfWidth,nt=n.halfHeight,ot=n.halfDepth,rt=o.halfWidth,at=o.halfHeight,ht=o.halfDepth,lt=X[0],ut=X[1],ct=X[2],pt=X[3],dt=X[4],mt=X[5],ft=X[6],yt=X[7],xt=X[8],vt=X[9],gt=X[10],bt=X[11],Nt=X[12],Ct=X[13],Pt=X[14],At=X[15],St=X[16],kt=X[17],It=W[0],zt=W[1],_t=W[2],Mt=W[3],Et=W[4],wt=W[5],Dt=W[6],Tt=W[7],Lt=W[8],Rt=W[9],Ot=W[10],Vt=W[11],Bt=W[12],Ut=W[13],Ft=W[14],jt=W[15],Yt=W[16],Xt=W[17],Wt=ut*_t-ct*zt,Zt=ct*It-lt*_t,qt=lt*zt-ut*It,Ht=ut*wt-ct*Et,Jt=ct*Mt-lt*wt,Kt=lt*Et-ut*Mt,Qt=ut*Lt-ct*Tt,Gt=ct*Dt-lt*Lt,$t=lt*Tt-ut*Dt,ti=dt*_t-mt*zt,ii=mt*It-pt*_t,ei=pt*zt-dt*It,si=dt*wt-mt*Et,ni=mt*Mt-pt*wt,oi=pt*Et-dt*Mt,ri=dt*Lt-mt*Tt,ai=mt*Dt-pt*Lt,hi=pt*Tt-dt*Dt,li=yt*_t-xt*zt,ui=xt*It-ft*_t,ci=ft*zt-yt*It,pi=yt*wt-xt*Et,di=xt*Mt-ft*wt,mi=ft*Et-yt*Mt,fi=yt*Lt-xt*Tt,yi=xt*Dt-ft*Lt,xi=ft*Tt-yt*Dt,vi=!1,gi=!1,bi=!1,Ni=!1,Ci=!1,Pi=!1,Ai=!1,Si=!1,ki=!1;if(R=lt*tt+ut*it+ct*et,r=R>0,r||(R=-R),O=st,B=lt*It+ut*zt+ct*_t,U=lt*Mt+ut*Et+ct*wt,F=lt*Dt+ut*Tt+ct*Lt,0>B&&(B=-B),0>U&&(U=-U),0>F&&(F=-F),V=B*rt+U*at+F*ht,N=R-O-V,!(N>0||(R=pt*tt+dt*it+mt*et,a=R>0,a||(R=-R),O=nt,B=pt*It+dt*zt+mt*_t,U=pt*Mt+dt*Et+mt*wt,F=pt*Dt+dt*Tt+mt*Lt,0>B&&(B=-B),0>U&&(U=-U),0>F&&(F=-F),V=B*rt+U*at+F*ht,C=R-O-V,C>0||(R=ft*tt+yt*it+xt*et,h=R>0,h||(R=-R),O=ot,B=ft*It+yt*zt+xt*_t,U=ft*Mt+yt*Et+xt*wt,F=ft*Dt+yt*Tt+xt*Lt,0>B&&(B=-B),0>U&&(U=-U),0>F&&(F=-F),V=B*rt+U*at+F*ht,P=R-O-V,P>0||(R=It*tt+zt*it+_t*et,l=R>0,l||(R=-R),B=It*lt+zt*ut+_t*ct,U=It*pt+zt*dt+_t*mt,F=It*ft+zt*yt+_t*xt,0>B&&(B=-B),0>U&&(U=-U),0>F&&(F=-F),O=B*st+U*nt+F*ot,V=rt,A=1*(R-O-V),A>0||(R=Mt*tt+Et*it+wt*et,u=R>0,u||(R=-R),B=Mt*lt+Et*ut+wt*ct,U=Mt*pt+Et*dt+wt*mt,F=Mt*ft+Et*yt+wt*xt,0>B&&(B=-B),0>U&&(U=-U),0>F&&(F=-F),O=B*st+U*nt+F*ot,V=at,S=1*(R-O-V),S>0||(R=Dt*tt+Tt*it+Lt*et,c=R>0,c||(R=-R),B=Dt*lt+Tt*ut+Lt*ct,U=Dt*pt+Tt*dt+Lt*mt,F=Dt*ft+Tt*yt+Lt*xt,0>B&&(B=-B),0>U&&(U=-U),0>F&&(F=-F),O=B*st+U*nt+F*ot,V=ht,k=1*(R-O-V),k>0))))))){if(R=Wt*Wt+Zt*Zt+qt*qt,R>1e-5){if(R=1/s.sqrt(R),Wt*=R,Zt*=R,qt*=R,R=Wt*tt+Zt*it+qt*et,p=R>0,p||(R=-R),B=Wt*pt+Zt*dt+qt*mt,U=Wt*ft+Zt*yt+qt*xt,0>B&&(B=-B),0>U&&(U=-U),O=B*nt+U*ot,B=Wt*Mt+Zt*Et+qt*wt,U=Wt*Dt+Zt*Tt+qt*Lt,0>B&&(B=-B),0>U&&(U=-U),V=B*at+U*ht,I=R-O-V,I>0)return}else p=!1,I=0,vi=!0;if(R=Ht*Ht+Jt*Jt+Kt*Kt,R>1e-5){if(R=1/s.sqrt(R),Ht*=R,Jt*=R,Kt*=R,R=Ht*tt+Jt*it+Kt*et,d=R>0,d||(R=-R),B=Ht*pt+Jt*dt+Kt*mt,U=Ht*ft+Jt*yt+Kt*xt,0>B&&(B=-B),0>U&&(U=-U),O=B*nt+U*ot,B=Ht*It+Jt*zt+Kt*_t,U=Ht*Dt+Jt*Tt+Kt*Lt,0>B&&(B=-B),0>U&&(U=-U),V=B*rt+U*ht,z=R-O-V,z>0)return}else d=!1,z=0,gi=!0;if(R=Qt*Qt+Gt*Gt+$t*$t,R>1e-5){if(R=1/s.sqrt(R),Qt*=R,Gt*=R,$t*=R,R=Qt*tt+Gt*it+$t*et,m=R>0,m||(R=-R),B=Qt*pt+Gt*dt+$t*mt,U=Qt*ft+Gt*yt+$t*xt,0>B&&(B=-B),0>U&&(U=-U),O=B*nt+U*ot,B=Qt*It+Gt*zt+$t*_t,U=Qt*Mt+Gt*Et+$t*wt,0>B&&(B=-B),0>U&&(U=-U),V=B*rt+U*at,_=R-O-V,_>0)return}else m=!1,_=0,bi=!0;if(R=ti*ti+ii*ii+ei*ei,R>1e-5){if(R=1/s.sqrt(R),ti*=R,ii*=R,ei*=R,R=ti*tt+ii*it+ei*et,f=R>0,f||(R=-R),B=ti*lt+ii*ut+ei*ct,U=ti*ft+ii*yt+ei*xt,0>B&&(B=-B),0>U&&(U=-U),O=B*st+U*ot,B=ti*Mt+ii*Et+ei*wt,U=ti*Dt+ii*Tt+ei*Lt,0>B&&(B=-B),0>U&&(U=-U),V=B*at+U*ht,M=R-O-V,M>0)return}else f=!1,M=0,Ni=!0;if(R=si*si+ni*ni+oi*oi,R>1e-5){if(R=1/s.sqrt(R),si*=R,ni*=R,oi*=R,R=si*tt+ni*it+oi*et,y=R>0,y||(R=-R),B=si*lt+ni*ut+oi*ct,U=si*ft+ni*yt+oi*xt,0>B&&(B=-B),0>U&&(U=-U),O=B*st+U*ot,B=si*It+ni*zt+oi*_t,U=si*Dt+ni*Tt+oi*Lt,0>B&&(B=-B),0>U&&(U=-U),V=B*rt+U*ht,E=R-O-V,E>0)return}else y=!1,E=0,Ci=!0;if(R=ri*ri+ai*ai+hi*hi,R>1e-5){if(R=1/s.sqrt(R),ri*=R,ai*=R,hi*=R,R=ri*tt+ai*it+hi*et,x=R>0,x||(R=-R),B=ri*lt+ai*ut+hi*ct,U=ri*ft+ai*yt+hi*xt,0>B&&(B=-B),0>U&&(U=-U),O=B*st+U*ot,B=ri*It+ai*zt+hi*_t,U=ri*Mt+ai*Et+hi*wt,0>B&&(B=-B),0>U&&(U=-U),V=B*rt+U*at,w=R-O-V,w>0)return}else x=!1,w=0,Pi=!0;if(R=li*li+ui*ui+ci*ci,R>1e-5){if(R=1/s.sqrt(R),li*=R,ui*=R,ci*=R,R=li*tt+ui*it+ci*et,v=R>0,v||(R=-R),B=li*lt+ui*ut+ci*ct,U=li*pt+ui*dt+ci*mt,0>B&&(B=-B),0>U&&(U=-U),O=B*st+U*nt,B=li*Mt+ui*Et+ci*wt,U=li*Dt+ui*Tt+ci*Lt,0>B&&(B=-B),0>U&&(U=-U),V=B*at+U*ht,D=R-O-V,D>0)return}else v=!1,D=0,Ai=!0;if(R=pi*pi+di*di+mi*mi,R>1e-5){if(R=1/s.sqrt(R),pi*=R,di*=R,mi*=R,R=pi*tt+di*it+mi*et,g=R>0,g||(R=-R),B=pi*lt+di*ut+mi*ct,U=pi*pt+di*dt+mi*mt,0>B&&(B=-B),0>U&&(U=-U),O=B*st+U*nt,B=pi*It+di*zt+mi*_t,U=pi*Dt+di*Tt+mi*Lt,0>B&&(B=-B),0>U&&(U=-U),V=B*rt+U*ht,T=R-O-V,T>0)return}else g=!1,T=0,Si=!0;if(R=fi*fi+yi*yi+xi*xi,R>1e-5){if(R=1/s.sqrt(R),fi*=R,yi*=R,xi*=R,R=fi*tt+yi*it+xi*et,b=R>0,b||(R=-R),B=fi*lt+yi*ut+xi*ct,U=fi*pt+yi*dt+xi*mt,0>B&&(B=-B),0>U&&(U=-U),O=B*st+U*nt,B=fi*It+yi*zt+xi*_t,U=fi*Mt+yi*Et+xi*wt,0>B&&(B=-B),0>U&&(U=-U),V=B*rt+U*at,L=R-O-V,L>0)return}else b=!1,L=0,ki=!0;var Ii=N,zi=N,_i=0,Mi=r;C>zi&&(Ii=C,zi=C,_i=1,Mi=a),P>zi&&(Ii=P,zi=P,_i=2,Mi=h),A>zi&&(Ii=A,zi=A,_i=3,Mi=l),S>zi&&(Ii=S,zi=S,_i=4,Mi=u),k>zi&&(Ii=k,zi=k,_i=5,Mi=c),I-.01>zi&&!vi&&(Ii=I,zi=I-.01,_i=6,Mi=p),z-.01>zi&&!gi&&(Ii=z,zi=z-.01,_i=7,Mi=d),_-.01>zi&&!bi&&(Ii=_,zi=_-.01,_i=8,Mi=m),M-.01>zi&&!Ni&&(Ii=M,zi=M-.01,_i=9,Mi=f),E-.01>zi&&!Ci&&(Ii=E,zi=E-.01,_i=10,Mi=y),w-.01>zi&&!Pi&&(Ii=w,zi=w-.01,_i=11,Mi=x),D-.01>zi&&!Ai&&(Ii=D,zi=D-.01,_i=12,Mi=v),T-.01>zi&&!Si&&(Ii=T,zi=T-.01,_i=13,Mi=g),L-.01>zi&&!ki&&(Ii=L,_i=14,Mi=b);var Ei=0,wi=0,Di=0,Ti=0,Li=0,Ri=0,Oi=0,Vi=0,Bi=0,Ui=0,Fi=0,ji=0,Yi=0,Xi=0,Wi=0,Zi=0,qi=0,Hi=0,Ji=!1;0==_i?(Mi?(Ui=H+vt,Fi=J+gt,ji=K+bt,Ei=lt,wi=ut,Di=ct):(Ui=H-vt,Fi=J-gt,ji=K-bt,Ei=-lt,wi=-ut,Di=-ct),Yi=Nt,Xi=Ct,Wi=Pt,Ti=-pt,Li=-dt,Ri=-mt,Zi=At,qi=St,Hi=kt,Oi=-ft,Vi=-yt,Bi=-xt):1==_i?(Mi?(Ui=H+Nt,Fi=J+Ct,ji=K+Pt,Ei=pt,wi=dt,Di=mt):(Ui=H-Nt,Fi=J-Ct,ji=K-Pt,Ei=-pt,wi=-dt,Di=-mt),Yi=vt,Xi=gt,Wi=bt,Ti=-lt,Li=-ut,Ri=-ct,Zi=At,qi=St,Hi=kt,Oi=-ft,Vi=-yt,Bi=-xt):2==_i?(Mi?(Ui=H+At,Fi=J+St,ji=K+kt,Ei=ft,wi=yt,Di=xt):(Ui=H-At,Fi=J-St,ji=K-kt,Ei=-ft,wi=-yt,Di=-xt),Yi=vt,Xi=gt,Wi=bt,Ti=-lt,Li=-ut,Ri=-ct,Zi=Nt,qi=Ct,Hi=Pt,Oi=-pt,Vi=-dt,Bi=-mt):3==_i?(Ji=!0,Mi?(Ui=Q-Rt,Fi=G-Ot,ji=$-Vt,Ei=-It,wi=-zt,Di=-_t):(Ui=Q+Rt,Fi=G+Ot,ji=$+Vt,Ei=It,wi=zt,Di=_t),Yi=Bt,Xi=Ut,Wi=Ft,Ti=-Mt,Li=-Et,Ri=-wt,Zi=jt,qi=Yt,Hi=Xt,Oi=-Dt,Vi=-Tt,Bi=-Lt):4==_i?(Ji=!0,Mi?(Ui=Q-Bt,Fi=G-Ut,ji=$-Ft,Ei=-Mt,wi=-Et,Di=-wt):(Ui=Q+Bt,Fi=G+Ut,ji=$+Ft,Ei=Mt,wi=Et,Di=wt),Yi=Rt,Xi=Ot,Wi=Vt,Ti=-It,Li=-zt,Ri=-_t,Zi=jt,qi=Yt,Hi=Xt,Oi=-Dt,Vi=-Tt,Bi=-Lt):5==_i?(Ji=!0,Mi?(Ui=Q-jt,Fi=G-Yt,ji=$-Xt,Ei=-Dt,wi=-Tt,Di=-Lt):(Ui=Q+jt,Fi=G+Yt,ji=$+Xt,Ei=Dt,wi=Tt,Di=Lt),Yi=Rt,Xi=Ot,Wi=Vt,Ti=-It,Li=-zt,Ri=-_t,Zi=Bt,qi=Ut,Hi=Ft,Oi=-Mt,Vi=-Et,Bi=-wt):6==_i?(Ei=Wt,wi=Zt,Di=qt,Ti=lt,Li=ut,Ri=ct,Oi=It,Vi=zt,Bi=_t):7==_i?(Ei=Ht,wi=Jt,Di=Kt,Ti=lt,Li=ut,Ri=ct,Oi=Mt,Vi=Et,Bi=wt):8==_i?(Ei=Qt,wi=Gt,Di=$t,Ti=lt,Li=ut,Ri=ct,Oi=Dt,Vi=Tt,Bi=Lt):9==_i?(Ei=ti,wi=ii,Di=ei,Ti=pt,Li=dt,Ri=mt,Oi=It,Vi=zt,Bi=_t):10==_i?(Ei=si,wi=ni,Di=oi,Ti=pt,Li=dt,Ri=mt,Oi=Mt,Vi=Et,Bi=wt):11==_i?(Ei=ri,wi=ai,Di=hi,Ti=pt,Li=dt,Ri=mt,Oi=Dt,Vi=Tt,Bi=Lt):12==_i?(Ei=li,wi=ui,Di=ci,Ti=ft,Li=yt,Ri=xt,Oi=It,Vi=zt,Bi=_t):13==_i?(Ei=pi,wi=di,Di=mi,Ti=ft,Li=yt,Ri=xt,Oi=Mt,Vi=Et,Bi=wt):14==_i&&(Ei=fi,wi=yi,Di=xi,Ti=ft,Li=yt,Ri=xt,Oi=Dt,Vi=Tt,Bi=Lt);if(_i>5){Mi||(Ei=-Ei,wi=-wi,Di=-Di);var Ki,Qi,Gi,$i,te,ie,ee,se,ne,oe,re;ie=j[0],ee=j[1],se=j[2],Qi=Ei*ie+wi*ee+Di*se,Gi=j[3],$i=j[4],te=j[5],Ki=Ei*Gi+wi*$i+Di*te,Ki>Qi&&(Qi=Ki,ie=Gi,ee=$i,se=te),Gi=j[6],$i=j[7],te=j[8],Ki=Ei*Gi+wi*$i+Di*te,Ki>Qi&&(Qi=Ki,ie=Gi,ee=$i,se=te),Gi=j[9],$i=j[10],te=j[11],Ki=Ei*Gi+wi*$i+Di*te,Ki>Qi&&(Qi=Ki,ie=Gi,ee=$i,se=te),Gi=j[12],$i=j[13],te=j[14],Ki=Ei*Gi+wi*$i+Di*te,Ki>Qi&&(Qi=Ki,ie=Gi,ee=$i,se=te),Gi=j[15],$i=j[16],te=j[17],Ki=Ei*Gi+wi*$i+Di*te,Ki>Qi&&(Qi=Ki,ie=Gi,ee=$i,se=te),Gi=j[18],$i=j[19],te=j[20],Ki=Ei*Gi+wi*$i+Di*te,Ki>Qi&&(Qi=Ki,ie=Gi,ee=$i,se=te),Gi=j[21],$i=j[22],te=j[23],Ki=Ei*Gi+wi*$i+Di*te,Ki>Qi&&(Qi=Ki,ie=Gi,ee=$i,se=te),ne=Y[0],oe=Y[1],re=Y[2],Qi=Ei*ne+wi*oe+Di*re,Gi=Y[3],$i=Y[4],te=Y[5],Ki=Ei*Gi+wi*$i+Di*te,Qi>Ki&&(Qi=Ki,ne=Gi,oe=$i,re=te),Gi=Y[6],$i=Y[7],te=Y[8],Ki=Ei*Gi+wi*$i+Di*te,Qi>Ki&&(Qi=Ki,ne=Gi,oe=$i,re=te),Gi=Y[9],$i=Y[10],te=Y[11],Ki=Ei*Gi+wi*$i+Di*te,Qi>Ki&&(Qi=Ki,ne=Gi,oe=$i,re=te),Gi=Y[12],$i=Y[13],te=Y[14],Ki=Ei*Gi+wi*$i+Di*te,Qi>Ki&&(Qi=Ki,ne=Gi,oe=$i,re=te),Gi=Y[15],$i=Y[16],te=Y[17],Ki=Ei*Gi+wi*$i+Di*te,Qi>Ki&&(Qi=Ki,ne=Gi,oe=$i,re=te),Gi=Y[18],$i=Y[19],te=Y[20],Ki=Ei*Gi+wi*$i+Di*te,Qi>Ki&&(Qi=Ki,ne=Gi,oe=$i,re=te),Gi=Y[21],$i=Y[22],te=Y[23],Ki=Ei*Gi+wi*$i+Di*te,Qi>Ki&&(Qi=Ki,ne=Gi,oe=$i,re=te),Gi=ne-ie,$i=oe-ee,te=re-se,B=Ti*Oi+Li*Vi+Ri*Bi;var ae=(Gi*(Ti-Oi*B)+$i*(Li-Vi*B)+te*(Ri-Bi*B))/(1-B*B);return void e.addPoint(ie+Ti*ae+Ei*Ii*.5,ee+Li*ae+wi*Ii*.5,se+Ri*ae+Di*Ii*.5,Ei,wi,Di,Ii,!1)}var he,le,ue,ce,pe,de,me,fe,ye,xe,ve,ge,be=1,Ne=0,Ce=0;Ji?(Ne=lt*Ei+ut*wi+ct*Di,be>Ne&&(be=Ne,Ce=0),be>-Ne&&(be=-Ne,Ce=1),Ne=pt*Ei+dt*wi+mt*Di,be>Ne&&(be=Ne,Ce=2),be>-Ne&&(be=-Ne,Ce=3),Ne=ft*Ei+yt*wi+xt*Di,be>Ne&&(be=Ne,Ce=4),be>-Ne&&(be=-Ne,Ce=5),0==Ce?(he=j[0],le=j[1],ue=j[2],ce=j[6],pe=j[7],de=j[8],me=j[9],fe=j[10],ye=j[11],xe=j[3],ve=j[4],ge=j[5]):1==Ce?(he=j[15],le=j[16],ue=j[17],ce=j[21],pe=j[22],de=j[23],me=j[18],fe=j[19],ye=j[20],xe=j[12],ve=j[13],ge=j[14]):2==Ce?(he=j[12],le=j[13],ue=j[14],ce=j[0],pe=j[1],de=j[2],me=j[3],fe=j[4],ye=j[5],xe=j[15],ve=j[16],ge=j[17]):3==Ce?(he=j[21],le=j[22],ue=j[23],ce=j[9],pe=j[10],de=j[11],me=j[6],fe=j[7],ye=j[8],xe=j[18],ve=j[19],ge=j[20]):4==Ce?(he=j[12],le=j[13],ue=j[14],ce=j[18],pe=j[19],de=j[20],me=j[6],fe=j[7],ye=j[8],xe=j[0],ve=j[1],ge=j[2]):5==Ce&&(he=j[3],le=j[4],ue=j[5],ce=j[6],pe=j[7],de=j[8],me=j[21],fe=j[22],ye=j[23],xe=j[15],ve=j[16],ge=j[17])):(Ne=It*Ei+zt*wi+_t*Di,be>Ne&&(be=Ne,Ce=0),be>-Ne&&(be=-Ne,Ce=1),Ne=Mt*Ei+Et*wi+wt*Di,be>Ne&&(be=Ne,Ce=2),be>-Ne&&(be=-Ne,Ce=3),Ne=Dt*Ei+Tt*wi+Lt*Di,be>Ne&&(be=Ne,Ce=4),be>-Ne&&(be=-Ne,Ce=5),0==Ce?(he=Y[0],le=Y[1],ue=Y[2],ce=Y[6],pe=Y[7],de=Y[8],me=Y[9],fe=Y[10],ye=Y[11],xe=Y[3],ve=Y[4],ge=Y[5]):1==Ce?(he=Y[15],le=Y[16],ue=Y[17],ce=Y[21],pe=Y[22],de=Y[23],me=Y[18],fe=Y[19],ye=Y[20],xe=Y[12],ve=Y[13],ge=Y[14]):2==Ce?(he=Y[12],le=Y[13],ue=Y[14],ce=Y[0],pe=Y[1],de=Y[2],me=Y[3],fe=Y[4],ye=Y[5],xe=Y[15],ve=Y[16],ge=Y[17]):3==Ce?(he=Y[21],le=Y[22],ue=Y[23],ce=Y[9],pe=Y[10],de=Y[11],me=Y[6],fe=Y[7],ye=Y[8],xe=Y[18],ve=Y[19],ge=Y[20]):4==Ce?(he=Y[12],le=Y[13],ue=Y[14],ce=Y[18],pe=Y[19],de=Y[20],me=Y[6],fe=Y[7],ye=Y[8],xe=Y[0],ve=Y[1],ge=Y[2]):5==Ce&&(he=Y[3],le=Y[4],ue=Y[5],ce=Y[9],pe=Y[10],de=Y[11],me=Y[21],fe=Y[22],ye=Y[23],xe=Y[15],ve=Y[16],ge=Y[17]));var Pe,Ae,Se,ke,Ie,ze,_e,Me,Ee;this.clipVertices1[0]=he,this.clipVertices1[1]=le,this.clipVertices1[2]=ue,this.clipVertices1[3]=ce,this.clipVertices1[4]=pe,this.clipVertices1[5]=de,this.clipVertices1[6]=me,this.clipVertices1[7]=fe,this.clipVertices1[8]=ye,this.clipVertices1[9]=xe,this.clipVertices1[10]=ve,this.clipVertices1[11]=ge,Ae=0,ke=this.clipVertices1[9],Ie=this.clipVertices1[10],ze=this.clipVertices1[11],B=(ke-Ui-Yi)*Ti+(Ie-Fi-Xi)*Li+(ze-ji-Wi)*Ri;for(var we=0;4>we;we++)Se=3*we,_e=this.clipVertices1[Se],Me=this.clipVertices1[Se+1],Ee=this.clipVertices1[Se+2],U=(_e-Ui-Yi)*Ti+(Me-Fi-Xi)*Li+(Ee-ji-Wi)*Ri,B>0?U>0?(Se=3*Ae,Ae++,this.clipVertices2[Se]=_e,this.clipVertices2[Se+1]=Me,this.clipVertices2[Se+2]=Ee):(Se=3*Ae,Ae++,ae=B/(B-U),this.clipVertices2[Se]=ke+(_e-ke)*ae,this.clipVertices2[Se+1]=Ie+(Me-Ie)*ae,this.clipVertices2[Se+2]=ze+(Ee-ze)*ae):U>0&&(Se=3*Ae,Ae++,ae=B/(B-U),this.clipVertices2[Se]=ke+(_e-ke)*ae,this.clipVertices2[Se+1]=Ie+(Me-Ie)*ae,this.clipVertices2[Se+2]=ze+(Ee-ze)*ae,Se=3*Ae,Ae++,this.clipVertices2[Se]=_e,this.clipVertices2[Se+1]=Me,this.clipVertices2[Se+2]=Ee),ke=_e,Ie=Me,ze=Ee,B=U;if(Pe=Ae,0!=Pe){for(Ae=0,Se=3*(Pe-1),ke=this.clipVertices2[Se],Ie=this.clipVertices2[Se+1],ze=this.clipVertices2[Se+2],B=(ke-Ui-Zi)*Oi+(Ie-Fi-qi)*Vi+(ze-ji-Hi)*Bi,we=0;Pe>we;we++)Se=3*we,_e=this.clipVertices2[Se],Me=this.clipVertices2[Se+1],Ee=this.clipVertices2[Se+2],U=(_e-Ui-Zi)*Oi+(Me-Fi-qi)*Vi+(Ee-ji-Hi)*Bi,B>0?U>0?(Se=3*Ae,Ae++,this.clipVertices1[Se]=_e,this.clipVertices1[Se+1]=Me,this.clipVertices1[Se+2]=Ee):(Se=3*Ae,Ae++,ae=B/(B-U),this.clipVertices1[Se]=ke+(_e-ke)*ae,this.clipVertices1[Se+1]=Ie+(Me-Ie)*ae,this.clipVertices1[Se+2]=ze+(Ee-ze)*ae):U>0&&(Se=3*Ae,Ae++,ae=B/(B-U),this.clipVertices1[Se]=ke+(_e-ke)*ae,this.clipVertices1[Se+1]=Ie+(Me-Ie)*ae,this.clipVertices1[Se+2]=ze+(Ee-ze)*ae,Se=3*Ae,Ae++,this.clipVertices1[Se]=_e,this.clipVertices1[Se+1]=Me,this.clipVertices1[Se+2]=Ee),ke=_e,Ie=Me,ze=Ee,B=U;if(Pe=Ae,0!=Pe){for(Ae=0,Se=3*(Pe-1),ke=this.clipVertices1[Se],Ie=this.clipVertices1[Se+1],ze=this.clipVertices1[Se+2],B=(ke-Ui+Yi)*-Ti+(Ie-Fi+Xi)*-Li+(ze-ji+Wi)*-Ri,we=0;Pe>we;we++)Se=3*we,_e=this.clipVertices1[Se],Me=this.clipVertices1[Se+1],Ee=this.clipVertices1[Se+2],U=(_e-Ui+Yi)*-Ti+(Me-Fi+Xi)*-Li+(Ee-ji+Wi)*-Ri,B>0?U>0?(Se=3*Ae,Ae++,this.clipVertices2[Se]=_e,this.clipVertices2[Se+1]=Me,this.clipVertices2[Se+2]=Ee):(Se=3*Ae,Ae++,ae=B/(B-U),this.clipVertices2[Se]=ke+(_e-ke)*ae,this.clipVertices2[Se+1]=Ie+(Me-Ie)*ae,this.clipVertices2[Se+2]=ze+(Ee-ze)*ae):U>0&&(Se=3*Ae,Ae++,ae=B/(B-U),this.clipVertices2[Se]=ke+(_e-ke)*ae,this.clipVertices2[Se+1]=Ie+(Me-Ie)*ae,this.clipVertices2[Se+2]=ze+(Ee-ze)*ae,Se=3*Ae,Ae++,this.clipVertices2[Se]=_e,this.clipVertices2[Se+1]=Me,this.clipVertices2[Se+2]=Ee),ke=_e,Ie=Me,ze=Ee,B=U;if(Pe=Ae,0!=Pe){for(Ae=0,Se=3*(Pe-1),ke=this.clipVertices2[Se],Ie=this.clipVertices2[Se+1],ze=this.clipVertices2[Se+2],B=(ke-Ui+Zi)*-Oi+(Ie-Fi+qi)*-Vi+(ze-ji+Hi)*-Bi,we=0;Pe>we;we++)Se=3*we,_e=this.clipVertices2[Se],Me=this.clipVertices2[Se+1],Ee=this.clipVertices2[Se+2],U=(_e-Ui+Zi)*-Oi+(Me-Fi+qi)*-Vi+(Ee-ji+Hi)*-Bi,B>0?U>0?(Se=3*Ae,Ae++,this.clipVertices1[Se]=_e,this.clipVertices1[Se+1]=Me,this.clipVertices1[Se+2]=Ee):(Se=3*Ae,Ae++,ae=B/(B-U),this.clipVertices1[Se]=ke+(_e-ke)*ae,this.clipVertices1[Se+1]=Ie+(Me-Ie)*ae,this.clipVertices1[Se+2]=ze+(Ee-ze)*ae):U>0&&(Se=3*Ae,Ae++,ae=B/(B-U),this.clipVertices1[Se]=ke+(_e-ke)*ae,this.clipVertices1[Se+1]=Ie+(Me-Ie)*ae,this.clipVertices1[Se+2]=ze+(Ee-ze)*ae,Se=3*Ae,Ae++,this.clipVertices1[Se]=_e,this.clipVertices1[Se+1]=Me,this.clipVertices1[Se+2]=Ee),ke=_e,Ie=Me,ze=Ee,B=U;if(Pe=Ae,Ji){var De=n;n=o,o=De}if(0!=Pe){var Te=n!=t;if(Pe>4){ke=.25*(he+ce+me+xe),Ie=.25*(le+pe+fe+ve),ze=.25*(ue+de+ye+ge),Ti=he-ke,Li=le-Ie,Ri=ue-ze,Oi=ce-ke,Vi=pe-Ie,Bi=de-ze;var Le=0,Re=0,Oe=0,Ve=0,Be=-this.INF;for(be=this.INF,we=0;Pe>we;we++)this.used[we]=!1,Se=3*we,ke=this.clipVertices1[Se],Ie=this.clipVertices1[Se+1],ze=this.clipVertices1[Se+2],Ne=ke*Ti+Ie*Li+ze*Ri,be>Ne&&(be=Ne,Le=we),Ne>Be&&(Be=Ne,Oe=we);for(this.used[Le]=!0,this.used[Oe]=!0,Be=-this.INF,be=this.INF,we=0;Pe>we;we++)this.used[we]||(Se=3*we,ke=this.clipVertices1[Se],Ie=this.clipVertices1[Se+1],ze=this.clipVertices1[Se+2],Ne=ke*Oi+Ie*Vi+ze*Bi,be>Ne&&(be=Ne,Re=we),Ne>Be&&(Be=Ne,Ve=we));Se=3*Le,ke=this.clipVertices1[Se],Ie=this.clipVertices1[Se+1],ze=this.clipVertices1[Se+2],Ne=(ke-Ui)*Ei+(Ie-Fi)*wi+(ze-ji)*Di,0>Ne&&e.addPoint(ke,Ie,ze,Ei,wi,Di,Ne,Te),Se=3*Re,ke=this.clipVertices1[Se],Ie=this.clipVertices1[Se+1],ze=this.clipVertices1[Se+2],Ne=(ke-Ui)*Ei+(Ie-Fi)*wi+(ze-ji)*Di,0>Ne&&e.addPoint(ke,Ie,ze,Ei,wi,Di,Ne,Te),Se=3*Oe,ke=this.clipVertices1[Se],Ie=this.clipVertices1[Se+1],ze=this.clipVertices1[Se+2],Ne=(ke-Ui)*Ei+(Ie-Fi)*wi+(ze-ji)*Di,0>Ne&&e.addPoint(ke,Ie,ze,Ei,wi,Di,Ne,Te),Se=3*Ve,ke=this.clipVertices1[Se],Ie=this.clipVertices1[Se+1],ze=this.clipVertices1[Se+2],Ne=(ke-Ui)*Ei+(Ie-Fi)*wi+(ze-ji)*Di,0>Ne&&e.addPoint(ke,Ie,ze,Ei,wi,Di,Ne,Te)}else for(we=0;Pe>we;we++)Se=3*we,ke=this.clipVertices1[Se],Ie=this.clipVertices1[Se+1],ze=this.clipVertices1[Se+2],Ne=(ke-Ui)*Ei+(Ie-Fi)*wi+(ze-ji)*Di,0>Ne&&e.addPoint(ke,Ie,ze,Ei,wi,Di,Ne,Te)}}}}}},s.SphereBoxCollisionDetector=function(t){s.CollisionDetector.call(this),this.flip=t},s.SphereBoxCollisionDetector.prototype=Object.create(s.CollisionDetector.prototype),s.SphereBoxCollisionDetector.prototype.constructor=s.SphereBoxCollisionDetector,s.SphereBoxCollisionDetector.prototype.detectCollision=function(t,i,e){var n,o;this.flip?(n=i,o=t):(n=t,o=i);var r,a,h,l,u,c=o.dimentions,p=n.position,d=p.x,m=p.y,f=p.z,y=o.position,x=y.x,v=y.y,g=y.z,b=n.radius,N=o.halfWidth,C=o.halfHeight,P=o.halfDepth,A=d-x,S=m-v,k=f-g,I=c[0]*A+c[1]*S+c[2]*k,z=c[3]*A+c[4]*S+c[5]*k,_=c[6]*A+c[7]*S+c[8]*k,M=0;I>N?I=N:-N>I?I=-N:M=1,z>C?z=C:-C>z?z=-C:M|=2,_>P?_=P:-P>_?_=-P:M|=4,7==M?(A=0>I?N+I:N-I,S=0>z?C+z:C-z,k=0>_?P+_:P-_,S>A?k>A?(l=A-N,0>I?(I=-N,A=c[0],S=c[1],k=c[2]):(I=N,A=-c[0],S=-c[1],k=-c[2])):(l=k-P,0>_?(_=-P,A=c[6],S=c[7],k=c[8]):(_=P,A=-c[6],S=-c[7],k=-c[8])):k>S?(l=S-C,0>z?(z=-C,A=c[3],S=c[4],k=c[5]):(z=C,A=-c[3],S=-c[4],k=-c[5])):(l=k-P,0>_?(_=-P,A=c[6],S=c[7],k=c[8]):(_=P,A=-c[6],S=-c[7],k=-c[8])),r=x+I*c[0]+z*c[3]+_*c[6],a=v+I*c[1]+z*c[4]+_*c[7],h=g+I*c[2]+z*c[5]+_*c[8],e.addPoint(d+b*A,m+b*S,f+b*k,A,S,k,l-b,this.flip)):(r=x+I*c[0]+z*c[3]+_*c[6],a=v+I*c[1]+z*c[4]+_*c[7],h=g+I*c[2]+z*c[5]+_*c[8],A=r-p.x,S=a-p.y,k=h-p.z,l=A*A+S*S+k*k,l>0&&b*b>l&&(l=s.sqrt(l),u=1/l,A*=u,S*=u,k*=u,e.addPoint(d+b*A,m+b*S,f+b*k,A,S,k,l-b,this.flip)))},s.SphereSphereCollisionDetector=function(){s.CollisionDetector.call(this)},s.SphereSphereCollisionDetector.prototype=Object.create(s.CollisionDetector.prototype),s.SphereSphereCollisionDetector.prototype.constructor=s.SphereSphereCollisionDetector,s.SphereSphereCollisionDetector.prototype.detectCollision=function(t,i,e){var n=t,o=i,r=n.position,a=o.position,h=a.x-r.x,l=a.y-r.y,u=a.z-r.z,c=h*h+l*l+u*u,p=n.radius,d=o.radius,m=p+d;if(c>0&&m*m>c){c=s.sqrt(c);var f=1/c;h*=f,l*=f,u*=f,e.addPoint(r.x+h*p,r.y+l*p,r.z+u*p,h,l,u,c-m,!1)}},s.BoxCylinderCollisionDetector=function(t){s.CollisionDetector.call(this),this.flip=t},s.BoxCylinderCollisionDetector.prototype=Object.create(s.CollisionDetector.prototype),s.BoxCylinderCollisionDetector.prototype.constructor=s.BoxCylinderCollisionDetector,s.BoxCylinderCollisionDetector.prototype.getSep=function(t,i,e,n,o){var r,a,h,l,u,c,p,d,m,f,y,x,v,g=new s.Vec3,b=t.position.x,N=t.position.y,C=t.position.z,P=i.position.x,A=i.position.y,S=i.position.z,k=P-b,I=A-N,z=S-C;k*k+I*I+z*z==0&&(I=.001);var _=-k,M=-I,E=-z;this.supportPointB(t,-_,-M,-E,g);var w=g.x,D=g.y,T=g.z;this.supportPointC(i,_,M,E,g);var L=g.x,R=g.y,O=g.z,V=L-w,B=R-D,U=O-T;if(0>=V*_+B*M+U*E)return!1;if(_=B*z-U*I,M=U*k-V*z,E=V*I-B*k,_*_+M*M+E*E==0)return e.init(V-k,B-I,U-z),e.normalize(e),n.init(.5*(w+L),.5*(D+R),.5*(T+O)),!0;this.supportPointB(t,-_,-M,-E,g);var F=g.x,j=g.y,Y=g.z;this.supportPointC(i,_,M,E,g);var X=g.x,W=g.y,Z=g.z,q=X-F,H=W-j,J=Z-Y;if(0>=q*_+H*M+J*E)return!1;r=V-k,a=B-I,h=U-z,l=q-k,u=H-I,c=J-z,_=a*c-h*u,M=h*l-r*c,E=r*u-a*l,_*k+M*I+E*z>0&&(r=V,a=B,h=U,V=q,B=H,U=J,q=r,H=a,J=h,r=w,a=D,h=T,w=F,D=j,T=Y,F=r,j=a,Y=h,r=L,a=R,h=O,L=X,R=W,O=Z,X=r,W=a,Z=h,_=-_,M=-M,E=-E);for(var K=0;;){if(++K>100)return!1;this.supportPointB(t,-_,-M,-E,g);var Q=g.x,G=g.y,$=g.z;this.supportPointC(i,_,M,E,g);var tt=g.x,it=g.y,et=g.z,st=tt-Q,nt=it-G,ot=et-$;if(0>=st*_+nt*M+ot*E)return!1;if(0>(B*ot-U*nt)*k+(U*st-V*ot)*I+(V*nt-B*st)*z)q=st,H=nt,J=ot,F=Q,j=G,Y=$,X=tt,W=it,Z=et,r=V-k,a=B-I,h=U-z,l=st-k,u=nt-I,c=ot-z,_=a*c-h*u,M=h*l-r*c,E=r*u-a*l;else if(0>(nt*J-ot*H)*k+(ot*q-st*J)*I+(st*H-nt*q)*z)V=st,B=nt,U=ot,w=Q,D=G,T=$,L=tt,R=it,O=et,r=st-k,a=nt-I,h=ot-z,l=q-k,u=H-I,c=J-z,_=a*c-h*u,M=h*l-r*c,E=r*u-a*l;else for(var rt=!1;;){if(r=q-V,a=H-B,h=J-U,l=st-V,u=nt-B,c=ot-U,_=a*c-h*u,M=h*l-r*c,E=r*u-a*l,p=1/s.sqrt(_*_+M*M+E*E),_*=p,M*=p,E*=p,_*V+M*B+E*U>=0&&!rt){var at=(B*J-U*H)*st+(U*q-V*J)*nt+(V*H-B*q)*ot,ht=(nt*J-ot*H)*k+(ot*q-st*J)*I+(st*H-nt*q)*z,lt=(I*U-z*B)*st+(z*V-k*U)*nt+(k*B-I*V)*ot,ut=(H*U-J*B)*k+(J*V-q*U)*I+(q*B-H*V)*z,ct=at+ht+lt+ut;0>=ct&&(at=0,ht=(H*ot-J*nt)*_+(J*st-q*ot)*M+(q*nt-H*st)*E,lt=(nt*J-ot*H)*_+(ot*q-st*J)*M+(st*H-nt*q)*E,ut=(B*J-U*H)*_+(U*q-V*J)*M+(V*H-B*q)*E,ct=ht+lt+ut);var pt=1/ct;d=(b*at+w*ht+F*lt+Q*ut)*pt,m=(N*at+D*ht+j*lt+G*ut)*pt,f=(C*at+T*ht+Y*lt+$*ut)*pt,y=(P*at+L*ht+X*lt+tt*ut)*pt,x=(A*at+R*ht+W*lt+it*ut)*pt,v=(S*at+O*ht+Z*lt+et*ut)*pt,rt=!0}this.supportPointB(t,-_,-M,-E,g);var dt=g.x,mt=g.y,ft=g.z;this.supportPointC(i,_,M,E,g);var yt=g.x,xt=g.y,vt=g.z,gt=yt-dt,bt=xt-mt,Nt=vt-ft,Ct=-(gt*_+bt*M+Nt*E);if(.01>=(gt-st)*_+(bt-nt)*M+(Nt-ot)*E||Ct>=0)return rt?(e.init(-_,-M,-E),n.init(.5*(d+y),.5*(m+x),.5*(f+v)),o.x=Ct,!0):!1;0>(bt*U-Nt*B)*k+(Nt*V-gt*U)*I+(gt*B-bt*V)*z?0>(bt*J-Nt*H)*k+(Nt*q-gt*J)*I+(gt*H-bt*q)*z?(V=gt,B=bt,U=Nt,w=dt,D=mt,T=ft,L=yt,R=xt,O=vt):(st=gt,nt=bt,ot=Nt,Q=dt,G=mt,$=ft,tt=yt,it=xt,et=vt):0>(bt*ot-Nt*nt)*k+(Nt*st-gt*ot)*I+(gt*nt-bt*st)*z?(q=gt,H=bt,J=Nt,F=dt,j=mt,Y=ft,X=yt,W=xt,Z=vt):(V=gt,B=bt,U=Nt,w=dt,D=mt,T=ft,L=yt,R=xt,O=vt)}}},s.BoxCylinderCollisionDetector.prototype.supportPointB=function(t,i,e,s,n){var o,r,a,h=t.rotation.elements,l=h[0]*i+h[3]*e+h[6]*s,u=h[1]*i+h[4]*e+h[7]*s,c=h[2]*i+h[5]*e+h[8]*s,p=t.halfWidth,d=t.halfHeight,m=t.halfDepth;o=0>l?-p:p,r=0>u?-d:d,a=0>c?-m:m,l=h[0]*o+h[1]*r+h[2]*a+t.position.x,u=h[3]*o+h[4]*r+h[5]*a+t.position.y,c=h[6]*o+h[7]*r+h[8]*a+t.position.z,n.init(l,u,c)},s.BoxCylinderCollisionDetector.prototype.supportPointC=function(t,i,e,n,o){var r,a,h,l=t.rotation.elements,u=l[0]*i+l[3]*e+l[6]*n,c=l[1]*i+l[4]*e+l[7]*n,p=l[2]*i+l[5]*e+l[8]*n,d=u,m=p,f=d*d+m*m,y=t.radius,x=t.halfHeight;0==f?0>c?(r=y,a=-x,h=0):(r=y,a=x,h=0):(f=t.radius/s.sqrt(f),0>c?(r=d*f,a=-x,h=m*f):(r=d*f,a=x,h=m*f)),u=l[0]*r+l[1]*a+l[2]*h+t.position.x,c=l[3]*r+l[4]*a+l[5]*h+t.position.y,p=l[6]*r+l[7]*a+l[8]*h+t.position.z,o.init(u,c,p)},s.BoxCylinderCollisionDetector.prototype.detectCollision=function(t,i,e){var n,o;this.flip?(n=i,o=t):(n=t,o=i);var r=new s.Vec3,a=new s.Vec3,h=new s.Vec3;if(this.getSep(n,o,r,a,h)){var l=n.position.x,u=n.position.y,c=n.position.z,p=o.position.x,d=o.position.y,m=o.position.z,f=n.halfWidth,y=n.halfHeight,x=n.halfDepth,v=o.halfHeight,g=o.radius,b=n.dimentions,N=b[0],C=b[1],P=b[2],A=b[3],S=b[4],k=b[5],I=b[6],z=b[7],_=b[8],M=b[9],E=b[10],w=b[11],D=b[12],T=b[13],L=b[14],R=b[15],O=b[16],V=b[17],B=o.normalDirection.x,U=o.normalDirection.y,F=o.normalDirection.z,j=o.halfDirection.x,Y=o.halfDirection.y,X=o.halfDirection.z,W=r.x,Z=r.y,q=r.z,H=W*N+Z*C+q*P,J=W*A+Z*S+q*k,K=W*I+Z*z+q*_,Q=W*B+Z*U+q*F,G=H>0,$=J>0,tt=K>0,it=Q>0;G||(H=-H),$||(J=-J),tt||(K=-K),it||(Q=-Q);var et=0;Q>.999?et=H>.999?H>Q?1:4:J>.999?J>Q?2:4:K>.999&&K>Q?3:4:H>.999?et=1:J>.999?et=2:K>.999&&(et=3);var st,nt,ot,rt,at,ht,lt,ut,ct,pt,dt,mt,ft,yt,xt,vt,gt,bt,Nt,Ct,Pt,At,St,kt,It,zt,_t,Mt,Et,wt,Dt,Tt,Lt,Rt,Ot,Vt,Bt,Ut,Ft,jt,Yt,Xt,Wt,Zt,qt,Ht,Jt,Kt,Qt,Gt,$t,ti,ii;if(0==et)e.addPoint(a.x,a.y,a.z,W,Z,q,h.x,this.flip);else if(4==et){it?(rt=p-j,at=d-Y,ht=m-X,W=-B,Z=-U,q=-F):(rt=p+j,at=d+Y,ht=m+X,W=B,Z=U,q=F);var ei,si,ni,oi,ri,ai,hi,li,ui,ci,pi,di;Ct=1,et=0,Wt=N*W+C*Z+P*q,Ct>Wt&&(Ct=Wt,et=0),Ct>-Wt&&(Ct=-Wt,et=1),Wt=A*W+S*Z+k*q,Ct>Wt&&(Ct=Wt,et=2),Ct>-Wt&&(Ct=-Wt,et=3),Wt=I*W+z*Z+_*q,Ct>Wt&&(Ct=Wt,et=4),Ct>-Wt&&(Ct=-Wt,et=5);var mi=n.elements;switch(et){case 0:ei=mi[0],si=mi[1],ni=mi[2],oi=mi[6],ri=mi[7],ai=mi[8],hi=mi[9],li=mi[10],ui=mi[11],ci=mi[3],pi=mi[4],di=mi[5];break;case 1:ei=mi[15],si=mi[16],ni=mi[17],oi=mi[21],ri=mi[22],ai=mi[23],hi=mi[18],li=mi[19],ui=mi[20],ci=mi[12],pi=mi[13],di=mi[14];break;case 2:ei=mi[12],si=mi[13],ni=mi[14],oi=mi[0],ri=mi[1],ai=mi[2],hi=mi[3],li=mi[4],ui=mi[5],ci=mi[15],pi=mi[16],di=mi[17];break;case 3:ei=mi[21],si=mi[22],ni=mi[23],oi=mi[9],ri=mi[10],ai=mi[11],hi=mi[6],li=mi[7],ui=mi[8],ci=mi[18],pi=mi[19],di=mi[20];break;case 4:ei=mi[12],si=mi[13],ni=mi[14],oi=mi[18],ri=mi[19],ai=mi[20],hi=mi[6],li=mi[7],ui=mi[8],ci=mi[0],pi=mi[1],di=mi[2];break;case 5:ei=mi[3],si=mi[4],ni=mi[5],oi=mi[9],ri=mi[10],ai=mi[11],hi=mi[21],li=mi[22],ui=mi[23],ci=mi[15],pi=mi[16],di=mi[17]}Nt=W*(ei-rt)+Z*(si-at)+q*(ni-ht),0>=Nt&&e.addPoint(ei,si,ni,-W,-Z,-q,Nt,this.flip),Nt=W*(oi-rt)+Z*(ri-at)+q*(ai-ht),0>=Nt&&e.addPoint(oi,ri,ai,-W,-Z,-q,Nt,this.flip),Nt=W*(hi-rt)+Z*(li-at)+q*(ui-ht),0>=Nt&&e.addPoint(hi,li,ui,-W,-Z,-q,Nt,this.flip),Nt=W*(ci-rt)+Z*(pi-at)+q*(di-ht),0>=Nt&&e.addPoint(ci,pi,di,-W,-Z,-q,Nt,this.flip)}else{switch(et){case 1:G?(st=l+M,nt=u+E,ot=c+w,W=N,Z=C,q=P):(st=l-M,nt=u-E,ot=c-w,W=-N,Z=-C,q=-P),Ht=A,Jt=S,Kt=k,ti=y,Qt=I,Gt=z,$t=_,ii=x;break;case 2:$?(st=l+D,nt=u+T,ot=c+L,W=A,Z=S,q=k):(st=l-D,nt=u-T,ot=c-L,W=-A,Z=-S,q=-k),Ht=N,Jt=C,Kt=P,ti=f,Qt=I,Gt=z,$t=_,ii=x;break;case 3:tt?(st=l+R,nt=u+O,ot=c+V,W=I,Z=z,q=_):(st=l-R,nt=u-O,ot=c-V,W=-I,Z=-z,q=-_),Ht=N,Jt=C,Kt=P,ti=f,Qt=A,Gt=S,$t=k,ii=y}if(Ct=W*B+Z*U+q*F,Pt=0>Ct?v:-v,rt=p+Pt*B,at=d+Pt*U,ht=m+Pt*F,Q>=.999999?(At=-Z,St=q,kt=W):(At=W,St=Z,kt=q),Pt=At*B+St*U+kt*F,zt=Pt*B-At,_t=Pt*U-St,Mt=Pt*F-kt,Pt=s.sqrt(zt*zt+_t*_t+Mt*Mt),0==Pt)return;if(Pt=g/Pt,zt*=Pt,_t*=Pt,Mt*=Pt,At=rt+zt,St=at+_t,kt=ht+Mt,-.96>Ct||Ct>.96)lt=B*B*1.5-.5,ut=B*U*1.5-.866025403*F,ct=B*F*1.5+.866025403*U,pt=U*B*1.5+.866025403*F,dt=U*U*1.5-.5,mt=U*F*1.5-.866025403*B,ft=F*B*1.5-.866025403*U,yt=F*U*1.5+.866025403*B,xt=F*F*1.5-.5,vt=At,gt=St,bt=kt,Nt=W*(vt-st)+Z*(gt-nt)+q*(bt-ot),At=vt-Nt*W-st,St=gt-Nt*Z-nt,kt=bt-Nt*q-ot,Ut=Ht*At+Jt*St+Kt*kt,Xt=Qt*At+Gt*St+$t*kt,-ti>Ut?Ut=-ti:Ut>ti&&(Ut=ti),-ii>Xt?Xt=-ii:Xt>ii&&(Xt=ii),At=Ut*Ht+Xt*Qt,St=Ut*Jt+Xt*Gt,kt=Ut*Kt+Xt*$t,vt=st+At,gt=nt+St,bt=ot+kt,e.addPoint(vt,gt,bt,W,Z,q,Nt,this.flip),vt=zt*lt+_t*ut+Mt*ct,gt=zt*pt+_t*dt+Mt*mt,bt=zt*ft+_t*yt+Mt*xt,vt=(zt=vt)+rt,gt=(_t=gt)+at,bt=(Mt=bt)+ht,Nt=W*(vt-st)+Z*(gt-nt)+q*(bt-ot),0>=Nt&&(At=vt-Nt*W-st,St=gt-Nt*Z-nt,kt=bt-Nt*q-ot,Ut=Ht*At+Jt*St+Kt*kt,Xt=Qt*At+Gt*St+$t*kt,-ti>Ut?Ut=-ti:Ut>ti&&(Ut=ti),-ii>Xt?Xt=-ii:Xt>ii&&(Xt=ii),At=Ut*Ht+Xt*Qt,St=Ut*Jt+Xt*Gt,kt=Ut*Kt+Xt*$t,vt=st+At,gt=nt+St,bt=ot+kt,e.addPoint(vt,gt,bt,W,Z,q,Nt,this.flip)),vt=zt*lt+_t*ut+Mt*ct,gt=zt*pt+_t*dt+Mt*mt,bt=zt*ft+_t*yt+Mt*xt,vt=(zt=vt)+rt,gt=(_t=gt)+at,bt=(Mt=bt)+ht,Nt=W*(vt-st)+Z*(gt-nt)+q*(bt-ot),0>=Nt&&(At=vt-Nt*W-st,St=gt-Nt*Z-nt,kt=bt-Nt*q-ot,Ut=Ht*At+Jt*St+Kt*kt,Xt=Qt*At+Gt*St+$t*kt,-ti>Ut?Ut=-ti:Ut>ti&&(Ut=ti),-ii>Xt?Xt=-ii:Xt>ii&&(Xt=ii),At=Ut*Ht+Xt*Qt,St=Ut*Jt+Xt*Gt,kt=Ut*Kt+Xt*$t,vt=st+At,gt=nt+St,bt=ot+kt,e.addPoint(vt,gt,bt,W,Z,q,Nt,this.flip));else{if(Ot=At,Vt=St,Bt=kt,Ut=W*(Ot-st)+Z*(Vt-nt)+q*(Bt-ot),Ot-=Ut*W,Vt-=Ut*Z,Bt-=Ut*q,Ct>0?(Ft=At+2*j,jt=St+2*Y,Yt=kt+2*X):(Ft=At-2*j,jt=St-2*Y,Yt=kt-2*X),Xt=W*(Ft-st)+Z*(jt-nt)+q*(Yt-ot),Ft-=Xt*W,jt-=Xt*Z,Yt-=Xt*q,Et=Ot-st,wt=Vt-nt,Dt=Bt-ot,Tt=Ft-st,Lt=jt-nt,Rt=Yt-ot,At=Ft-Ot,St=jt-Vt,kt=Yt-Bt,It=Xt-Ut,H=Et*Ht+wt*Jt+Dt*Kt,J=Tt*Ht+Lt*Jt+Rt*Kt,Wt=H-ti,Zt=J-ti,Wt>0){if(Zt>0)return;qt=Wt/(Wt-Zt),Ot+=At*qt,Vt+=St*qt,Bt+=kt*qt,Ut+=It*qt,Et=Ot-st,wt=Vt-nt,Dt=Bt-ot,H=Et*Ht+wt*Jt+Dt*Kt,At=Ft-Ot,St=jt-Vt,kt=Yt-Bt,It=Xt-Ut}else Zt>0&&(qt=Wt/(Wt-Zt),Ft=Ot+At*qt,jt=Vt+St*qt,Yt=Bt+kt*qt,Xt=Ut+It*qt,Tt=Ft-st,Lt=jt-nt,Rt=Yt-ot,J=Tt*Ht+Lt*Jt+Rt*Kt,At=Ft-Ot,St=jt-Vt,kt=Yt-Bt,It=Xt-Ut);if(Wt=H+ti,Zt=J+ti,0>Wt){if(0>Zt)return;qt=Wt/(Wt-Zt),Ot+=At*qt,Vt+=St*qt,Bt+=kt*qt,Ut+=It*qt,Et=Ot-st,wt=Vt-nt,Dt=Bt-ot,At=Ft-Ot,St=jt-Vt,kt=Yt-Bt,It=Xt-Ut}else 0>Zt&&(qt=Wt/(Wt-Zt),Ft=Ot+At*qt,jt=Vt+St*qt,Yt=Bt+kt*qt,Xt=Ut+It*qt,Tt=Ft-st,Lt=jt-nt,Rt=Yt-ot,At=Ft-Ot,St=jt-Vt,kt=Yt-Bt,It=Xt-Ut);if(H=Et*Qt+wt*Gt+Dt*$t,J=Tt*Qt+Lt*Gt+Rt*$t,Wt=H-ii,Zt=J-ii,Wt>0){if(Zt>0)return;qt=Wt/(Wt-Zt),Ot+=At*qt,Vt+=St*qt,Bt+=kt*qt,Ut+=It*qt,Et=Ot-st,wt=Vt-nt,Dt=Bt-ot,H=Et*Qt+wt*Gt+Dt*$t,At=Ft-Ot,St=jt-Vt,kt=Yt-Bt,It=Xt-Ut}else Zt>0&&(qt=Wt/(Wt-Zt),Ft=Ot+At*qt,jt=Vt+St*qt,Yt=Bt+kt*qt,Xt=Ut+It*qt,Tt=Ft-st,Lt=jt-nt,Rt=Yt-ot,J=Tt*Qt+Lt*Gt+Rt*$t,At=Ft-Ot,St=jt-Vt,kt=Yt-Bt,It=Xt-Ut);if(Wt=H+ii,Zt=J+ii,0>Wt){if(0>Zt)return;qt=Wt/(Wt-Zt),Ot+=At*qt,Vt+=St*qt,Bt+=kt*qt,Ut+=It*qt}else 0>Zt&&(qt=Wt/(Wt-Zt),Ft=Ot+At*qt,jt=Vt+St*qt,Yt=Bt+kt*qt,Xt=Ut+It*qt);0>Ut&&e.addPoint(Ot,Vt,Bt,W,Z,q,Ut,this.flip),0>Xt&&e.addPoint(Ft,jt,Yt,W,Z,q,Xt,this.flip)}}}},s.CylinderCylinderCollisionDetector=function(){s.CollisionDetector.call(this)},s.CylinderCylinderCollisionDetector.prototype=Object.create(s.CollisionDetector.prototype),s.CylinderCylinderCollisionDetector.prototype.constructor=s.CylinderCylinderCollisionDetector,s.CylinderCylinderCollisionDetector.prototype.getSep=function(t,i,e,n,o){var r,a,h,l,u,c,p,d,m,f,y,x,v,g=new s.Vec3,b=t.position.x,N=t.position.y,C=t.position.z,P=i.position.x,A=i.position.y,S=i.position.z,k=P-b,I=A-N,z=S-C;k*k+I*I+z*z==0&&(I=.001);var _=-k,M=-I,E=-z;this.supportPoint(t,-_,-M,-E,g);var w=g.x,D=g.y,T=g.z;this.supportPoint(i,_,M,E,g);var L=g.x,R=g.y,O=g.z,V=L-w,B=R-D,U=O-T;if(0>=V*_+B*M+U*E)return!1;if(_=B*z-U*I,M=U*k-V*z,E=V*I-B*k,_*_+M*M+E*E==0)return e.init(V-k,B-I,U-z),e.normalize(e),n.init(.5*(w+L),.5*(D+R),.5*(T+O)),!0;this.supportPoint(t,-_,-M,-E,g);var F=g.x,j=g.y,Y=g.z;this.supportPoint(i,_,M,E,g);var X=g.x,W=g.y,Z=g.z,q=X-F,H=W-j,J=Z-Y;if(0>=q*_+H*M+J*E)return!1;r=V-k,a=B-I,h=U-z,l=q-k,u=H-I,c=J-z,_=a*c-h*u,M=h*l-r*c,E=r*u-a*l,_*k+M*I+E*z>0&&(r=V,a=B,h=U,V=q,B=H,U=J,q=r,H=a,J=h,r=w,a=D,h=T,w=F,D=j,T=Y,F=r,j=a,Y=h,r=L,a=R,h=O,L=X,R=W,O=Z,X=r,W=a,Z=h,_=-_,M=-M,E=-E);for(var K=0;;){if(++K>100)return!1;this.supportPoint(t,-_,-M,-E,g);var Q=g.x,G=g.y,$=g.z;this.supportPoint(i,_,M,E,g);var tt=g.x,it=g.y,et=g.z,st=tt-Q,nt=it-G,ot=et-$;if(0>=st*_+nt*M+ot*E)return!1;if(0>(B*ot-U*nt)*k+(U*st-V*ot)*I+(V*nt-B*st)*z)q=st,H=nt,J=ot,F=Q,j=G,Y=$,X=tt,W=it,Z=et,r=V-k,a=B-I,h=U-z,l=st-k,u=nt-I,c=ot-z,_=a*c-h*u,M=h*l-r*c,E=r*u-a*l;else if(0>(nt*J-ot*H)*k+(ot*q-st*J)*I+(st*H-nt*q)*z)V=st,B=nt,U=ot,w=Q,D=G,T=$,L=tt,R=it,O=et,r=st-k,a=nt-I,h=ot-z,l=q-k,u=H-I,c=J-z,_=a*c-h*u,M=h*l-r*c,E=r*u-a*l;else for(var rt=!1;;){if(r=q-V,a=H-B,h=J-U,l=st-V,u=nt-B,c=ot-U,_=a*c-h*u,M=h*l-r*c,E=r*u-a*l,p=1/s.sqrt(_*_+M*M+E*E),_*=p,M*=p,E*=p,_*V+M*B+E*U>=0&&!rt){var at=(B*J-U*H)*st+(U*q-V*J)*nt+(V*H-B*q)*ot,ht=(nt*J-ot*H)*k+(ot*q-st*J)*I+(st*H-nt*q)*z,lt=(I*U-z*B)*st+(z*V-k*U)*nt+(k*B-I*V)*ot,ut=(H*U-J*B)*k+(J*V-q*U)*I+(q*B-H*V)*z,ct=at+ht+lt+ut;0>=ct&&(at=0,ht=(H*ot-J*nt)*_+(J*st-q*ot)*M+(q*nt-H*st)*E,lt=(nt*J-ot*H)*_+(ot*q-st*J)*M+(st*H-nt*q)*E,ut=(B*J-U*H)*_+(U*q-V*J)*M+(V*H-B*q)*E,ct=ht+lt+ut);var pt=1/ct;d=(b*at+w*ht+F*lt+Q*ut)*pt,m=(N*at+D*ht+j*lt+G*ut)*pt,f=(C*at+T*ht+Y*lt+$*ut)*pt,y=(P*at+L*ht+X*lt+tt*ut)*pt,x=(A*at+R*ht+W*lt+it*ut)*pt,v=(S*at+O*ht+Z*lt+et*ut)*pt,rt=!0}this.supportPoint(t,-_,-M,-E,g);var dt=g.x,mt=g.y,ft=g.z;this.supportPoint(i,_,M,E,g);var yt=g.x,xt=g.y,vt=g.z,gt=yt-dt,bt=xt-mt,Nt=vt-ft,Ct=-(gt*_+bt*M+Nt*E);if(.01>=(gt-st)*_+(bt-nt)*M+(Nt-ot)*E||Ct>=0)return rt?(e.init(-_,-M,-E),n.init(.5*(d+y),.5*(m+x),.5*(f+v)),o.x=Ct,!0):!1;0>(bt*U-Nt*B)*k+(Nt*V-gt*U)*I+(gt*B-bt*V)*z?0>(bt*J-Nt*H)*k+(Nt*q-gt*J)*I+(gt*H-bt*q)*z?(V=gt,B=bt,U=Nt,w=dt,D=mt,T=ft,L=yt,R=xt,O=vt):(st=gt,nt=bt,ot=Nt,Q=dt,G=mt,$=ft,tt=yt,it=xt,et=vt):0>(bt*ot-Nt*nt)*k+(Nt*st-gt*ot)*I+(gt*nt-bt*st)*z?(q=gt,H=bt,J=Nt,F=dt,j=mt,Y=ft,X=yt,W=xt,Z=vt):(V=gt,B=bt,U=Nt,w=dt,D=mt,T=ft,L=yt,R=xt,O=vt)}}},s.CylinderCylinderCollisionDetector.prototype.supportPoint=function(t,i,e,n,o){var r,a,h,l=t.rotation.elements,u=l[0]*i+l[3]*e+l[6]*n,c=l[1]*i+l[4]*e+l[7]*n,p=l[2]*i+l[5]*e+l[8]*n,d=u,m=p,f=d*d+m*m,y=t.radius,x=t.halfHeight;0==f?0>c?(r=y,a=-x,h=0):(r=y,a=x,h=0):(f=t.radius/s.sqrt(f),0>c?(r=d*f,a=-x,h=m*f):(r=d*f,a=x,h=m*f)),u=l[0]*r+l[1]*a+l[2]*h+t.position.x,c=l[3]*r+l[4]*a+l[5]*h+t.position.y,p=l[6]*r+l[7]*a+l[8]*h+t.position.z,o.init(u,c,p)},s.CylinderCylinderCollisionDetector.prototype.detectCollision=function(t,i,e){var n,o;t.id<i.id?(n=t,o=i):(n=i,o=t);var r,a,h,l,u,c,p,d,m,f,y,x,v,g,b,N,C,P,A,S,k,I=n.position,z=o.position,_=I.x,M=I.y,E=I.z,w=z.x,D=z.y,T=z.z,L=n.halfHeight,R=o.halfHeight,O=n.normalDirection,V=o.normalDirection,B=n.halfDirection,U=o.halfDirection,F=n.radius,j=o.radius,Y=O.x,X=O.y,W=O.z,Z=V.x,q=V.y,H=V.z,J=B.x,K=B.y,Q=B.z,G=U.x,$=U.y,tt=U.z,it=_-w,et=M-D,st=E-T,nt=new s.Vec3,ot=new s.Vec3,rt=new s.Vec3;
if(this.getSep(n,o,nt,ot,rt)){var at=nt.x*Y+nt.y*X+nt.z*W,ht=nt.x*Z+nt.y*q+nt.z*H,lt=at>0,ut=ht>0;lt||(at=-at),ut||(ht=-ht);var ct=0;(at>.999||ht>.999)&&(ct=at>ht?1:2);var pt,dt,mt,ft,yt,xt,vt,gt,bt,Nt,Ct,Pt,At,St,kt,It,zt,_t,Mt,Et,wt=rt.x;switch(pt=nt.x,dt=nt.y,mt=nt.z,ct){case 0:e.addPoint(ot.x,ot.y,ot.z,pt,dt,mt,wt,!1);break;case 1:if(lt?(a=_+J,h=M+K,l=E+Q,pt=Y,dt=X,mt=W):(a=_-J,h=M-K,l=E-Q,pt=-Y,dt=-X,mt=-W),A=pt*Z+dt*q+mt*H,r=0>A?R:-R,u=w+r*Z,c=D+r*q,p=T+r*H,ht>=.999999?(d=-dt,m=mt,f=pt):(d=pt,m=dt,f=mt),r=d*Z+m*q+f*H,it=r*Z-d,et=r*q-m,st=r*H-f,r=s.sqrt(it*it+et*et+st*st),0==r)break;if(r=j/r,it*=r,et*=r,st*=r,d=u+it,m=c+et,f=p+st,-.96>A||A>.96)ft=Z*Z*1.5-.5,yt=Z*q*1.5-.866025403*H,xt=Z*H*1.5+.866025403*q,vt=q*Z*1.5+.866025403*H,gt=q*q*1.5-.5,bt=q*H*1.5-.866025403*Z,Nt=H*Z*1.5-.866025403*q,Ct=H*q*1.5+.866025403*Z,Pt=H*H*1.5-.5,At=d,St=m,kt=f,It=pt*(At-a)+dt*(St-h)+mt*(kt-l),d=At-It*pt-a,m=St-It*dt-h,f=kt-It*mt-l,r=d*d+m*m+f*f,r>F*F&&(r=F/s.sqrt(r),d*=r,m*=r,f*=r),At=a+d,St=h+m,kt=l+f,e.addPoint(At,St,kt,pt,dt,mt,It,!1),At=it*ft+et*yt+st*xt,St=it*vt+et*gt+st*bt,kt=it*Nt+et*Ct+st*Pt,At=(it=At)+u,St=(et=St)+c,kt=(st=kt)+p,It=pt*(At-a)+dt*(St-h)+mt*(kt-l),0>=It&&(d=At-It*pt-a,m=St-It*dt-h,f=kt-It*mt-l,r=d*d+m*m+f*f,r>F*F&&(r=F/s.sqrt(r),d*=r,m*=r,f*=r),At=a+d,St=h+m,kt=l+f,e.addPoint(At,St,kt,pt,dt,mt,It,!1)),At=it*ft+et*yt+st*xt,St=it*vt+et*gt+st*bt,kt=it*Nt+et*Ct+st*Pt,At=(it=At)+u,St=(et=St)+c,kt=(st=kt)+p,It=pt*(At-a)+dt*(St-h)+mt*(kt-l),0>=It&&(d=At-It*pt-a,m=St-It*dt-h,f=kt-It*mt-l,r=d*d+m*m+f*f,r>F*F&&(r=F/s.sqrt(r),d*=r,m*=r,f*=r),At=a+d,St=h+m,kt=l+f,e.addPoint(At,St,kt,pt,dt,mt,It,!1));else{if(y=d,x=m,v=f,C=pt*(y-a)+dt*(x-h)+mt*(v-l),y-=C*pt,x-=C*dt,v-=C*mt,A>0?(g=d+Z*R*2,b=m+q*R*2,N=f+H*R*2):(g=d-Z*R*2,b=m-q*R*2,N=f-H*R*2),P=pt*(g-a)+dt*(b-h)+mt*(N-l),g-=P*pt,b-=P*dt,N-=P*mt,it=a-y,et=h-x,st=l-v,d=g-y,m=b-x,f=N-v,zt=it*it+et*et+st*st,_t=it*d+et*m+st*f,Mt=d*d+m*m+f*f,Et=_t*_t-Mt*(zt-F*F),0>Et)break;Et=s.sqrt(Et),S=(_t+Et)/Mt,k=(_t-Et)/Mt,S>k&&(r=S,S=k,k=r),k>1&&(k=1),0>S&&(S=0),d=y+(g-y)*S,m=x+(b-x)*S,f=v+(N-v)*S,g=y+(g-y)*k,b=x+(b-x)*k,N=v+(N-v)*k,y=d,x=m,v=f,r=C+(P-C)*S,P=C+(P-C)*k,C=r,0>C&&e.addPoint(y,x,v,pt,dt,mt,It,!1),0>P&&e.addPoint(g,b,N,pt,dt,mt,It,!1)}break;case 2:if(ut?(u=w-G,c=D-$,p=T-tt,pt=-Z,dt=-q,mt=-H):(u=w+G,c=D+$,p=T+tt,pt=Z,dt=q,mt=H),A=pt*Y+dt*X+mt*W,r=0>A?L:-L,a=_+r*Y,h=M+r*X,l=E+r*W,at>=.999999?(d=-dt,m=mt,f=pt):(d=pt,m=dt,f=mt),r=d*Y+m*X+f*W,it=r*Y-d,et=r*X-m,st=r*W-f,r=s.sqrt(it*it+et*et+st*st),0==r)break;if(r=F/r,it*=r,et*=r,st*=r,d=a+it,m=h+et,f=l+st,-.96>A||A>.96)ft=Y*Y*1.5-.5,yt=Y*X*1.5-.866025403*W,xt=Y*W*1.5+.866025403*X,vt=X*Y*1.5+.866025403*W,gt=X*X*1.5-.5,bt=X*W*1.5-.866025403*Y,Nt=W*Y*1.5-.866025403*X,Ct=W*X*1.5+.866025403*Y,Pt=W*W*1.5-.5,At=d,St=m,kt=f,It=pt*(At-u)+dt*(St-c)+mt*(kt-p),d=At-It*pt-u,m=St-It*dt-c,f=kt-It*mt-p,r=d*d+m*m+f*f,r>j*j&&(r=j/s.sqrt(r),d*=r,m*=r,f*=r),At=u+d,St=c+m,kt=p+f,e.addPoint(At,St,kt,-pt,-dt,-mt,It,!1),At=it*ft+et*yt+st*xt,St=it*vt+et*gt+st*bt,kt=it*Nt+et*Ct+st*Pt,At=(it=At)+a,St=(et=St)+h,kt=(st=kt)+l,It=pt*(At-u)+dt*(St-c)+mt*(kt-p),0>=It&&(d=At-It*pt-u,m=St-It*dt-c,f=kt-It*mt-p,r=d*d+m*m+f*f,r>j*j&&(r=j/s.sqrt(r),d*=r,m*=r,f*=r),At=u+d,St=c+m,kt=p+f,e.addPoint(At,St,kt,-pt,-dt,-mt,It,!1)),At=it*ft+et*yt+st*xt,St=it*vt+et*gt+st*bt,kt=it*Nt+et*Ct+st*Pt,At=(it=At)+a,St=(et=St)+h,kt=(st=kt)+l,It=pt*(At-u)+dt*(St-c)+mt*(kt-p),0>=It&&(d=At-It*pt-u,m=St-It*dt-c,f=kt-It*mt-p,r=d*d+m*m+f*f,r>j*j&&(r=j/s.sqrt(r),d*=r,m*=r,f*=r),At=u+d,St=c+m,kt=p+f,e.addPoint(At,St,kt,-pt,-dt,-mt,It,!1));else{if(y=d,x=m,v=f,C=pt*(y-u)+dt*(x-c)+mt*(v-p),y-=C*pt,x-=C*dt,v-=C*mt,A>0?(g=d+Y*L*2,b=m+X*L*2,N=f+W*L*2):(g=d-Y*L*2,b=m-X*L*2,N=f-W*L*2),P=pt*(g-u)+dt*(b-c)+mt*(N-p),g-=P*pt,b-=P*dt,N-=P*mt,it=u-y,et=c-x,st=p-v,d=g-y,m=b-x,f=N-v,zt=it*it+et*et+st*st,_t=it*d+et*m+st*f,Mt=d*d+m*m+f*f,Et=_t*_t-Mt*(zt-j*j),0>Et)break;Et=s.sqrt(Et),S=(_t+Et)/Mt,k=(_t-Et)/Mt,S>k&&(r=S,S=k,k=r),k>1&&(k=1),0>S&&(S=0),d=y+(g-y)*S,m=x+(b-x)*S,f=v+(N-v)*S,g=y+(g-y)*k,b=x+(b-x)*k,N=v+(N-v)*k,y=d,x=m,v=f,r=C+(P-C)*S,P=C+(P-C)*k,C=r,0>C&&e.addPoint(y,x,v,-pt,-dt,-mt,C,!1),0>P&&e.addPoint(g,b,N,-pt,-dt,-mt,P,!1)}}}},s.SphereCylinderCollisionDetector=function(t){s.CollisionDetector.call(this),this.flip=t},s.SphereCylinderCollisionDetector.prototype=Object.create(s.CollisionDetector.prototype),s.SphereCylinderCollisionDetector.prototype.constructor=s.SphereCylinderCollisionDetector,s.SphereCylinderCollisionDetector.prototype.detectCollision=function(t,i,e){var n,o;this.flip?(n=i,o=t):(n=t,o=i);var r=n.position,a=r.x,h=r.y,l=r.z,u=o.position,c=u.x,p=u.y,d=u.z,m=o.normalDirection.x,f=o.normalDirection.y,y=o.normalDirection.z,x=n.radius,v=o.radius,g=x+v,b=o.halfHeight,N=a-c,C=h-p,P=l-d,A=N*m+C*f+P*y;if(!(-b-x>A||A>b+x)){var S=c+A*m,k=p+A*f,I=d+A*y,z=a-S,_=h-k,M=l-I,E=z*z+_*_+M*M;if(!(E>g*g)){E>v*v&&(E=v/s.sqrt(E),z*=E,_*=E,M*=E),-b>A?A=-b:A>b&&(A=b),S=c+A*m+z,k=p+A*f+_,I=d+A*y+M,N=S-a,C=k-h,P=I-l,E=N*N+C*C+P*P;var w;E>0&&x*x>E&&(E=s.sqrt(E),w=1/E,N*=w,C*=w,P*=w,e.addPoint(a+N*x,h+C*x,l+P*x,N,C,P,E-x,this.flip))}}},s.AABB=function(t,i,s,n,o,r){this.elements=new e(6);var a=this.elements;a[0]=t||0,a[1]=s||0,a[2]=o||0,a[3]=i||0,a[4]=n||0,a[5]=r||0},s.AABB.prototype={constructor:s.AABB,set:function(t,i,e,s,n,o){var r=this.elements;return r[0]=t,r[3]=i,r[1]=e,r[4]=s,r[2]=n,r[5]=o,this},intersectTest:function(t){var i=this.elements,e=t.elements;return i[0]>e[3]||i[1]>e[4]||i[2]>e[5]||i[3]<e[0]||i[4]<e[1]||i[5]<e[2]},intersectTestTwo:function(t){var i=this.elements,e=t.elements;return i[0]<e[0]||i[1]<e[1]||i[2]<e[2]||i[3]>e[3]||i[4]>e[4]||i[5]>e[5]},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t,i){var e=i||0,s=t.elements;return this.set(s[0]-e,s[3]+e,s[1]-e,s[4]+e,s[2]-e,s[5]+e),this},fromArray:function(t){return this.elements.set(t),this},combine:function(t,i){var e=t.elements,s=i.elements,n=this.elements;return n[0]=e[0]<s[0]?e[0]:s[0],n[1]=e[1]<s[1]?e[1]:s[1],n[2]=e[2]<s[2]?e[2]:s[2],n[3]=e[3]>s[3]?e[3]:s[3],n[4]=e[4]>s[4]?e[4]:s[4],n[5]=e[5]>s[5]?e[5]:s[5],this},surfaceArea:function(){var t=this.elements,i=t[3]-t[0],e=t[4]-t[1],s=t[5]-t[2];return 2*(i*(e+s)+e*s)},intersectsWithPoint:function(t,i,e){var s=this.elements;return t>=s[0]&&t<=s[3]&&i>=s[1]&&i<=s[4]&&e>=s[2]&&e<=s[5]}},s.Proxy=function(t){this.shape=t,this.aabb=t.aabb},s.Proxy.prototype={constructor:s.Proxy,update:function(){s.Error("Proxy","Inheritance error.")}},s.BasicProxy=function(t){s.Proxy.call(this,t),this.id=s.proxyID++},s.BasicProxy.prototype=Object.create(s.Proxy.prototype),s.BasicProxy.prototype.constructor=s.BasicProxy,s.BasicProxy.prototype.update=function(){},s.BroadPhase=function(){this.types=s.BR_NULL,this.numPairChecks=0,this.numPairs=0,this.pairs=[]},s.BroadPhase.prototype={constructor:s.BroadPhase,createProxy:function(t){s.Error("BroadPhase","Inheritance error.")},addProxy:function(t){s.Error("BroadPhase","Inheritance error.")},removeProxy:function(t){s.Error("BroadPhase","Inheritance error.")},isAvailablePair:function(t,i){var e=t.parent,s=i.parent;if(e==s||!e.isDynamic&&!s.isDynamic||0==(t.belongsTo&i.collidesWith)||0==(i.belongsTo&t.collidesWith))return!1;var n;for(n=e.numJoints<s.numJoints?e.jointLink:s.jointLink;null!==n;){var o=n.joint;if(!o.allowCollision&&(o.body1==e&&o.body2==s||o.body1==s&&o.body2==e))return!1;n=n.next}return!0},detectPairs:function(){this.pairs=[],this.numPairs=0,this.numPairChecks=0,this.collectPairs()},collectPairs:function(){s.Error("BroadPhase","Inheritance error.")},addPair:function(t,i){var e=new s.Pair(t,i);this.pairs.push(e),this.numPairs++}},s.BruteForceBroadPhase=function(){s.BroadPhase.call(this),this.types=s.BR_BRUTE_FORCE,this.proxies=[]},s.BruteForceBroadPhase.prototype=Object.create(s.BroadPhase.prototype),s.BruteForceBroadPhase.prototype.constructor=s.BruteForceBroadPhase,s.BruteForceBroadPhase.prototype.createProxy=function(t){return new s.BasicProxy(t)},s.BruteForceBroadPhase.prototype.addProxy=function(t){this.proxies.push(t)},s.BruteForceBroadPhase.prototype.removeProxy=function(t){var i=this.proxies.indexOf(t);i>-1&&this.proxies.splice(i,1)},s.BruteForceBroadPhase.prototype.collectPairs=function(){var t,i,e,s=0,n=this.proxies,o=n.length;for(this.numPairChecks=o*(o-1)>>1;o>s;)for(i=n[s++],t=s+1;o>t;)e=n[t++],!i.aabb.intersectTest(e.aabb)&&this.isAvailablePair(i.shape,e.shape)&&this.addPair(i.shape,e.shape)},s.Pair=function(t,i){this.shape1=t||null,this.shape2=i||null},s.SAPAxis=function(){this.numElements=0,this.bufferSize=256,this.elements=[],this.elements.length=this.bufferSize,this.stack=new e(64)},s.SAPAxis.prototype={constructor:s.SAPAxis,addElements:function(t,i){if(this.numElements+2>=this.bufferSize){this.bufferSize*=2;for(var e=[],s=this.numElements;s--;)e[s]=this.elements[s]}this.elements[this.numElements++]=t,this.elements[this.numElements++]=i},removeElements:function(t,i){for(var e=-1,s=-1,n=0,o=this.numElements;o>n;n++){var r=this.elements[n];if(r==t||r==i){if(-1!=e){s=n;break}e=n}}for(n=e+1,o=s;o>n;n++)this.elements[n-1]=this.elements[n];for(n=s+1,o=this.numElements;o>n;n++)this.elements[n-2]=this.elements[n];this.elements[--this.numElements]=null,this.elements[--this.numElements]=null},sort:function(){for(var t=0,i=1;this.numElements>>i!=0;)i++;i=i*this.numElements>>2,t=0;for(var e=!1,n=this.elements,o=1,r=this.numElements;r>o;o++){var a=n[o],h=a.value,l=n[o-1];if(l.value>h){var u=o;do{if(n[u]=l,0==--u)break;l=n[u-1]}while(l.value>h);if(n[u]=a,t+=o-u,t>i){e=!0;break}}}if(e){t=2;var c=this.stack;for(c[0]=0,c[1]=this.numElements-1;t>0;){var p=c[--t],d=c[--t],m=p-d;if(m>16){var f=d+s.floor(.5*m);for(a=n[f],n[f]=n[p],n[p]=a,h=a.value,o=d-1,u=p;;){var y,x;do y=n[++o];while(y.value<h);do x=n[--u];while(h<x.value&&u!=d);if(o>=u)break;n[o]=x,n[u]=y}n[p]=n[o],n[o]=a,o-d>p-o?(c[t++]=d,c[t++]=o-1,c[t++]=o+1,c[t++]=p):(c[t++]=o+1,c[t++]=p,c[t++]=d,c[t++]=o-1)}else for(o=d+1;p>=o;o++)if(a=n[o],h=a.value,l=n[o-1],l.value>h){u=o;do{if(n[u]=l,0==--u)break;l=n[u-1]}while(l.value>h);n[u]=a}}}},calculateTestCount:function(){for(var t=1,i=0,e=1,s=this.numElements;s>e;e++)this.elements[e].max?t--:(i+=t,t++);return i}},s.SAPBroadPhase=function(){s.BroadPhase.call(this),this.types=s.BR_SWEEP_AND_PRUNE,this.numElementsD=0,this.numElementsS=0,this.axesD=[new s.SAPAxis,new s.SAPAxis,new s.SAPAxis],this.axesS=[new s.SAPAxis,new s.SAPAxis,new s.SAPAxis],this.index1=0,this.index2=1},s.SAPBroadPhase.prototype=Object.create(s.BroadPhase.prototype),s.SAPBroadPhase.prototype.constructor=s.SAPBroadPhase,s.SAPBroadPhase.prototype.createProxy=function(t){return new s.SAPProxy(this,t)},s.SAPBroadPhase.prototype.addProxy=function(t){var i=t;i.isDynamic()?(this.axesD[0].addElements(i.min[0],i.max[0]),this.axesD[1].addElements(i.min[1],i.max[1]),this.axesD[2].addElements(i.min[2],i.max[2]),i.belongsTo=1,this.numElementsD+=2):(this.axesS[0].addElements(i.min[0],i.max[0]),this.axesS[1].addElements(i.min[1],i.max[1]),this.axesS[2].addElements(i.min[2],i.max[2]),i.belongsTo=2,this.numElementsS+=2)},s.SAPBroadPhase.prototype.removeProxy=function(t){var i=t;if(0!=i.belongsTo){switch(i.belongsTo){case 1:this.axesD[0].removeElements(i.min[0],i.max[0]),this.axesD[1].removeElements(i.min[1],i.max[1]),this.axesD[2].removeElements(i.min[2],i.max[2]),this.numElementsD-=2;break;case 2:this.axesS[0].removeElements(i.min[0],i.max[0]),this.axesS[1].removeElements(i.min[1],i.max[1]),this.axesS[2].removeElements(i.min[2],i.max[2]),this.numElementsS-=2}i.belongsTo=0}},s.SAPBroadPhase.prototype.collectPairs=function(){if(0!=this.numElementsD){var t=this.axesD[this.index1],i=this.axesD[this.index2];t.sort(),i.sort();var e,s,n=t.calculateTestCount(),o=i.calculateTestCount();o>=n?(i=this.axesS[this.index1],i.sort(),e=t.elements,s=i.elements):(t=this.axesS[this.index2],t.sort(),e=i.elements,s=t.elements,this.index1^=this.index2,this.index2^=this.index1,this.index1^=this.index2);for(var r,a,h=0,l=0;h<this.numElementsD;){var u,c;if(l==this.numElementsS)u=e[h],c=!0,h++;else{var p=e[h],d=s[l];p.value<d.value?(u=p,c=!0,h++):(u=d,c=!1,l++)}if(u.max){var m=u.pair;if(c){if(m==r){r=r.pair;continue}u=r}else{if(m==a){a=a.pair;continue}u=a}do{if(b=u.pair,b==m){u.pair=b.pair;break}u=b}while(null!=u)}else{for(var f=u.proxy.shape,y=u.min1.value,x=u.max1.value,v=u.min2.value,g=u.max2.value,b=r;null!=b;b=b.pair){var N=b.proxy.shape;this.numPairChecks++,y>b.max1.value||x<b.min1.value||v>b.max2.value||g<b.min2.value||!this.isAvailablePair(f,N)||this.addPair(f,N)}if(c){for(b=a;null!=b;b=b.pair)N=b.proxy.shape,this.numPairChecks++,y>b.max1.value||x<b.min1.value||v>b.max2.value||g<b.min2.value||!this.isAvailablePair(f,N)||this.addPair(f,N);u.pair=r,r=u}else u.pair=a,a=u}}this.index2=3^(this.index1|this.index2)}},s.SAPElement=function(t,i){this.proxy=t,this.pair=null,this.min1=null,this.max1=null,this.min2=null,this.max2=null,this.max=i,this.value=0},s.SAPProxy=function(t,i){s.Proxy.call(this,i),this.belongsTo=0,this.max=[],this.min=[],this.sap=t,this.min[0]=new s.SAPElement(this,!1),this.max[0]=new s.SAPElement(this,!0),this.min[1]=new s.SAPElement(this,!1),this.max[1]=new s.SAPElement(this,!0),this.min[2]=new s.SAPElement(this,!1),this.max[2]=new s.SAPElement(this,!0),this.max[0].pair=this.min[0],this.max[1].pair=this.min[1],this.max[2].pair=this.min[2],this.min[0].min1=this.min[1],this.min[0].max1=this.max[1],this.min[0].min2=this.min[2],this.min[0].max2=this.max[2],this.min[1].min1=this.min[0],this.min[1].max1=this.max[0],this.min[1].min2=this.min[2],this.min[1].max2=this.max[2],this.min[2].min1=this.min[0],this.min[2].max1=this.max[0],this.min[2].min2=this.min[1],this.min[2].max2=this.max[1]},s.SAPProxy.prototype=Object.create(s.Proxy.prototype),s.SAPProxy.prototype.constructor=s.SAPProxy,s.SAPProxy.prototype.isDynamic=function(){var t=this.shape.parent;return t.isDynamic&&!t.sleeping},s.SAPProxy.prototype.update=function(){var t=this.aabb.elements;this.min[0].value=t[0],this.min[1].value=t[1],this.min[2].value=t[2],this.max[0].value=t[3],this.max[1].value=t[4],this.max[2].value=t[5],(1==this.belongsTo&&!this.isDynamic()||2==this.belongsTo&&this.isDynamic())&&(this.sap.removeProxy(this),this.sap.addProxy(this))},s.DBVT=function(){this.root=null,this.freeNodes=[],this.freeNodes.length=16384,this.numFreeNodes=0,this.aabb=new s.AABB},s.DBVT.prototype={constructor:s.DBVT,moveLeaf:function(t){this.deleteLeaf(t),this.insertLeaf(t)},insertLeaf:function(t){if(null==this.root)return void(this.root=t);for(var i,e,n=t.aabb,o=this.root;null==o.proxy;){var r=o.child1,a=o.child2,h=o.aabb,l=r.aabb,u=a.aabb;i=h.surfaceArea(),this.aabb.combine(n,h),e=this.aabb.surfaceArea();var c=2*e,p=2*(e-i),d=p;this.aabb.combine(n,l),d+=null!=r.proxy?this.aabb.surfaceArea():this.aabb.surfaceArea()-l.surfaceArea();var m=p;if(this.aabb.combine(n,u),m+=null!=a.proxy?this.aabb.surfaceArea():this.aabb.surfaceArea()-u.surfaceArea(),m>d){if(d>c)break;o=r}else{if(m>c)break;o=a}}var f,y=o.parent;f=this.numFreeNodes>0?this.freeNodes[--this.numFreeNodes]:new s.DBVTNode,f.parent=y,f.child1=t,f.child2=o,f.aabb.combine(t.aabb,o.aabb),f.height=o.height+1,o.parent=f,t.parent=f,o==this.root?this.root=f:y.child1==o?y.child1=f:y.child2=f;do f=this.balance(f),this.fix(f),f=f.parent;while(null!=f)},getBalance:function(t){return null!=t.proxy?0:t.child1.height-t.child2.height},deleteLeaf:function(t){if(t==this.root)return void(this.root=null);var i,e=t.parent;if(i=e.child1==t?e.child2:e.child1,e==this.root)return this.root=i,void(i.parent=null);var s=e.parent;i.parent=s,s.child1==e?s.child1=i:s.child2=i,this.numFreeNodes<16384&&(this.freeNodes[this.numFreeNodes++]=e);do s=this.balance(s),this.fix(s),s=s.parent;while(null!=s)},balance:function n(t){var i=t.height;if(2>i)return t;var e,s=t.parent,o=t.child1,r=t.child2,a=o.height,h=r.height,n=a-h;if(n>1){var l=o.child1,u=o.child2,c=l.height,p=u.height;return c>p?(o.child2=t,t.parent=o,t.child1=u,u.parent=t,t.aabb.combine(u.aabb,r.aabb),e=p-h,t.height=p-(e&e>>31)+1,o.aabb.combine(l.aabb,t.aabb),e=c-i,o.height=c-(e&e>>31)+1):(o.child1=t,t.parent=o,t.child1=l,l.parent=t,t.aabb.combine(l.aabb,r.aabb),e=c-h,t.height=c-(e&e>>31)+1,o.aabb.combine(t.aabb,u.aabb),e=i-p,o.height=i-(e&e>>31)+1),null!=s?s.child1==t?s.child1=o:s.child2=o:this.root=o,o.parent=s,o}if(-1>n){var d=r.child1,m=r.child2,f=d.height,y=m.height;return f>y?(r.child2=t,t.parent=r,t.child2=m,m.parent=t,t.aabb.combine(o.aabb,m.aabb),e=a-y,t.height=a-(e&e>>31)+1,r.aabb.combine(d.aabb,t.aabb),e=f-i,r.height=f-(e&e>>31)+1):(r.child1=t,t.parent=r,t.child2=d,d.parent=t,t.aabb.combine(o.aabb,d.aabb),e=a-f,t.height=a-(e&e>>31)+1,r.aabb.combine(t.aabb,m.aabb),e=i-y,r.height=i-(e&e>>31)+1),null!=s?s.child1==t?s.child1=r:s.child2=r:this.root=r,r.parent=s,r}return t},fix:function(t){var i=t.child1,e=t.child2;t.aabb.combine(i.aabb,e.aabb),t.height=i.height<e.height?e.height+1:i.height+1}},s.DBVTBroadPhase=function(){s.BroadPhase.call(this),this.types=s.BR_BOUNDING_VOLUME_TREE,this.tree=new s.DBVT,this.stack=[],this.leaves=[],this.numLeaves=0},s.DBVTBroadPhase.prototype=Object.create(s.BroadPhase.prototype),s.DBVTBroadPhase.prototype.constructor=s.DBVTBroadPhase,s.DBVTBroadPhase.prototype.createProxy=function(t){return new s.DBVTProxy(t)},s.DBVTBroadPhase.prototype.addProxy=function(t){this.tree.insertLeaf(t.leaf),this.leaves.push(t.leaf),this.numLeaves++},s.DBVTBroadPhase.prototype.removeProxy=function(t){this.tree.deleteLeaf(t.leaf);var i=this.leaves.indexOf(t.leaf);i>-1&&(this.leaves.splice(i,1),this.numLeaves--)},s.DBVTBroadPhase.prototype.collectPairs=function(){if(!(this.numLeaves<2))for(var t,i=.1,e=this.numLeaves;e--;)t=this.leaves[e],t.proxy.aabb.intersectTestTwo(t.aabb)&&(t.aabb.copy(t.proxy.aabb,i),this.tree.deleteLeaf(t),this.tree.insertLeaf(t),this.collide(t,this.tree.root))},s.DBVTBroadPhase.prototype.collide=function(t,i){var e,s,n,o,r,a,h=2;for(this.stack[0]=t,this.stack[1]=i;h>0;)if(n=this.stack[--h],o=this.stack[--h],r=null!=n.proxy,a=null!=o.proxy,this.numPairChecks++,r&&a){if(e=n.proxy.shape,s=o.proxy.shape,e==s||e.aabb.intersectTest(s.aabb)||!this.isAvailablePair(e,s))continue;this.addPair(e,s)}else{if(n.aabb.intersectTest(o.aabb))continue;a||!r&&n.aabb.surfaceArea()>o.aabb.surfaceArea()?(this.stack[h++]=n.child1,this.stack[h++]=o,this.stack[h++]=n.child2,this.stack[h++]=o):(this.stack[h++]=n,this.stack[h++]=o.child1,this.stack[h++]=n,this.stack[h++]=o.child2)}},s.DBVTNode=function(){this.child1=null,this.child2=null,this.parent=null,this.proxy=null,this.height=0,this.aabb=new s.AABB},s.DBVTProxy=function(t){s.Proxy.call(this,t),this.leaf=new s.DBVTNode,this.leaf.proxy=this},s.DBVTProxy.prototype=Object.create(s.Proxy.prototype),s.DBVTProxy.prototype.constructor=s.DBVTProxy,s.DBVTProxy.prototype.update=function(){},s.World.prototype.add=function(t){t=t||{};var i=t.type||"box";if("string"==typeof i&&(i=[i]),"joint"==i[0].substring(0,5)){"joint"===i[0]&&(i[0]="jointHinge");var e=t.axe1||[1,0,0],n=t.axe2||[1,0,0],o=t.pos1||[0,0,0],r=t.pos2||[0,0,0];o=o.map(function(t){return t*s.INV_SCALE}),r=r.map(function(t){return t*s.INV_SCALE});var a,h;"jointDistance"===i[0]?(a=t.min||0,h=t.max||10,a*=s.INV_SCALE,h*=s.INV_SCALE):(a=t.min||57.29578,h=t.max||0,a*=s.degtorad,h*=s.degtorad);var l=t.limit||null,u=t.spring||null,c=t.motor||null,p=new s.JointConfig;p.allowCollision=t.collision||!1,p.localAxis1.init(e[0],e[1],e[2]),p.localAxis2.init(n[0],n[1],n[2]),p.localAnchorPoint1.init(o[0],o[1],o[2]),p.localAnchorPoint2.init(r[0],r[1],r[2]),("string"==typeof t.body1||t.body1 instanceof String)&&(t.body1=this.getByName(t.body1)),("string"==typeof t.body2||t.body2 instanceof String)&&(t.body2=this.getByName(t.body2)),p.body1=t.body1,p.body2=t.body2;var d;switch(i[0]){case"jointDistance":d=new s.DistanceJoint(p,a,h),null!==u&&d.limitMotor.setSpring(u[0],u[1]),null!==c&&d.limitMotor.setSpring(c[0],c[1]);break;case"jointHinge":d=new s.HingeJoint(p,a,h),null!==u&&d.limitMotor.setSpring(u[0],u[1]),null!==c&&d.limitMotor.setSpring(c[0],c[1]);break;case"jointPrisme":d=new s.PrismaticJoint(p,a,h);break;case"jointSlide":d=new s.SliderJoint(p,a,h);break;case"jointBall":d=new s.BallAndSocketJoint(p);break;case"jointWheel":d=new s.WheelJoint(p),null!==l&&d.rotationalLimitMotor1.setLimit(l[0],l[1]),null!==u&&d.rotationalLimitMotor1.setSpring(u[0],u[1]),null!==c&&d.rotationalLimitMotor1.setSpring(c[0],c[1])}return d.name=t.name||"",this.addJoint(d),d}var m=t.move||!1,f=t.noSleep||!1,y=t.pos||[0,0,0];y=y.map(function(t){return t*s.INV_SCALE});var x=t.size||[1,1,1];x=x.map(function(t){return t*s.INV_SCALE});var v=t.rot||[0,0,0];v=v.map(function(t){return t*s.degtorad});for(var g=[],b=0;b<v.length/3;b++){var N=s.EulerToAxis(v[b+0],v[b+1],v[b+2]);g.push(N[0]),g.push(N[1]),g.push(N[2]),g.push(N[3])}var C=new s.ShapeConfig;void 0!==t.sc&&(C=t.sc),t.config&&(C.density=void 0===t.config[0]?1:t.config[0],C.friction=void 0===t.config[1]?.4:t.config[1],C.restitution=void 0===t.config[2]?.2:t.config[2],C.belongsTo=t.config[3]||1,C.collidesWith=t.config[4]||4294967295),void 0!==t.density&&(C.density=t.density),void 0!==t.friction&&(C.friction=t.friction),void 0!==t.restitution&&(C.restitution=t.restitution),void 0!==t.belongsTo&&(C.belongsTo=t.belongsTo),void 0!==t.collidesWith&&(C.collidesWith=t.collidesWith),t.massPos&&(t.massPos=t.massPos.map(function(t){return t*s.INV_SCALE}),C.relativePosition.init(t.massPos[0],t.massPos[1],t.massPos[2])),t.massRot&&(t.massRot=t.massRot.map(function(t){return t*s.degtorad}),C.relativeRotation=s.EulerToMatrix(t.massRot[0],t.massRot[1],t.massRot[2]));for(var P,A,S=new s.RigidBody(y[0],y[1],y[2],g[0],g[1],g[2],g[3]),k=[],b=0;b<i.length;b++){switch(P=3*b,A=4*b,i[b]){case"sphere":k[b]=new s.SphereShape(C,x[P]);break;case"cylinder":k[b]=new s.CylinderShape(C,x[P],x[P+1]);break;case"box":k[b]=new s.BoxShape(C,x[P],x[P+1],x[P+2])}S.addShape(k[b]),b>0&&(k[b].relativePosition=new s.Vec3(y[P],y[P+1],y[P+2]),g[A+0]&&(k[b].relativeRotation=[g[A],g[A+1],g[A+2],g[A+3]]))}return m?(t.massPos||t.massRot?S.setupMass(1,!1):S.setupMass(1,!0),f?S.allowSleep=!1:S.allowSleep=!0):S.setupMass(2),S.name=t.name||" ",this.addRigidBody(S),S},i["default"]=s},function(t,i){"use strict";var e=Object.assign||function(t){for(var i=1;i<arguments.length;i++){var e=arguments[i];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t};Object.defineProperty(i,"__esModule",{value:!0});var s=i.Vec3={add:function(t,i){return{x:t.x+i.x,y:t.y+i.y,z:t.z+i.z}},scale:function(t,i){return{x:i*t.x,y:i*t.y,z:i*t.z}}},n=i.Quat={scale:function(t,i){return{x:i*t.x,y:i*t.y,z:i*t.z,w:i*t.w}},mult:function(t,i){return{x:t.x*i.w+t.w*i.x+t.y*i.z-t.z*i.y,y:t.y*i.w+t.w*i.y+t.z*i.x-t.x*i.z,z:t.z*i.w+t.w*i.z+t.x*i.y-t.y*i.x,w:t.w*i.w-t.x*i.x-t.y*i.y-t.z*i.z}},conjugate:function(t){return{x:-x,y:-y,z:-z,w:w}},toEuler:function(t){var i=t.x,e=t.y,s=t.z,n=t.w;return{x:Math.atan2(2*(i*e+s*n),1-2*(e*e+s*s)),y:Math.asin(2*(i*s-n*e)),z:Math.atan2(2*(i*n+e*s),1-2*(s*s+n*n))}}},o=i.Pose={translate:s.add,rotate3:function(t,i){var s=e({},t,{w:1});return n.mult(n.mult(i,s),n.conjugate(i))}};i["default"]={Vec3:s,Quat:n,Pose:o}},function(t,i,e){"use strict";var s=e(5),n=e(40),o=e(80),r={componentDidMount:function(){this.props.autoFocus&&o(n(this))}},a={Mixin:r,focusDOMComponent:function(){o(s.getNode(this._rootNodeID))}};t.exports=a},function(t,i,e){"use strict";function s(){var t=window.opera;return"object"==typeof t&&"function"==typeof t.version&&parseInt(t.version(),10)<=12}function n(t){return(t.ctrlKey||t.altKey||t.metaKey)&&!(t.ctrlKey&&t.altKey)}function o(t){switch(t){case z.topCompositionStart:return _.compositionStart;case z.topCompositionEnd:return _.compositionEnd;case z.topCompositionUpdate:return _.compositionUpdate}}function r(t,i){return t===z.topKeyDown&&i.keyCode===N}function a(t,i){switch(t){case z.topKeyUp:return-1!==b.indexOf(i.keyCode);case z.topKeyDown:return i.keyCode!==N;case z.topKeyPress:case z.topMouseDown:case z.topBlur:return!0;default:return!1}}function h(t){var i=t.detail;return"object"==typeof i&&"data"in i?i.data:null}function l(t,i,e,s,n){var l,u;if(C?l=o(t):E?a(t,s)&&(l=_.compositionEnd):r(t,s)&&(l=_.compositionStart),!l)return null;S&&(E||l!==_.compositionStart?l===_.compositionEnd&&E&&(u=E.getData()):E=y.getPooled(i));var c=x.getPooled(l,e,s,n);if(u)c.data=u;else{var p=h(s);null!==p&&(c.data=p)}return m.accumulateTwoPhaseDispatches(c),c}function u(t,i){switch(t){case z.topCompositionEnd:return h(i);case z.topKeyPress:var e=i.which;return e!==k?null:(M=!0,I);case z.topTextInput:var s=i.data;return s===I&&M?null:s;default:return null}}function c(t,i){if(E){if(t===z.topCompositionEnd||a(t,i)){var e=E.getData();return y.release(E),E=null,e}return null}switch(t){case z.topPaste:return null;case z.topKeyPress:return i.which&&!n(i)?String.fromCharCode(i.which):null;case z.topCompositionEnd:return S?null:i.data;default:return null}}function p(t,i,e,s,n){var o;if(o=A?u(t,s):c(t,s),!o)return null;var r=v.getPooled(_.beforeInput,e,s,n);return r.data=o,m.accumulateTwoPhaseDispatches(r),r}var d=e(10),m=e(19),f=e(4),y=e(97),x=e(128),v=e(131),g=e(13),b=[9,13,27,32],N=229,C=f.canUseDOM&&"CompositionEvent"in window,P=null;f.canUseDOM&&"documentMode"in document&&(P=document.documentMode);var A=f.canUseDOM&&"TextEvent"in window&&!P&&!s(),S=f.canUseDOM&&(!C||P&&P>8&&11>=P),k=32,I=String.fromCharCode(k),z=d.topLevelTypes,_={beforeInput:{phasedRegistrationNames:{bubbled:g({onBeforeInput:null}),captured:g({onBeforeInputCapture:null})},dependencies:[z.topCompositionEnd,z.topKeyPress,z.topTextInput,z.topPaste]},compositionEnd:{phasedRegistrationNames:{bubbled:g({onCompositionEnd:null}),captured:g({onCompositionEndCapture:null})},dependencies:[z.topBlur,z.topCompositionEnd,z.topKeyDown,z.topKeyPress,z.topKeyUp,z.topMouseDown]},compositionStart:{phasedRegistrationNames:{bubbled:g({onCompositionStart:null}),captured:g({onCompositionStartCapture:null})},dependencies:[z.topBlur,z.topCompositionStart,z.topKeyDown,z.topKeyPress,z.topKeyUp,z.topMouseDown]},compositionUpdate:{phasedRegistrationNames:{bubbled:g({onCompositionUpdate:null}),captured:g({onCompositionUpdateCapture:null})},dependencies:[z.topBlur,z.topCompositionUpdate,z.topKeyDown,z.topKeyPress,z.topKeyUp,z.topMouseDown]}},M=!1,E=null,w={eventTypes:_,extractEvents:function(t,i,e,s,n){return[l(t,i,e,s,n),p(t,i,e,s,n)]}};t.exports=w},function(t,i,e){"use strict";var s=e(51),n=e(4),o=e(7),r=(e(145),e(136)),a=e(150),h=e(154),l=(e(3),h(function(t){return a(t)})),u=!1,c="cssFloat";if(n.canUseDOM){var p=document.createElement("div").style;try{p.font=""}catch(d){u=!0}void 0===document.documentElement.style.cssFloat&&(c="styleFloat")}var m={createMarkupForStyles:function(t){var i="";for(var e in t)if(t.hasOwnProperty(e)){var s=t[e];null!=s&&(i+=l(e)+":",i+=r(e,s)+";")}return i||null},setValueForStyles:function(t,i){var e=t.style;for(var n in i)if(i.hasOwnProperty(n)){var o=r(n,i[n]);if("float"===n&&(n=c),o)e[n]=o;else{var a=u&&s.shorthandPropertyExpansions[n];if(a)for(var h in a)e[h]="";else e[n]=""}}}};o.measureMethods(m,"CSSPropertyOperations",{setValueForStyles:"setValueForStyles"}),t.exports=m},function(t,i,e){"use strict";function s(t){var i=t.nodeName&&t.nodeName.toLowerCase();return"select"===i||"input"===i&&"file"===t.type}function n(t){var i=P.getPooled(_.change,E,t,A(t));b.accumulateTwoPhaseDispatches(i),C.batchedUpdates(o,i)}function o(t){g.enqueueEvents(t),g.processEventQueue(!1)}function r(t,i){M=t,E=i,M.attachEvent("onchange",n)}function a(){M&&(M.detachEvent("onchange",n),M=null,E=null)}function h(t,i,e){return t===z.topChange?e:void 0}function l(t,i,e){t===z.topFocus?(a(),r(i,e)):t===z.topBlur&&a()}function u(t,i){M=t,E=i,w=t.value,D=Object.getOwnPropertyDescriptor(t.constructor.prototype,"value"),Object.defineProperty(M,"value",R),M.attachEvent("onpropertychange",p)}function c(){M&&(delete M.value,M.detachEvent("onpropertychange",p),M=null,E=null,w=null,D=null)}function p(t){if("value"===t.propertyName){var i=t.srcElement.value;i!==w&&(w=i,n(t))}}function d(t,i,e){return t===z.topInput?e:void 0}function m(t,i,e){t===z.topFocus?(c(),u(i,e)):t===z.topBlur&&c()}function f(t,i,e){return t!==z.topSelectionChange&&t!==z.topKeyUp&&t!==z.topKeyDown||!M||M.value===w?void 0:(w=M.value,E)}function y(t){return t.nodeName&&"input"===t.nodeName.toLowerCase()&&("checkbox"===t.type||"radio"===t.type)}function x(t,i,e){return t===z.topClick?e:void 0}var v=e(10),g=e(18),b=e(19),N=e(4),C=e(8),P=e(15),A=e(43),S=e(46),k=e(77),I=e(13),z=v.topLevelTypes,_={change:{phasedRegistrationNames:{bubbled:I({onChange:null}),captured:I({onChangeCapture:null})},dependencies:[z.topBlur,z.topChange,z.topClick,z.topFocus,z.topInput,z.topKeyDown,z.topKeyUp,z.topSelectionChange]}},M=null,E=null,w=null,D=null,T=!1;N.canUseDOM&&(T=S("change")&&(!("documentMode"in document)||document.documentMode>8));var L=!1;N.canUseDOM&&(L=S("input")&&(!("documentMode"in document)||document.documentMode>9));var R={get:function(){return D.get.call(this)},set:function(t){w=""+t,D.set.call(this,t)}},O={eventTypes:_,extractEvents:function(t,i,e,n,o){var r,a;if(s(i)?T?r=h:a=l:k(i)?L?r=d:(r=f,a=m):y(i)&&(r=x),r){var u=r(t,i,e);if(u){var c=P.getPooled(_.change,u,n,o);return c.type="change",b.accumulateTwoPhaseDispatches(c),c}}a&&a(t,i,e)}};t.exports=O},function(t,i){"use strict";var e=0,s={createReactRootIndex:function(){return e++}};t.exports=s},function(t,i,e){"use strict";function s(t){return t.substring(1,t.indexOf(" "))}var n=e(4),o=e(147),r=e(9),a=e(82),h=e(1),l=/^(<[^ \/>]+)/,u="data-danger-index",c={dangerouslyRenderMarkup:function(t){n.canUseDOM?void 0:h(!1);for(var i,e={},c=0;c<t.length;c++)t[c]?void 0:h(!1),i=s(t[c]),i=a(i)?i:"*",e[i]=e[i]||[],e[i][c]=t[c];var p=[],d=0;for(i in e)if(e.hasOwnProperty(i)){var m,f=e[i];for(m in f)if(f.hasOwnProperty(m)){var y=f[m];f[m]=y.replace(l,"$1 "+u+'="'+m+'" ')}for(var x=o(f.join(""),r),v=0;v<x.length;++v){var g=x[v];g.hasAttribute&&g.hasAttribute(u)&&(m=+g.getAttribute(u),g.removeAttribute(u),p.hasOwnProperty(m)?h(!1):void 0,p[m]=g,d+=1)}}return d!==p.length?h(!1):void 0,p.length!==t.length?h(!1):void 0,p},dangerouslyReplaceNodeWithMarkup:function(t,i){n.canUseDOM?void 0:h(!1),i?void 0:h(!1),"html"===t.tagName.toLowerCase()?h(!1):void 0;var e;e="string"==typeof i?o(i,r)[0]:i,t.parentNode.replaceChild(e,t)}};t.exports=c},function(t,i,e){"use strict";var s=e(13),n=[s({ResponderEventPlugin:null}),s({SimpleEventPlugin:null}),s({TapEventPlugin:null}),s({EnterLeaveEventPlugin:null}),s({ChangeEventPlugin:null}),s({SelectEventPlugin:null}),s({BeforeInputEventPlugin:null})];t.exports=n},function(t,i,e){"use strict";var s=e(10),n=e(19),o=e(26),r=e(5),a=e(13),h=s.topLevelTypes,l=r.getFirstReactDOM,u={mouseEnter:{registrationName:a({onMouseEnter:null}),dependencies:[h.topMouseOut,h.topMouseOver]},mouseLeave:{registrationName:a({onMouseLeave:null}),dependencies:[h.topMouseOut,h.topMouseOver]}},c=[null,null],p={eventTypes:u,extractEvents:function(t,i,e,s,a){if(t===h.topMouseOver&&(s.relatedTarget||s.fromElement))return null;if(t!==h.topMouseOut&&t!==h.topMouseOver)return null;var p;if(i.window===i)p=i;else{var d=i.ownerDocument;p=d?d.defaultView||d.parentWindow:window}var m,f,y="",x="";if(t===h.topMouseOut?(m=i,y=e,f=l(s.relatedTarget||s.toElement),f?x=r.getID(f):f=p,f=f||p):(m=p,f=i,x=e),m===f)return null;var v=o.getPooled(u.mouseLeave,y,s,a);v.type="mouseleave",v.target=m,v.relatedTarget=f;var g=o.getPooled(u.mouseEnter,x,s,a);return g.type="mouseenter",g.target=f,g.relatedTarget=m,n.accumulateEnterLeaveDispatches(v,g,y,x),c[0]=v,c[1]=g,c}};t.exports=p},function(t,i,e){"use strict";function s(t){return t===y.topMouseUp||t===y.topTouchEnd||t===y.topTouchCancel}function n(t){return t===y.topMouseMove||t===y.topTouchMove}function o(t){return t===y.topMouseDown||t===y.topTouchStart}function r(t,i,e,s){var n=t.type||"unknown-event";t.currentTarget=f.Mount.getNode(s),i?d.invokeGuardedCallbackWithCatch(n,e,t,s):d.invokeGuardedCallback(n,e,t,s),t.currentTarget=null}function a(t,i){var e=t._dispatchListeners,s=t._dispatchIDs;if(Array.isArray(e))for(var n=0;n<e.length&&!t.isPropagationStopped();n++)r(t,i,e[n],s[n]);else e&&r(t,i,e,s);
t._dispatchListeners=null,t._dispatchIDs=null}function h(t){var i=t._dispatchListeners,e=t._dispatchIDs;if(Array.isArray(i)){for(var s=0;s<i.length&&!t.isPropagationStopped();s++)if(i[s](t,e[s]))return e[s]}else if(i&&i(t,e))return e;return null}function l(t){var i=h(t);return t._dispatchIDs=null,t._dispatchListeners=null,i}function u(t){var i=t._dispatchListeners,e=t._dispatchIDs;Array.isArray(i)?m(!1):void 0;var s=i?i(t,e):null;return t._dispatchListeners=null,t._dispatchIDs=null,s}function c(t){return!!t._dispatchListeners}var p=e(10),d=e(65),m=e(1),f=(e(3),{Mount:null,injectMount:function(t){f.Mount=t}}),y=p.topLevelTypes,x={isEndish:s,isMoveish:n,isStartish:o,executeDirectDispatch:u,executeDispatchesInOrder:a,executeDispatchesInOrderStopAtTrue:l,hasDispatches:c,getNode:function(t){return f.Mount.getNode(t)},getID:function(t){return f.Mount.getID(t)},injection:f};t.exports=x},function(t,i,e){"use strict";function s(t){this._root=t,this._startText=this.getText(),this._fallbackText=null}var n=e(12),o=e(2),r=e(76);o(s.prototype,{destructor:function(){this._root=null,this._startText=null,this._fallbackText=null},getText:function(){return"value"in this._root?this._root.value:this._root[r()]},getData:function(){if(this._fallbackText)return this._fallbackText;var t,i,e=this._startText,s=e.length,n=this.getText(),o=n.length;for(t=0;s>t&&e[t]===n[t];t++);var r=s-t;for(i=1;r>=i&&e[s-i]===n[o-i];i++);var a=i>1?1-i:void 0;return this._fallbackText=n.slice(t,a),this._fallbackText}}),n.addPoolingTo(s),t.exports=s},function(t,i,e){"use strict";var s,n=e(16),o=e(4),r=n.injection.MUST_USE_ATTRIBUTE,a=n.injection.MUST_USE_PROPERTY,h=n.injection.HAS_BOOLEAN_VALUE,l=n.injection.HAS_SIDE_EFFECTS,u=n.injection.HAS_NUMERIC_VALUE,c=n.injection.HAS_POSITIVE_NUMERIC_VALUE,p=n.injection.HAS_OVERLOADED_BOOLEAN_VALUE;if(o.canUseDOM){var d=document.implementation;s=d&&d.hasFeature&&d.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")}var m={isCustomAttribute:RegExp.prototype.test.bind(/^(data|aria)-[a-z_][a-z\d_.\-]*$/),Properties:{accept:null,acceptCharset:null,accessKey:null,action:null,allowFullScreen:r|h,allowTransparency:r,alt:null,async:h,autoComplete:null,autoPlay:h,capture:r|h,cellPadding:null,cellSpacing:null,charSet:r,challenge:r,checked:a|h,classID:r,className:s?r:a,cols:r|c,colSpan:null,content:null,contentEditable:null,contextMenu:r,controls:a|h,coords:null,crossOrigin:null,data:null,dateTime:r,"default":h,defer:h,dir:null,disabled:r|h,download:p,draggable:null,encType:null,form:r,formAction:r,formEncType:r,formMethod:r,formNoValidate:h,formTarget:r,frameBorder:r,headers:null,height:r,hidden:r|h,high:null,href:null,hrefLang:null,htmlFor:null,httpEquiv:null,icon:null,id:a,inputMode:r,integrity:null,is:r,keyParams:r,keyType:r,kind:null,label:null,lang:null,list:r,loop:a|h,low:null,manifest:r,marginHeight:null,marginWidth:null,max:null,maxLength:r,media:r,mediaGroup:null,method:null,min:null,minLength:r,multiple:a|h,muted:a|h,name:null,nonce:r,noValidate:h,open:h,optimum:null,pattern:null,placeholder:null,poster:null,preload:null,radioGroup:null,readOnly:a|h,rel:null,required:h,reversed:h,role:r,rows:r|c,rowSpan:null,sandbox:null,scope:null,scoped:h,scrolling:null,seamless:r|h,selected:a|h,shape:null,size:r|c,sizes:r,span:c,spellCheck:null,src:null,srcDoc:a,srcLang:null,srcSet:r,start:u,step:null,style:null,summary:null,tabIndex:null,target:null,title:null,type:null,useMap:null,value:a|l,width:r,wmode:r,wrap:null,about:r,datatype:r,inlist:r,prefix:r,property:r,resource:r,"typeof":r,vocab:r,autoCapitalize:null,autoCorrect:null,autoSave:null,color:null,itemProp:r,itemScope:r|h,itemType:r,itemID:r,itemRef:r,results:null,security:r,unselectable:r},DOMAttributeNames:{acceptCharset:"accept-charset",className:"class",htmlFor:"for",httpEquiv:"http-equiv"},DOMPropertyNames:{autoCapitalize:"autocapitalize",autoComplete:"autocomplete",autoCorrect:"autocorrect",autoFocus:"autofocus",autoPlay:"autoplay",autoSave:"autosave",encType:"encoding",hrefLang:"hreflang",radioGroup:"radiogroup",spellCheck:"spellcheck",srcDoc:"srcdoc",srcSet:"srcset"}};t.exports=m},function(t,i,e){"use strict";var s=e(103),n=e(110),o=e(115),r=e(2),a=e(137),h={};r(h,o),r(h,{findDOMNode:a("findDOMNode","ReactDOM","react-dom",s,s.findDOMNode),render:a("render","ReactDOM","react-dom",s,s.render),unmountComponentAtNode:a("unmountComponentAtNode","ReactDOM","react-dom",s,s.unmountComponentAtNode),renderToString:a("renderToString","ReactDOMServer","react-dom/server",n,n.renderToString),renderToStaticMarkup:a("renderToStaticMarkup","ReactDOMServer","react-dom/server",n,n.renderToStaticMarkup)}),h.__SECRET_DOM_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=s,h.__SECRET_DOM_SERVER_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=n,t.exports=h},function(t,i,e){"use strict";var s=(e(20),e(40)),n=(e(3),"_getDOMNodeDidWarn"),o={getDOMNode:function(){return this.constructor[n]=!0,s(this)}};t.exports=o},function(t,i,e){"use strict";function s(t,i,e){var s=void 0===t[e];null!=i&&s&&(t[e]=o(i,null))}var n=e(14),o=e(45),r=e(48),a=e(49),h=(e(3),{instantiateChildren:function(t,i,e){if(null==t)return null;var n={};return a(t,s,n),n},updateChildren:function(t,i,e,s){if(!i&&!t)return null;var a;for(a in i)if(i.hasOwnProperty(a)){var h=t&&t[a],l=h&&h._currentElement,u=i[a];if(null!=h&&r(l,u))n.receiveComponent(h,u,e,s),i[a]=h;else{h&&n.unmountComponent(h,a);var c=o(u,null);i[a]=c}}for(a in t)!t.hasOwnProperty(a)||i&&i.hasOwnProperty(a)||n.unmountComponent(t[a]);return i},unmountChildren:function(t){for(var i in t)if(t.hasOwnProperty(i)){var e=t[i];n.unmountComponent(e)}}});t.exports=h},function(t,i,e){"use strict";function s(t){var i=t._currentElement._owner||null;if(i){var e=i.getName();if(e)return" Check the render method of `"+e+"`."}return""}function n(t){}var o=e(36),r=e(11),a=e(6),h=e(20),l=e(7),u=e(25),c=(e(24),e(14)),p=e(38),d=e(2),m=e(22),f=e(1),y=e(48);e(3);n.prototype.render=function(){var t=h.get(this)._currentElement.type;return t(this.props,this.context,this.updater)};var x=1,v={construct:function(t){this._currentElement=t,this._rootNodeID=null,this._instance=null,this._pendingElement=null,this._pendingStateQueue=null,this._pendingReplaceState=!1,this._pendingForceUpdate=!1,this._renderedComponent=null,this._context=null,this._mountOrder=0,this._topLevelWrapper=null,this._pendingCallbacks=null},mountComponent:function(t,i,e){this._context=e,this._mountOrder=x++,this._rootNodeID=t;var s,o,r=this._processProps(this._currentElement.props),l=this._processContext(e),u=this._currentElement.type,d="prototype"in u;d&&(s=new u(r,l,p)),(!d||null===s||s===!1||a.isValidElement(s))&&(o=s,s=new n(u)),s.props=r,s.context=l,s.refs=m,s.updater=p,this._instance=s,h.set(s,this);var y=s.state;void 0===y&&(s.state=y=null),"object"!=typeof y||Array.isArray(y)?f(!1):void 0,this._pendingStateQueue=null,this._pendingReplaceState=!1,this._pendingForceUpdate=!1,s.componentWillMount&&(s.componentWillMount(),this._pendingStateQueue&&(s.state=this._processPendingState(s.props,s.context))),void 0===o&&(o=this._renderValidatedComponent()),this._renderedComponent=this._instantiateReactComponent(o);var v=c.mountComponent(this._renderedComponent,t,i,this._processChildContext(e));return s.componentDidMount&&i.getReactMountReady().enqueue(s.componentDidMount,s),v},unmountComponent:function(){var t=this._instance;t.componentWillUnmount&&t.componentWillUnmount(),c.unmountComponent(this._renderedComponent),this._renderedComponent=null,this._instance=null,this._pendingStateQueue=null,this._pendingReplaceState=!1,this._pendingForceUpdate=!1,this._pendingCallbacks=null,this._pendingElement=null,this._context=null,this._rootNodeID=null,this._topLevelWrapper=null,h.remove(t)},_maskContext:function(t){var i=null,e=this._currentElement.type,s=e.contextTypes;if(!s)return m;i={};for(var n in s)i[n]=t[n];return i},_processContext:function(t){var i=this._maskContext(t);return i},_processChildContext:function(t){var i=this._currentElement.type,e=this._instance,s=e.getChildContext&&e.getChildContext();if(s){"object"!=typeof i.childContextTypes?f(!1):void 0;for(var n in s)n in i.childContextTypes?void 0:f(!1);return d({},t,s)}return t},_processProps:function(t){return t},_checkPropTypes:function(t,i,e){var n=this.getName();for(var o in t)if(t.hasOwnProperty(o)){var r;try{"function"!=typeof t[o]?f(!1):void 0,r=t[o](i,o,n,e)}catch(a){r=a}if(r instanceof Error){s(this);e===u.prop}}},receiveComponent:function(t,i,e){var s=this._currentElement,n=this._context;this._pendingElement=null,this.updateComponent(i,s,t,n,e)},performUpdateIfNecessary:function(t){null!=this._pendingElement&&c.receiveComponent(this,this._pendingElement||this._currentElement,t,this._context),(null!==this._pendingStateQueue||this._pendingForceUpdate)&&this.updateComponent(t,this._currentElement,this._currentElement,this._context,this._context)},updateComponent:function(t,i,e,s,n){var o,r=this._instance,a=this._context===n?r.context:this._processContext(n);i===e?o=e.props:(o=this._processProps(e.props),r.componentWillReceiveProps&&r.componentWillReceiveProps(o,a));var h=this._processPendingState(o,a),l=this._pendingForceUpdate||!r.shouldComponentUpdate||r.shouldComponentUpdate(o,h,a);l?(this._pendingForceUpdate=!1,this._performComponentUpdate(e,o,h,a,t,n)):(this._currentElement=e,this._context=n,r.props=o,r.state=h,r.context=a)},_processPendingState:function(t,i){var e=this._instance,s=this._pendingStateQueue,n=this._pendingReplaceState;if(this._pendingReplaceState=!1,this._pendingStateQueue=null,!s)return e.state;if(n&&1===s.length)return s[0];for(var o=d({},n?s[0]:e.state),r=n?1:0;r<s.length;r++){var a=s[r];d(o,"function"==typeof a?a.call(e,o,t,i):a)}return o},_performComponentUpdate:function(t,i,e,s,n,o){var r,a,h,l=this._instance,u=Boolean(l.componentDidUpdate);u&&(r=l.props,a=l.state,h=l.context),l.componentWillUpdate&&l.componentWillUpdate(i,e,s),this._currentElement=t,this._context=o,l.props=i,l.state=e,l.context=s,this._updateRenderedComponent(n,o),u&&n.getReactMountReady().enqueue(l.componentDidUpdate.bind(l,r,a,h),l)},_updateRenderedComponent:function(t,i){var e=this._renderedComponent,s=e._currentElement,n=this._renderValidatedComponent();if(y(s,n))c.receiveComponent(e,n,t,this._processChildContext(i));else{var o=this._rootNodeID,r=e._rootNodeID;c.unmountComponent(e),this._renderedComponent=this._instantiateReactComponent(n);var a=c.mountComponent(this._renderedComponent,o,t,this._processChildContext(i));this._replaceNodeWithMarkupByID(r,a)}},_replaceNodeWithMarkupByID:function(t,i){o.replaceNodeWithMarkupByID(t,i)},_renderValidatedComponentWithoutOwnerOrContext:function(){var t=this._instance,i=t.render();return i},_renderValidatedComponent:function(){var t;r.current=this;try{t=this._renderValidatedComponentWithoutOwnerOrContext()}finally{r.current=null}return null===t||t===!1||a.isValidElement(t)?void 0:f(!1),t},attachRef:function(t,i){var e=this.getPublicInstance();null==e?f(!1):void 0;var s=i.getPublicInstance(),n=e.refs===m?e.refs={}:e.refs;n[t]=s},detachRef:function(t){var i=this.getPublicInstance().refs;delete i[t]},getName:function(){var t=this._currentElement.type,i=this._instance&&this._instance.constructor;return t.displayName||i&&i.displayName||t.name||i&&i.name||null},getPublicInstance:function(){var t=this._instance;return t instanceof n?null:t},_instantiateReactComponent:null};l.measureMethods(v,"ReactCompositeComponent",{mountComponent:"mountComponent",updateComponent:"updateComponent",_renderValidatedComponent:"_renderValidatedComponent"});var g={Mixin:v};t.exports=g},function(t,i,e){"use strict";var s=e(11),n=e(59),o=e(61),r=e(17),a=e(5),h=e(7),l=e(14),u=e(8),c=e(39),p=e(40),d=e(143);e(3);o.inject();var m=h.measure("React","render",a.render),f={findDOMNode:p,render:m,unmountComponentAtNode:a.unmountComponentAtNode,version:c,unstable_batchedUpdates:u.batchedUpdates,unstable_renderSubtreeIntoContainer:d};"undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.inject&&__REACT_DEVTOOLS_GLOBAL_HOOK__.inject({CurrentOwner:s,InstanceHandles:r,Mount:a,Reconciler:l,TextComponent:n});t.exports=f},function(t,i){"use strict";var e={onClick:!0,onDoubleClick:!0,onMouseDown:!0,onMouseMove:!0,onMouseUp:!0,onClickCapture:!0,onDoubleClickCapture:!0,onMouseDownCapture:!0,onMouseMoveCapture:!0,onMouseUpCapture:!0},s={getNativeProps:function(t,i,s){if(!i.disabled)return i;var n={};for(var o in i)i.hasOwnProperty(o)&&!e[o]&&(n[o]=i[o]);return n}};t.exports=s},function(t,i,e){"use strict";function s(){return this}function n(){var t=this._reactInternalComponent;return!!t}function o(){}function r(t,i){var e=this._reactInternalComponent;e&&(w.enqueueSetPropsInternal(e,t),i&&w.enqueueCallbackInternal(e,i))}function a(t,i){var e=this._reactInternalComponent;e&&(w.enqueueReplacePropsInternal(e,t),i&&w.enqueueCallbackInternal(e,i))}function h(t,i){i&&(null!=i.dangerouslySetInnerHTML&&(null!=i.children?R(!1):void 0,"object"==typeof i.dangerouslySetInnerHTML&&Z in i.dangerouslySetInnerHTML?void 0:R(!1)),null!=i.style&&"object"!=typeof i.style?R(!1):void 0)}function l(t,i,e,s){var n=_.findReactContainerForID(t);if(n){var o=n.nodeType===q?n.ownerDocument:n;F(i,o)}s.getReactMountReady().enqueue(u,{id:t,registrationName:i,listener:e})}function u(){var t=this;C.putListener(t.id,t.registrationName,t.listener)}function c(){var t=this;t._rootNodeID?void 0:R(!1);var i=_.getNode(t._rootNodeID);switch(i?void 0:R(!1),t._tag){case"iframe":t._wrapperState.listeners=[C.trapBubbledEvent(N.topLevelTypes.topLoad,"load",i)];break;case"video":case"audio":t._wrapperState.listeners=[];for(var e in H)H.hasOwnProperty(e)&&t._wrapperState.listeners.push(C.trapBubbledEvent(N.topLevelTypes[e],H[e],i));break;case"img":t._wrapperState.listeners=[C.trapBubbledEvent(N.topLevelTypes.topError,"error",i),C.trapBubbledEvent(N.topLevelTypes.topLoad,"load",i)];break;case"form":t._wrapperState.listeners=[C.trapBubbledEvent(N.topLevelTypes.topReset,"reset",i),C.trapBubbledEvent(N.topLevelTypes.topSubmit,"submit",i)]}}function p(){S.mountReadyWrapper(this)}function d(){I.postUpdateWrapper(this)}function m(t){$.call(G,t)||(Q.test(t)?void 0:R(!1),G[t]=!0)}function f(t,i){return t.indexOf("-")>=0||null!=i.is}function y(t){m(t),this._tag=t.toLowerCase(),this._renderedChildren=null,this._previousStyle=null,this._previousStyleCopy=null,this._rootNodeID=null,this._wrapperState=null,this._topLevelWrapper=null,this._nodeWithLegacyProperties=null}var x=e(88),v=e(90),g=e(16),b=e(33),N=e(10),C=e(23),P=e(35),A=e(104),S=e(107),k=e(108),I=e(58),z=e(111),_=e(5),M=e(116),E=e(7),w=e(38),D=e(2),T=e(28),L=e(29),R=e(1),O=(e(46),e(13)),V=e(30),B=e(47),U=(e(83),e(50),e(3),C.deleteListener),F=C.listenTo,j=C.registrationNameModules,Y={string:!0,number:!0},X=O({children:null}),W=O({style:null}),Z=O({__html:null}),q=1,H={topAbort:"abort",topCanPlay:"canplay",topCanPlayThrough:"canplaythrough",topDurationChange:"durationchange",topEmptied:"emptied",topEncrypted:"encrypted",topEnded:"ended",topError:"error",topLoadedData:"loadeddata",topLoadedMetadata:"loadedmetadata",topLoadStart:"loadstart",topPause:"pause",topPlay:"play",topPlaying:"playing",topProgress:"progress",topRateChange:"ratechange",topSeeked:"seeked",topSeeking:"seeking",topStalled:"stalled",topSuspend:"suspend",topTimeUpdate:"timeupdate",topVolumeChange:"volumechange",topWaiting:"waiting"},J={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},K={listing:!0,pre:!0,textarea:!0},Q=(D({menuitem:!0},J),/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/),G={},$={}.hasOwnProperty;y.displayName="ReactDOMComponent",y.Mixin={construct:function(t){this._currentElement=t},mountComponent:function(t,i,e){this._rootNodeID=t;var s=this._currentElement.props;switch(this._tag){case"iframe":case"img":case"form":case"video":case"audio":this._wrapperState={listeners:null},i.getReactMountReady().enqueue(c,this);break;case"button":s=A.getNativeProps(this,s,e);break;case"input":S.mountWrapper(this,s,e),s=S.getNativeProps(this,s,e);break;case"option":k.mountWrapper(this,s,e),s=k.getNativeProps(this,s,e);break;case"select":I.mountWrapper(this,s,e),s=I.getNativeProps(this,s,e),e=I.processChildContext(this,s,e);break;case"textarea":z.mountWrapper(this,s,e),s=z.getNativeProps(this,s,e)}h(this,s);var n;if(i.useCreateElement){var o=e[_.ownerDocumentContextKey],r=o.createElement(this._currentElement.type);b.setAttributeForID(r,this._rootNodeID),_.getID(r),this._updateDOMProperties({},s,i,r),this._createInitialChildren(i,s,e,r),n=r}else{var a=this._createOpenTagMarkupAndPutListeners(i,s),l=this._createContentMarkup(i,s,e);n=!l&&J[this._tag]?a+"/>":a+">"+l+"</"+this._currentElement.type+">"}switch(this._tag){case"input":i.getReactMountReady().enqueue(p,this);case"button":case"select":case"textarea":s.autoFocus&&i.getReactMountReady().enqueue(x.focusDOMComponent,this)}return n},_createOpenTagMarkupAndPutListeners:function(t,i){var e="<"+this._currentElement.type;for(var s in i)if(i.hasOwnProperty(s)){var n=i[s];if(null!=n)if(j.hasOwnProperty(s))n&&l(this._rootNodeID,s,n,t);else{s===W&&(n&&(n=this._previousStyleCopy=D({},i.style)),n=v.createMarkupForStyles(n));var o=null;null!=this._tag&&f(this._tag,i)?s!==X&&(o=b.createMarkupForCustomAttribute(s,n)):o=b.createMarkupForProperty(s,n),o&&(e+=" "+o)}}if(t.renderToStaticMarkup)return e;var r=b.createMarkupForID(this._rootNodeID);return e+" "+r},_createContentMarkup:function(t,i,e){var s="",n=i.dangerouslySetInnerHTML;if(null!=n)null!=n.__html&&(s=n.__html);else{var o=Y[typeof i.children]?i.children:null,r=null!=o?null:i.children;if(null!=o)s=L(o);else if(null!=r){var a=this.mountChildren(r,t,e);s=a.join("")}}return K[this._tag]&&"\n"===s.charAt(0)?"\n"+s:s},_createInitialChildren:function(t,i,e,s){var n=i.dangerouslySetInnerHTML;if(null!=n)null!=n.__html&&V(s,n.__html);else{var o=Y[typeof i.children]?i.children:null,r=null!=o?null:i.children;if(null!=o)B(s,o);else if(null!=r)for(var a=this.mountChildren(r,t,e),h=0;h<a.length;h++)s.appendChild(a[h])}},receiveComponent:function(t,i,e){var s=this._currentElement;this._currentElement=t,this.updateComponent(i,s,t,e)},updateComponent:function(t,i,e,s){var n=i.props,o=this._currentElement.props;switch(this._tag){case"button":n=A.getNativeProps(this,n),o=A.getNativeProps(this,o);break;case"input":S.updateWrapper(this),n=S.getNativeProps(this,n),o=S.getNativeProps(this,o);break;case"option":n=k.getNativeProps(this,n),o=k.getNativeProps(this,o);break;case"select":n=I.getNativeProps(this,n),o=I.getNativeProps(this,o);break;case"textarea":z.updateWrapper(this),n=z.getNativeProps(this,n),o=z.getNativeProps(this,o)}h(this,o),this._updateDOMProperties(n,o,t,null),this._updateDOMChildren(n,o,t,s),!T&&this._nodeWithLegacyProperties&&(this._nodeWithLegacyProperties.props=o),"select"===this._tag&&t.getReactMountReady().enqueue(d,this)},_updateDOMProperties:function(t,i,e,s){var n,o,r;for(n in t)if(!i.hasOwnProperty(n)&&t.hasOwnProperty(n))if(n===W){var a=this._previousStyleCopy;for(o in a)a.hasOwnProperty(o)&&(r=r||{},r[o]="");this._previousStyleCopy=null}else j.hasOwnProperty(n)?t[n]&&U(this._rootNodeID,n):(g.properties[n]||g.isCustomAttribute(n))&&(s||(s=_.getNode(this._rootNodeID)),b.deleteValueForProperty(s,n));for(n in i){var h=i[n],u=n===W?this._previousStyleCopy:t[n];if(i.hasOwnProperty(n)&&h!==u)if(n===W)if(h?h=this._previousStyleCopy=D({},h):this._previousStyleCopy=null,u){for(o in u)!u.hasOwnProperty(o)||h&&h.hasOwnProperty(o)||(r=r||{},r[o]="");for(o in h)h.hasOwnProperty(o)&&u[o]!==h[o]&&(r=r||{},r[o]=h[o])}else r=h;else j.hasOwnProperty(n)?h?l(this._rootNodeID,n,h,e):u&&U(this._rootNodeID,n):f(this._tag,i)?(s||(s=_.getNode(this._rootNodeID)),n===X&&(h=null),b.setValueForAttribute(s,n,h)):(g.properties[n]||g.isCustomAttribute(n))&&(s||(s=_.getNode(this._rootNodeID)),null!=h?b.setValueForProperty(s,n,h):b.deleteValueForProperty(s,n))}r&&(s||(s=_.getNode(this._rootNodeID)),v.setValueForStyles(s,r))},_updateDOMChildren:function(t,i,e,s){var n=Y[typeof t.children]?t.children:null,o=Y[typeof i.children]?i.children:null,r=t.dangerouslySetInnerHTML&&t.dangerouslySetInnerHTML.__html,a=i.dangerouslySetInnerHTML&&i.dangerouslySetInnerHTML.__html,h=null!=n?null:t.children,l=null!=o?null:i.children,u=null!=n||null!=r,c=null!=o||null!=a;null!=h&&null==l?this.updateChildren(null,e,s):u&&!c&&this.updateTextContent(""),null!=o?n!==o&&this.updateTextContent(""+o):null!=a?r!==a&&this.updateMarkup(""+a):null!=l&&this.updateChildren(l,e,s)},unmountComponent:function(){switch(this._tag){case"iframe":case"img":case"form":case"video":case"audio":var t=this._wrapperState.listeners;if(t)for(var i=0;i<t.length;i++)t[i].remove();break;case"input":S.unmountWrapper(this);break;case"html":case"head":case"body":R(!1)}if(this.unmountChildren(),C.deleteAllListeners(this._rootNodeID),P.unmountIDFromEnvironment(this._rootNodeID),this._rootNodeID=null,this._wrapperState=null,this._nodeWithLegacyProperties){var e=this._nodeWithLegacyProperties;e._reactInternalComponent=null,this._nodeWithLegacyProperties=null}},getPublicInstance:function(){if(!this._nodeWithLegacyProperties){var t=_.getNode(this._rootNodeID);t._reactInternalComponent=this,t.getDOMNode=s,t.isMounted=n,t.setState=o,t.replaceState=o,t.forceUpdate=o,t.setProps=r,t.replaceProps=a,t.props=this._currentElement.props,this._nodeWithLegacyProperties=t}return this._nodeWithLegacyProperties}},E.measureMethods(y,"ReactDOMComponent",{mountComponent:"mountComponent",updateComponent:"updateComponent"}),D(y.prototype,y.Mixin,M.Mixin),t.exports=y},function(t,i,e){"use strict";function s(t){return n.createFactory(t)}var n=e(6),o=(e(62),e(153)),r=o({a:"a",abbr:"abbr",address:"address",area:"area",article:"article",aside:"aside",audio:"audio",b:"b",base:"base",bdi:"bdi",bdo:"bdo",big:"big",blockquote:"blockquote",body:"body",br:"br",button:"button",canvas:"canvas",caption:"caption",cite:"cite",code:"code",col:"col",colgroup:"colgroup",data:"data",datalist:"datalist",dd:"dd",del:"del",details:"details",dfn:"dfn",dialog:"dialog",div:"div",dl:"dl",dt:"dt",em:"em",embed:"embed",fieldset:"fieldset",figcaption:"figcaption",figure:"figure",footer:"footer",form:"form",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",head:"head",header:"header",hgroup:"hgroup",hr:"hr",html:"html",i:"i",iframe:"iframe",img:"img",input:"input",ins:"ins",kbd:"kbd",keygen:"keygen",label:"label",legend:"legend",li:"li",link:"link",main:"main",map:"map",mark:"mark",menu:"menu",menuitem:"menuitem",meta:"meta",meter:"meter",nav:"nav",noscript:"noscript",object:"object",ol:"ol",optgroup:"optgroup",option:"option",output:"output",p:"p",param:"param",picture:"picture",pre:"pre",progress:"progress",q:"q",rp:"rp",rt:"rt",ruby:"ruby",s:"s",samp:"samp",script:"script",section:"section",select:"select",small:"small",source:"source",span:"span",strong:"strong",style:"style",sub:"sub",summary:"summary",sup:"sup",table:"table",tbody:"tbody",td:"td",textarea:"textarea",tfoot:"tfoot",th:"th",thead:"thead",time:"time",title:"title",tr:"tr",track:"track",u:"u",ul:"ul","var":"var",video:"video",wbr:"wbr",circle:"circle",clipPath:"clipPath",defs:"defs",ellipse:"ellipse",g:"g",image:"image",line:"line",linearGradient:"linearGradient",mask:"mask",path:"path",pattern:"pattern",polygon:"polygon",polyline:"polyline",radialGradient:"radialGradient",rect:"rect",stop:"stop",svg:"svg",text:"text",tspan:"tspan"},s);t.exports=r},function(t,i,e){"use strict";function s(){this._rootNodeID&&p.updateWrapper(this)}function n(t){var i=this._currentElement.props,e=r.executeOnChange(i,t);h.asap(s,this);var n=i.name;if("radio"===i.type&&null!=n){for(var o=a.getNode(this._rootNodeID),l=o;l.parentNode;)l=l.parentNode;for(var p=l.querySelectorAll("input[name="+JSON.stringify(""+n)+'][type="radio"]'),d=0;d<p.length;d++){var m=p[d];if(m!==o&&m.form===o.form){var f=a.getID(m);f?void 0:u(!1);var y=c[f];y?void 0:u(!1),h.asap(s,y)}}}return e}var o=e(37),r=e(34),a=e(5),h=e(8),l=e(2),u=e(1),c={},p={getNativeProps:function(t,i,e){var s=r.getValue(i),n=r.getChecked(i),o=l({},i,{defaultChecked:void 0,defaultValue:void 0,value:null!=s?s:t._wrapperState.initialValue,checked:null!=n?n:t._wrapperState.initialChecked,onChange:t._wrapperState.onChange});return o},mountWrapper:function(t,i){var e=i.defaultValue;t._wrapperState={initialChecked:i.defaultChecked||!1,initialValue:null!=e?e:null,onChange:n.bind(t)}},mountReadyWrapper:function(t){c[t._rootNodeID]=t},unmountWrapper:function(t){delete c[t._rootNodeID]},updateWrapper:function(t){var i=t._currentElement.props,e=i.checked;null!=e&&o.updatePropertyByID(t._rootNodeID,"checked",e||!1);var s=r.getValue(i);null!=s&&o.updatePropertyByID(t._rootNodeID,"value",""+s)}};t.exports=p},function(t,i,e){"use strict";var s=e(54),n=e(58),o=e(2),r=(e(3),n.valueContextKey),a={mountWrapper:function(t,i,e){var s=e[r],n=null;if(null!=s)if(n=!1,Array.isArray(s)){for(var o=0;o<s.length;o++)if(""+s[o]==""+i.value){n=!0;break}}else n=""+s==""+i.value;t._wrapperState={selected:n}},getNativeProps:function(t,i,e){var n=o({selected:void 0,children:void 0},i);null!=t._wrapperState.selected&&(n.selected=t._wrapperState.selected);var r="";return s.forEach(i.children,function(t){null!=t&&("string"==typeof t||"number"==typeof t)&&(r+=t)}),n.children=r,n}};t.exports=a},function(t,i,e){"use strict";function s(t,i,e,s){return t===e&&i===s}function n(t){var i=document.selection,e=i.createRange(),s=e.text.length,n=e.duplicate();n.moveToElementText(t),n.setEndPoint("EndToStart",e);var o=n.text.length,r=o+s;return{start:o,end:r}}function o(t){var i=window.getSelection&&window.getSelection();if(!i||0===i.rangeCount)return null;var e=i.anchorNode,n=i.anchorOffset,o=i.focusNode,r=i.focusOffset,a=i.getRangeAt(0);try{a.startContainer.nodeType,a.endContainer.nodeType}catch(h){return null}var l=s(i.anchorNode,i.anchorOffset,i.focusNode,i.focusOffset),u=l?0:a.toString().length,c=a.cloneRange();c.selectNodeContents(t),c.setEnd(a.startContainer,a.startOffset);var p=s(c.startContainer,c.startOffset,c.endContainer,c.endOffset),d=p?0:c.toString().length,m=d+u,f=document.createRange();f.setStart(e,n),f.setEnd(o,r);var y=f.collapsed;return{start:y?m:d,end:y?d:m}}function r(t,i){var e,s,n=document.selection.createRange().duplicate();"undefined"==typeof i.end?(e=i.start,s=e):i.start>i.end?(e=i.end,s=i.start):(e=i.start,s=i.end),n.moveToElementText(t),n.moveStart("character",e),n.setEndPoint("EndToStart",n),n.moveEnd("character",s-e),n.select()}function a(t,i){if(window.getSelection){var e=window.getSelection(),s=t[u()].length,n=Math.min(i.start,s),o="undefined"==typeof i.end?n:Math.min(i.end,s);if(!e.extend&&n>o){var r=o;o=n,n=r}var a=l(t,n),h=l(t,o);if(a&&h){var c=document.createRange();c.setStart(a.node,a.offset),e.removeAllRanges(),n>o?(e.addRange(c),e.extend(h.node,h.offset)):(c.setEnd(h.node,h.offset),e.addRange(c))}}}var h=e(4),l=e(140),u=e(76),c=h.canUseDOM&&"selection"in document&&!("getSelection"in window),p={getOffsets:c?n:o,setOffsets:c?r:a};t.exports=p},function(t,i,e){"use strict";var s=e(61),n=e(121),o=e(39);s.inject();var r={renderToString:n.renderToString,renderToStaticMarkup:n.renderToStaticMarkup,version:o};t.exports=r},function(t,i,e){"use strict";function s(){this._rootNodeID&&u.updateWrapper(this)}function n(t){var i=this._currentElement.props,e=o.executeOnChange(i,t);return a.asap(s,this),e}var o=e(34),r=e(37),a=e(8),h=e(2),l=e(1),u=(e(3),{getNativeProps:function(t,i,e){null!=i.dangerouslySetInnerHTML?l(!1):void 0;var s=h({},i,{defaultValue:void 0,value:void 0,children:t._wrapperState.initialValue,onChange:t._wrapperState.onChange});return s},mountWrapper:function(t,i){var e=i.defaultValue,s=i.children;null!=s&&(null!=e?l(!1):void 0,Array.isArray(s)&&(s.length<=1?void 0:l(!1),s=s[0]),e=""+s),null==e&&(e="");var r=o.getValue(i);t._wrapperState={initialValue:""+(null!=r?r:e),onChange:n.bind(t)}},updateWrapper:function(t){var i=t._currentElement.props,e=o.getValue(i);null!=e&&r.updatePropertyByID(t._rootNodeID,"value",""+e)}});t.exports=u},function(t,i,e){"use strict";function s(t){n.enqueueEvents(t),n.processEventQueue(!1)}var n=e(18),o={handleTopLevel:function(t,i,e,o,r){var a=n.extractEvents(t,i,e,o,r);s(a)}};t.exports=o},function(t,i,e){"use strict";function s(t){var i=p.getID(t),e=c.getReactRootIDFromNodeID(i),s=p.findReactContainerForID(e),n=p.getFirstReactDOM(s);return n}function n(t,i){this.topLevelType=t,this.nativeEvent=i,this.ancestors=[]}function o(t){r(t)}function r(t){for(var i=p.getFirstReactDOM(f(t.nativeEvent))||window,e=i;e;)t.ancestors.push(e),e=s(e);for(var n=0;n<t.ancestors.length;n++){i=t.ancestors[n];var o=p.getID(i)||"";x._handleTopLevel(t.topLevelType,i,o,t.nativeEvent,f(t.nativeEvent))}}function a(t){var i=y(window);t(i)}var h=e(78),l=e(4),u=e(12),c=e(17),p=e(5),d=e(8),m=e(2),f=e(43),y=e(148);m(n.prototype,{destructor:function(){this.topLevelType=null,this.nativeEvent=null,this.ancestors.length=0}}),u.addPoolingTo(n,u.twoArgumentPooler);var x={_enabled:!0,_handleTopLevel:null,WINDOW_HANDLE:l.canUseDOM?window:null,setHandleTopLevel:function(t){x._handleTopLevel=t},setEnabled:function(t){x._enabled=!!t},isEnabled:function(){return x._enabled},trapBubbledEvent:function(t,i,e){var s=e;return s?h.listen(s,i,x.dispatchEvent.bind(null,t)):null},trapCapturedEvent:function(t,i,e){var s=e;return s?h.capture(s,i,x.dispatchEvent.bind(null,t)):null},monitorScrollValue:function(t){var i=a.bind(null,t);h.listen(window,"scroll",i)},dispatchEvent:function(t,i){if(x._enabled){var e=n.getPooled(t,i);try{d.batchedUpdates(o,e)}finally{n.release(e)}}}};t.exports=x},function(t,i,e){"use strict";var s=e(16),n=e(18),o=e(36),r=e(55),a=e(63),h=e(23),l=e(69),u=e(7),c=e(72),p=e(8),d={Component:o.injection,Class:r.injection,DOMProperty:s.injection,EmptyComponent:a.injection,EventPluginHub:n.injection,EventEmitter:h.injection,NativeComponent:l.injection,Perf:u.injection,RootIndex:c.injection,Updates:p.injection};t.exports=d},function(t,i,e){"use strict";var s=e(54),n=e(56),o=e(55),r=e(106),a=e(6),h=(e(62),e(71)),l=e(39),u=e(2),c=e(141),p=a.createElement,d=a.createFactory,m=a.cloneElement,f={Children:{map:s.map,forEach:s.forEach,count:s.count,toArray:s.toArray,only:c},Component:n,createElement:p,cloneElement:m,isValidElement:a.isValidElement,PropTypes:h,createClass:o.createClass,createFactory:d,createMixin:function(t){return t},DOM:r,version:l,__spread:u};t.exports=f},function(t,i,e){"use strict";function s(t,i,e){y.push({parentID:t,parentNode:null,type:c.INSERT_MARKUP,markupIndex:x.push(i)-1,content:null,fromIndex:null,toIndex:e})}function n(t,i,e){y.push({parentID:t,parentNode:null,type:c.MOVE_EXISTING,markupIndex:null,content:null,fromIndex:i,toIndex:e})}function o(t,i){y.push({parentID:t,parentNode:null,type:c.REMOVE_NODE,markupIndex:null,content:null,fromIndex:i,toIndex:null})}function r(t,i){y.push({parentID:t,parentNode:null,type:c.SET_MARKUP,markupIndex:null,content:i,fromIndex:null,toIndex:null})}function a(t,i){y.push({parentID:t,parentNode:null,type:c.TEXT_CONTENT,markupIndex:null,content:i,fromIndex:null,toIndex:null})}function h(){y.length&&(u.processChildrenUpdates(y,x),l())}function l(){y.length=0,x.length=0}var u=e(36),c=e(68),p=(e(11),e(14)),d=e(101),m=e(138),f=0,y=[],x=[],v={Mixin:{_reconcilerInstantiateChildren:function(t,i,e){return d.instantiateChildren(t,i,e)},_reconcilerUpdateChildren:function(t,i,e,s){var n;return n=m(i),d.updateChildren(t,n,e,s)},mountChildren:function(t,i,e){var s=this._reconcilerInstantiateChildren(t,i,e);this._renderedChildren=s;var n=[],o=0;for(var r in s)if(s.hasOwnProperty(r)){var a=s[r],h=this._rootNodeID+r,l=p.mountComponent(a,h,i,e);a._mountIndex=o++,n.push(l)}return n},updateTextContent:function(t){f++;var i=!0;try{var e=this._renderedChildren;d.unmountChildren(e);for(var s in e)e.hasOwnProperty(s)&&this._unmountChild(e[s]);this.setTextContent(t),i=!1}finally{f--,f||(i?l():h())}},updateMarkup:function(t){f++;var i=!0;try{var e=this._renderedChildren;d.unmountChildren(e);for(var s in e)e.hasOwnProperty(s)&&this._unmountChildByName(e[s],s);
this.setMarkup(t),i=!1}finally{f--,f||(i?l():h())}},updateChildren:function(t,i,e){f++;var s=!0;try{this._updateChildren(t,i,e),s=!1}finally{f--,f||(s?l():h())}},_updateChildren:function(t,i,e){var s=this._renderedChildren,n=this._reconcilerUpdateChildren(s,t,i,e);if(this._renderedChildren=n,n||s){var o,r=0,a=0;for(o in n)if(n.hasOwnProperty(o)){var h=s&&s[o],l=n[o];h===l?(this.moveChild(h,a,r),r=Math.max(h._mountIndex,r),h._mountIndex=a):(h&&(r=Math.max(h._mountIndex,r),this._unmountChild(h)),this._mountChildByNameAtIndex(l,o,a,i,e)),a++}for(o in s)!s.hasOwnProperty(o)||n&&n.hasOwnProperty(o)||this._unmountChild(s[o])}},unmountChildren:function(){var t=this._renderedChildren;d.unmountChildren(t),this._renderedChildren=null},moveChild:function(t,i,e){t._mountIndex<e&&n(this._rootNodeID,t._mountIndex,i)},createChild:function(t,i){s(this._rootNodeID,i,t._mountIndex)},removeChild:function(t){o(this._rootNodeID,t._mountIndex)},setTextContent:function(t){a(this._rootNodeID,t)},setMarkup:function(t){r(this._rootNodeID,t)},_mountChildByNameAtIndex:function(t,i,e,s,n){var o=this._rootNodeID+i,r=p.mountComponent(t,o,s,n);t._mountIndex=e,this.createChild(t,r)},_unmountChild:function(t){this.removeChild(t),t._mountIndex=null}}};t.exports=v},function(t,i,e){"use strict";var s=e(1),n={isValidOwner:function(t){return!(!t||"function"!=typeof t.attachRef||"function"!=typeof t.detachRef)},addComponentAsRefTo:function(t,i,e){n.isValidOwner(e)?void 0:s(!1),e.attachRef(i,t)},removeComponentAsRefFrom:function(t,i,e){n.isValidOwner(e)?void 0:s(!1),e.getPublicInstance().refs[i]===t.getPublicInstance()&&e.detachRef(i)}};t.exports=n},function(t,i,e){"use strict";function s(t){this.reinitializeTransaction(),this.renderToStaticMarkup=!1,this.reactMountReady=n.getPooled(null),this.useCreateElement=!t&&a.useCreateElement}var n=e(32),o=e(12),r=e(23),a=e(57),h=e(66),l=e(27),u=e(2),c={initialize:h.getSelectionInformation,close:h.restoreSelection},p={initialize:function(){var t=r.isEnabled();return r.setEnabled(!1),t},close:function(t){r.setEnabled(t)}},d={initialize:function(){this.reactMountReady.reset()},close:function(){this.reactMountReady.notifyAll()}},m=[c,p,d],f={getTransactionWrappers:function(){return m},getReactMountReady:function(){return this.reactMountReady},destructor:function(){n.release(this.reactMountReady),this.reactMountReady=null}};u(s.prototype,l.Mixin,f),o.addPoolingTo(s),t.exports=s},function(t,i,e){"use strict";function s(t,i,e){"function"==typeof t?t(i.getPublicInstance()):o.addComponentAsRefTo(i,t,e)}function n(t,i,e){"function"==typeof t?t(null):o.removeComponentAsRefFrom(i,t,e)}var o=e(117),r={};r.attachRefs=function(t,i){if(null!==i&&i!==!1){var e=i.ref;null!=e&&s(e,t,i._owner)}},r.shouldUpdateRefs=function(t,i){var e=null===t||t===!1,s=null===i||i===!1;return e||s||i._owner!==t._owner||i.ref!==t.ref},r.detachRefs=function(t,i){if(null!==i&&i!==!1){var e=i.ref;null!=e&&n(e,t,i._owner)}},t.exports=r},function(t,i){"use strict";var e={isBatchingUpdates:!1,batchedUpdates:function(t){}};t.exports=e},function(t,i,e){"use strict";function s(t){r.isValidElement(t)?void 0:m(!1);var i;try{c.injection.injectBatchingStrategy(l);var e=a.createReactRootID();return i=u.getPooled(!1),i.perform(function(){var s=d(t,null),n=s.mountComponent(e,i,p);return h.addChecksumToMarkup(n)},null)}finally{u.release(i),c.injection.injectBatchingStrategy(o)}}function n(t){r.isValidElement(t)?void 0:m(!1);var i;try{c.injection.injectBatchingStrategy(l);var e=a.createReactRootID();return i=u.getPooled(!0),i.perform(function(){var s=d(t,null);return s.mountComponent(e,i,p)},null)}finally{u.release(i),c.injection.injectBatchingStrategy(o)}}var o=e(60),r=e(6),a=e(17),h=e(67),l=e(120),u=e(122),c=e(8),p=e(22),d=e(45),m=e(1);t.exports={renderToString:s,renderToStaticMarkup:n}},function(t,i,e){"use strict";function s(t){this.reinitializeTransaction(),this.renderToStaticMarkup=t,this.reactMountReady=o.getPooled(null),this.useCreateElement=!1}var n=e(12),o=e(32),r=e(27),a=e(2),h=e(9),l={initialize:function(){this.reactMountReady.reset()},close:h},u=[l],c={getTransactionWrappers:function(){return u},getReactMountReady:function(){return this.reactMountReady},destructor:function(){o.release(this.reactMountReady),this.reactMountReady=null}};a(s.prototype,r.Mixin,c),n.addPoolingTo(s),t.exports=s},function(t,i,e){"use strict";var s=e(16),n=s.injection.MUST_USE_ATTRIBUTE,o={xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"},r={Properties:{clipPath:n,cx:n,cy:n,d:n,dx:n,dy:n,fill:n,fillOpacity:n,fontFamily:n,fontSize:n,fx:n,fy:n,gradientTransform:n,gradientUnits:n,markerEnd:n,markerMid:n,markerStart:n,offset:n,opacity:n,patternContentUnits:n,patternUnits:n,points:n,preserveAspectRatio:n,r:n,rx:n,ry:n,spreadMethod:n,stopColor:n,stopOpacity:n,stroke:n,strokeDasharray:n,strokeLinecap:n,strokeOpacity:n,strokeWidth:n,textAnchor:n,transform:n,version:n,viewBox:n,x1:n,x2:n,x:n,xlinkActuate:n,xlinkArcrole:n,xlinkHref:n,xlinkRole:n,xlinkShow:n,xlinkTitle:n,xlinkType:n,xmlBase:n,xmlLang:n,xmlSpace:n,y1:n,y2:n,y:n},DOMAttributeNamespaces:{xlinkActuate:o.xlink,xlinkArcrole:o.xlink,xlinkHref:o.xlink,xlinkRole:o.xlink,xlinkShow:o.xlink,xlinkTitle:o.xlink,xlinkType:o.xlink,xmlBase:o.xml,xmlLang:o.xml,xmlSpace:o.xml},DOMAttributeNames:{clipPath:"clip-path",fillOpacity:"fill-opacity",fontFamily:"font-family",fontSize:"font-size",gradientTransform:"gradientTransform",gradientUnits:"gradientUnits",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",patternContentUnits:"patternContentUnits",patternUnits:"patternUnits",preserveAspectRatio:"preserveAspectRatio",spreadMethod:"spreadMethod",stopColor:"stop-color",stopOpacity:"stop-opacity",strokeDasharray:"stroke-dasharray",strokeLinecap:"stroke-linecap",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",textAnchor:"text-anchor",viewBox:"viewBox",xlinkActuate:"xlink:actuate",xlinkArcrole:"xlink:arcrole",xlinkHref:"xlink:href",xlinkRole:"xlink:role",xlinkShow:"xlink:show",xlinkTitle:"xlink:title",xlinkType:"xlink:type",xmlBase:"xml:base",xmlLang:"xml:lang",xmlSpace:"xml:space"}};t.exports=r},function(t,i,e){"use strict";function s(t){if("selectionStart"in t&&h.hasSelectionCapabilities(t))return{start:t.selectionStart,end:t.selectionEnd};if(window.getSelection){var i=window.getSelection();return{anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}}if(document.selection){var e=document.selection.createRange();return{parentElement:e.parentElement(),text:e.text,top:e.boundingTop,left:e.boundingLeft}}}function n(t,i){if(b||null==x||x!==u())return null;var e=s(x);if(!g||!d(g,e)){g=e;var n=l.getPooled(y.select,v,t,i);return n.type="select",n.target=x,r.accumulateTwoPhaseDispatches(n),n}return null}var o=e(10),r=e(19),a=e(4),h=e(66),l=e(15),u=e(81),c=e(77),p=e(13),d=e(83),m=o.topLevelTypes,f=a.canUseDOM&&"documentMode"in document&&document.documentMode<=11,y={select:{phasedRegistrationNames:{bubbled:p({onSelect:null}),captured:p({onSelectCapture:null})},dependencies:[m.topBlur,m.topContextMenu,m.topFocus,m.topKeyDown,m.topMouseDown,m.topMouseUp,m.topSelectionChange]}},x=null,v=null,g=null,b=!1,N=!1,C=p({onSelect:null}),P={eventTypes:y,extractEvents:function(t,i,e,s,o){if(!N)return null;switch(t){case m.topFocus:(c(i)||"true"===i.contentEditable)&&(x=i,v=e,g=null);break;case m.topBlur:x=null,v=null,g=null;break;case m.topMouseDown:b=!0;break;case m.topContextMenu:case m.topMouseUp:return b=!1,n(s,o);case m.topSelectionChange:if(f)break;case m.topKeyDown:case m.topKeyUp:return n(s,o)}return null},didPutListener:function(t,i,e){i===C&&(N=!0)}};t.exports=P},function(t,i){"use strict";var e=Math.pow(2,53),s={createReactRootIndex:function(){return Math.ceil(Math.random()*e)}};t.exports=s},function(t,i,e){"use strict";var s=e(10),n=e(78),o=e(19),r=e(5),a=e(127),h=e(15),l=e(130),u=e(132),c=e(26),p=e(129),d=e(133),m=e(21),f=e(134),y=e(9),x=e(41),v=e(1),g=e(13),b=s.topLevelTypes,N={abort:{phasedRegistrationNames:{bubbled:g({onAbort:!0}),captured:g({onAbortCapture:!0})}},blur:{phasedRegistrationNames:{bubbled:g({onBlur:!0}),captured:g({onBlurCapture:!0})}},canPlay:{phasedRegistrationNames:{bubbled:g({onCanPlay:!0}),captured:g({onCanPlayCapture:!0})}},canPlayThrough:{phasedRegistrationNames:{bubbled:g({onCanPlayThrough:!0}),captured:g({onCanPlayThroughCapture:!0})}},click:{phasedRegistrationNames:{bubbled:g({onClick:!0}),captured:g({onClickCapture:!0})}},contextMenu:{phasedRegistrationNames:{bubbled:g({onContextMenu:!0}),captured:g({onContextMenuCapture:!0})}},copy:{phasedRegistrationNames:{bubbled:g({onCopy:!0}),captured:g({onCopyCapture:!0})}},cut:{phasedRegistrationNames:{bubbled:g({onCut:!0}),captured:g({onCutCapture:!0})}},doubleClick:{phasedRegistrationNames:{bubbled:g({onDoubleClick:!0}),captured:g({onDoubleClickCapture:!0})}},drag:{phasedRegistrationNames:{bubbled:g({onDrag:!0}),captured:g({onDragCapture:!0})}},dragEnd:{phasedRegistrationNames:{bubbled:g({onDragEnd:!0}),captured:g({onDragEndCapture:!0})}},dragEnter:{phasedRegistrationNames:{bubbled:g({onDragEnter:!0}),captured:g({onDragEnterCapture:!0})}},dragExit:{phasedRegistrationNames:{bubbled:g({onDragExit:!0}),captured:g({onDragExitCapture:!0})}},dragLeave:{phasedRegistrationNames:{bubbled:g({onDragLeave:!0}),captured:g({onDragLeaveCapture:!0})}},dragOver:{phasedRegistrationNames:{bubbled:g({onDragOver:!0}),captured:g({onDragOverCapture:!0})}},dragStart:{phasedRegistrationNames:{bubbled:g({onDragStart:!0}),captured:g({onDragStartCapture:!0})}},drop:{phasedRegistrationNames:{bubbled:g({onDrop:!0}),captured:g({onDropCapture:!0})}},durationChange:{phasedRegistrationNames:{bubbled:g({onDurationChange:!0}),captured:g({onDurationChangeCapture:!0})}},emptied:{phasedRegistrationNames:{bubbled:g({onEmptied:!0}),captured:g({onEmptiedCapture:!0})}},encrypted:{phasedRegistrationNames:{bubbled:g({onEncrypted:!0}),captured:g({onEncryptedCapture:!0})}},ended:{phasedRegistrationNames:{bubbled:g({onEnded:!0}),captured:g({onEndedCapture:!0})}},error:{phasedRegistrationNames:{bubbled:g({onError:!0}),captured:g({onErrorCapture:!0})}},focus:{phasedRegistrationNames:{bubbled:g({onFocus:!0}),captured:g({onFocusCapture:!0})}},input:{phasedRegistrationNames:{bubbled:g({onInput:!0}),captured:g({onInputCapture:!0})}},keyDown:{phasedRegistrationNames:{bubbled:g({onKeyDown:!0}),captured:g({onKeyDownCapture:!0})}},keyPress:{phasedRegistrationNames:{bubbled:g({onKeyPress:!0}),captured:g({onKeyPressCapture:!0})}},keyUp:{phasedRegistrationNames:{bubbled:g({onKeyUp:!0}),captured:g({onKeyUpCapture:!0})}},load:{phasedRegistrationNames:{bubbled:g({onLoad:!0}),captured:g({onLoadCapture:!0})}},loadedData:{phasedRegistrationNames:{bubbled:g({onLoadedData:!0}),captured:g({onLoadedDataCapture:!0})}},loadedMetadata:{phasedRegistrationNames:{bubbled:g({onLoadedMetadata:!0}),captured:g({onLoadedMetadataCapture:!0})}},loadStart:{phasedRegistrationNames:{bubbled:g({onLoadStart:!0}),captured:g({onLoadStartCapture:!0})}},mouseDown:{phasedRegistrationNames:{bubbled:g({onMouseDown:!0}),captured:g({onMouseDownCapture:!0})}},mouseMove:{phasedRegistrationNames:{bubbled:g({onMouseMove:!0}),captured:g({onMouseMoveCapture:!0})}},mouseOut:{phasedRegistrationNames:{bubbled:g({onMouseOut:!0}),captured:g({onMouseOutCapture:!0})}},mouseOver:{phasedRegistrationNames:{bubbled:g({onMouseOver:!0}),captured:g({onMouseOverCapture:!0})}},mouseUp:{phasedRegistrationNames:{bubbled:g({onMouseUp:!0}),captured:g({onMouseUpCapture:!0})}},paste:{phasedRegistrationNames:{bubbled:g({onPaste:!0}),captured:g({onPasteCapture:!0})}},pause:{phasedRegistrationNames:{bubbled:g({onPause:!0}),captured:g({onPauseCapture:!0})}},play:{phasedRegistrationNames:{bubbled:g({onPlay:!0}),captured:g({onPlayCapture:!0})}},playing:{phasedRegistrationNames:{bubbled:g({onPlaying:!0}),captured:g({onPlayingCapture:!0})}},progress:{phasedRegistrationNames:{bubbled:g({onProgress:!0}),captured:g({onProgressCapture:!0})}},rateChange:{phasedRegistrationNames:{bubbled:g({onRateChange:!0}),captured:g({onRateChangeCapture:!0})}},reset:{phasedRegistrationNames:{bubbled:g({onReset:!0}),captured:g({onResetCapture:!0})}},scroll:{phasedRegistrationNames:{bubbled:g({onScroll:!0}),captured:g({onScrollCapture:!0})}},seeked:{phasedRegistrationNames:{bubbled:g({onSeeked:!0}),captured:g({onSeekedCapture:!0})}},seeking:{phasedRegistrationNames:{bubbled:g({onSeeking:!0}),captured:g({onSeekingCapture:!0})}},stalled:{phasedRegistrationNames:{bubbled:g({onStalled:!0}),captured:g({onStalledCapture:!0})}},submit:{phasedRegistrationNames:{bubbled:g({onSubmit:!0}),captured:g({onSubmitCapture:!0})}},suspend:{phasedRegistrationNames:{bubbled:g({onSuspend:!0}),captured:g({onSuspendCapture:!0})}},timeUpdate:{phasedRegistrationNames:{bubbled:g({onTimeUpdate:!0}),captured:g({onTimeUpdateCapture:!0})}},touchCancel:{phasedRegistrationNames:{bubbled:g({onTouchCancel:!0}),captured:g({onTouchCancelCapture:!0})}},touchEnd:{phasedRegistrationNames:{bubbled:g({onTouchEnd:!0}),captured:g({onTouchEndCapture:!0})}},touchMove:{phasedRegistrationNames:{bubbled:g({onTouchMove:!0}),captured:g({onTouchMoveCapture:!0})}},touchStart:{phasedRegistrationNames:{bubbled:g({onTouchStart:!0}),captured:g({onTouchStartCapture:!0})}},volumeChange:{phasedRegistrationNames:{bubbled:g({onVolumeChange:!0}),captured:g({onVolumeChangeCapture:!0})}},waiting:{phasedRegistrationNames:{bubbled:g({onWaiting:!0}),captured:g({onWaitingCapture:!0})}},wheel:{phasedRegistrationNames:{bubbled:g({onWheel:!0}),captured:g({onWheelCapture:!0})}}},C={topAbort:N.abort,topBlur:N.blur,topCanPlay:N.canPlay,topCanPlayThrough:N.canPlayThrough,topClick:N.click,topContextMenu:N.contextMenu,topCopy:N.copy,topCut:N.cut,topDoubleClick:N.doubleClick,topDrag:N.drag,topDragEnd:N.dragEnd,topDragEnter:N.dragEnter,topDragExit:N.dragExit,topDragLeave:N.dragLeave,topDragOver:N.dragOver,topDragStart:N.dragStart,topDrop:N.drop,topDurationChange:N.durationChange,topEmptied:N.emptied,topEncrypted:N.encrypted,topEnded:N.ended,topError:N.error,topFocus:N.focus,topInput:N.input,topKeyDown:N.keyDown,topKeyPress:N.keyPress,topKeyUp:N.keyUp,topLoad:N.load,topLoadedData:N.loadedData,topLoadedMetadata:N.loadedMetadata,topLoadStart:N.loadStart,topMouseDown:N.mouseDown,topMouseMove:N.mouseMove,topMouseOut:N.mouseOut,topMouseOver:N.mouseOver,topMouseUp:N.mouseUp,topPaste:N.paste,topPause:N.pause,topPlay:N.play,topPlaying:N.playing,topProgress:N.progress,topRateChange:N.rateChange,topReset:N.reset,topScroll:N.scroll,topSeeked:N.seeked,topSeeking:N.seeking,topStalled:N.stalled,topSubmit:N.submit,topSuspend:N.suspend,topTimeUpdate:N.timeUpdate,topTouchCancel:N.touchCancel,topTouchEnd:N.touchEnd,topTouchMove:N.touchMove,topTouchStart:N.touchStart,topVolumeChange:N.volumeChange,topWaiting:N.waiting,topWheel:N.wheel};for(var P in C)C[P].dependencies=[P];var A=g({onClick:null}),S={},k={eventTypes:N,extractEvents:function(t,i,e,s,n){var r=C[t];if(!r)return null;var y;switch(t){case b.topAbort:case b.topCanPlay:case b.topCanPlayThrough:case b.topDurationChange:case b.topEmptied:case b.topEncrypted:case b.topEnded:case b.topError:case b.topInput:case b.topLoad:case b.topLoadedData:case b.topLoadedMetadata:case b.topLoadStart:case b.topPause:case b.topPlay:case b.topPlaying:case b.topProgress:case b.topRateChange:case b.topReset:case b.topSeeked:case b.topSeeking:case b.topStalled:case b.topSubmit:case b.topSuspend:case b.topTimeUpdate:case b.topVolumeChange:case b.topWaiting:y=h;break;case b.topKeyPress:if(0===x(s))return null;case b.topKeyDown:case b.topKeyUp:y=u;break;case b.topBlur:case b.topFocus:y=l;break;case b.topClick:if(2===s.button)return null;case b.topContextMenu:case b.topDoubleClick:case b.topMouseDown:case b.topMouseMove:case b.topMouseOut:case b.topMouseOver:case b.topMouseUp:y=c;break;case b.topDrag:case b.topDragEnd:case b.topDragEnter:case b.topDragExit:case b.topDragLeave:case b.topDragOver:case b.topDragStart:case b.topDrop:y=p;break;case b.topTouchCancel:case b.topTouchEnd:case b.topTouchMove:case b.topTouchStart:y=d;break;case b.topScroll:y=m;break;case b.topWheel:y=f;break;case b.topCopy:case b.topCut:case b.topPaste:y=a}y?void 0:v(!1);var g=y.getPooled(r,e,s,n);return o.accumulateTwoPhaseDispatches(g),g},didPutListener:function(t,i,e){if(i===A){var s=r.getNode(t);S[t]||(S[t]=n.listen(s,"click",y))}},willDeleteListener:function(t,i){i===A&&(S[t].remove(),delete S[t])}};t.exports=k},function(t,i,e){"use strict";function s(t,i,e,s){n.call(this,t,i,e,s)}var n=e(15),o={clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}};n.augmentClass(s,o),t.exports=s},function(t,i,e){"use strict";function s(t,i,e,s){n.call(this,t,i,e,s)}var n=e(15),o={data:null};n.augmentClass(s,o),t.exports=s},function(t,i,e){"use strict";function s(t,i,e,s){n.call(this,t,i,e,s)}var n=e(26),o={dataTransfer:null};n.augmentClass(s,o),t.exports=s},function(t,i,e){"use strict";function s(t,i,e,s){n.call(this,t,i,e,s)}var n=e(21),o={relatedTarget:null};n.augmentClass(s,o),t.exports=s},function(t,i,e){"use strict";function s(t,i,e,s){n.call(this,t,i,e,s)}var n=e(15),o={data:null};n.augmentClass(s,o),t.exports=s},function(t,i,e){"use strict";function s(t,i,e,s){n.call(this,t,i,e,s)}var n=e(21),o=e(41),r=e(139),a=e(42),h={key:r,location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:a,charCode:function(t){return"keypress"===t.type?o(t):0},keyCode:function(t){return"keydown"===t.type||"keyup"===t.type?t.keyCode:0},which:function(t){return"keypress"===t.type?o(t):"keydown"===t.type||"keyup"===t.type?t.keyCode:0}};n.augmentClass(s,h),t.exports=s},function(t,i,e){"use strict";function s(t,i,e,s){n.call(this,t,i,e,s)}var n=e(21),o=e(42),r={touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:o};n.augmentClass(s,r),t.exports=s},function(t,i,e){"use strict";function s(t,i,e,s){n.call(this,t,i,e,s)}var n=e(26),o={deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:null,deltaMode:null};n.augmentClass(s,o),t.exports=s},function(t,i){"use strict";function e(t){for(var i=1,e=0,n=0,o=t.length,r=-4&o;r>n;){for(;n<Math.min(n+4096,r);n+=4)e+=(i+=t.charCodeAt(n))+(i+=t.charCodeAt(n+1))+(i+=t.charCodeAt(n+2))+(i+=t.charCodeAt(n+3));i%=s,e%=s}for(;o>n;n++)e+=i+=t.charCodeAt(n);return i%=s,e%=s,i|e<<16}var s=65521;t.exports=e},function(t,i,e){"use strict";function s(t,i){var e=null==i||"boolean"==typeof i||""===i;if(e)return"";var s=isNaN(i);return s||0===i||o.hasOwnProperty(t)&&o[t]?""+i:("string"==typeof i&&(i=i.trim()),i+"px")}var n=e(51),o=n.isUnitlessNumber;t.exports=s},function(t,i,e){"use strict";function s(t,i,e,s,n){return n}e(2),e(3);t.exports=s},function(t,i,e){"use strict";function s(t,i,e){var s=t,n=void 0===s[e];n&&null!=i&&(s[e]=i)}function n(t){if(null==t)return t;var i={};return o(t,s,i),i}var o=e(49);e(3);t.exports=n},function(t,i,e){"use strict";function s(t){if(t.key){var i=o[t.key]||t.key;if("Unidentified"!==i)return i}if("keypress"===t.type){var e=n(t);return 13===e?"Enter":String.fromCharCode(e)}return"keydown"===t.type||"keyup"===t.type?r[t.keyCode]||"Unidentified":""}var n=e(41),o={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},r={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"};t.exports=s},function(t,i){"use strict";function e(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function s(t){for(;t;){if(t.nextSibling)return t.nextSibling;t=t.parentNode}}function n(t,i){for(var n=e(t),o=0,r=0;n;){if(3===n.nodeType){if(r=o+n.textContent.length,i>=o&&r>=i)return{node:n,offset:i-o};o=r}n=e(s(n))}}t.exports=n},function(t,i,e){"use strict";function s(t){return n.isValidElement(t)?void 0:o(!1),t}var n=e(6),o=e(1);t.exports=s},function(t,i,e){"use strict";function s(t){return'"'+n(t)+'"'}var n=e(29);t.exports=s},function(t,i,e){"use strict";var s=e(5);t.exports=s.renderSubtreeIntoContainer},function(t,i){"use strict";function e(t){return t.replace(s,function(t,i){return i.toUpperCase()})}var s=/-(.)/g;t.exports=e},function(t,i,e){"use strict";function s(t){return n(t.replace(o,"ms-"))}var n=e(144),o=/^-ms-/;t.exports=s},function(t,i,e){"use strict";function s(t){return!!t&&("object"==typeof t||"function"==typeof t)&&"length"in t&&!("setInterval"in t)&&"number"!=typeof t.nodeType&&(Array.isArray(t)||"callee"in t||"item"in t)}function n(t){return s(t)?Array.isArray(t)?t.slice():o(t):[t]}var o=e(155);t.exports=n},function(t,i,e){"use strict";function s(t){var i=t.match(u);return i&&i[1].toLowerCase()}function n(t,i){var e=l;l?void 0:h(!1);var n=s(t),o=n&&a(n);if(o){e.innerHTML=o[1]+t+o[2];for(var u=o[0];u--;)e=e.lastChild}else e.innerHTML=t;var c=e.getElementsByTagName("script");c.length&&(i?void 0:h(!1),r(c).forEach(i));for(var p=r(e.childNodes);e.lastChild;)e.removeChild(e.lastChild);return p}var o=e(4),r=e(146),a=e(82),h=e(1),l=o.canUseDOM?document.createElement("div"):null,u=/^\s*<(\w+)/;t.exports=n},function(t,i){"use strict";function e(t){return t===window?{x:window.pageXOffset||document.documentElement.scrollLeft,y:window.pageYOffset||document.documentElement.scrollTop}:{x:t.scrollLeft,y:t.scrollTop}}t.exports=e},function(t,i){"use strict";function e(t){return t.replace(s,"-$1").toLowerCase()}var s=/([A-Z])/g;t.exports=e},function(t,i,e){"use strict";function s(t){return n(t).replace(o,"-ms-")}var n=e(149),o=/^ms-/;t.exports=s},function(t,i){"use strict";function e(t){return!(!t||!("function"==typeof Node?t instanceof Node:"object"==typeof t&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName))}t.exports=e},function(t,i,e){"use strict";function s(t){return n(t)&&3==t.nodeType}var n=e(151);t.exports=s},function(t,i){"use strict";function e(t,i,e){if(!t)return null;var n={};for(var o in t)s.call(t,o)&&(n[o]=i.call(e,t[o],o,t));return n}var s=Object.prototype.hasOwnProperty;t.exports=e},function(t,i){"use strict";function e(t){var i={};return function(e){return i.hasOwnProperty(e)||(i[e]=t.call(this,e)),i[e]}}t.exports=e},function(t,i,e){"use strict";function s(t){var i=t.length;if(Array.isArray(t)||"object"!=typeof t&&"function"!=typeof t?n(!1):void 0,"number"!=typeof i?n(!1):void 0,0===i||i-1 in t?void 0:n(!1),t.hasOwnProperty)try{return Array.prototype.slice.call(t)}catch(e){}for(var s=Array(i),o=0;i>o;o++)s[o]=t[o];return s}var n=e(1);t.exports=s},function(t,i,e){"use strict";t.exports=e(99)}]);